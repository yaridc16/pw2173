var GAG=webpackJsonpGAG([1],[,function(e,t,n){"use strict";var i=n(98),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(){this._base=this};s.prototype=new o.default,s.prototype.getBase=function(){return this._base},s.prototype.init=function(){},s.prototype.onLoad=function(){},s.prototype.onResize=function(){},s.prototype.onScroll=function(){},s.prototype.onDomReady=function(){},e.exports=s},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(6),s=i(o),r=n(7),a=i(r),l=function(){function e(){(0,s.default)(this,e)}return(0,a.default)(e,null,[{key:"log",value:function(e,t){this.logWithData(e,t)}},{key:"logWithData",value:function(e,t){}}]),e}();e.exports=l},function(e,t,n){"use strict";var i={_configs:{},_uuid:"",init:function(){this._uuid=this.generateUuid()},load:function(e){this._configs=e||{}},get:function(e){for(var t=e.split("."),n=this._configs,i="";n&&t.length>0;)n=n[t.shift()],i=n;return i},Facebook:{init:function(){},getAppId:function(){return i.get("configs.facebook.app_id")}},getUuid:function(){return this._uuid},generateUuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}};e.exports=i},function(e,t,n){"use strict";var i={};e.exports=i},function(e,t,n){"use strict";(function(t,n){var i={_domain:"9gag.com",_backUrl:"",_pageKey:"",init:function(){this._domain=t.get("page.domain"),this._backUrl=t.get("page.back_url"),this._pageKey=t.get("page.page_key")},getProtocol:function(){return"https:"==document.location.protocol?"https":"http"},getDomain:function(){return this._domain},getCookieOptions:function(){return{path:"/",expires:7300}},getPageKey:function(){return this._pageKey},load:function(e){window.location=e},getBackUrl:function(){return this._backUrl},isPostPage:function(){return"Post"==this._pageKey},isSectionPage:function(){return t.get("page.is_section_list")},isTagPostListPage:function(){return t.get("page.is_tag_list")},isProfilePage:function(){return 0==this._pageKey.indexOf("Profile")},isSearchPage:function(){return"Search"==this._pageKey},isUploadPage:function(){return"Submit"==this._pageKey},isNsfwPostPage:function(){return this.isPostPage()&&t.get("page.is_nsfw_post")},isFreshPostPage:function(){return this.isPostPage()&&t.get("page.is_fresh_post")},isHouseAdPostPage:function(){return this.isPostPage()&&t.get("page.is_house_ad_post")},getUrlParam:function(e){return n._getQueryStringParam(e)}};e.exports=i}).call(t,n(3),n(91))},,,function(e,t,n){"use strict";(function(t){var i=n(179),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s={track:function(e,n,i,s){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};o.default.track(e,n,i),t.trackEvent(e,n,i,s,r)}};e.exports=s}).call(t,n(18))},,,,function(e,t,n){"use strict";(function(t){var n={parseJsonString:function(e){try{return t.parseJSON(e)}catch(e){}return{}},isCurrentlyFocusedInTypeable:function(){var e=t(document.activeElement).prop("tagName").toLowerCase();return"input"==e||"textarea"==e},formatNumber:function(e,t,n,i){void 0===t&&(t=0),e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var o,s=isFinite(+e)?+e:0,r=isFinite(+t)?Math.abs(t):0,a=void 0===i?",":i,l=void 0===n?".":n;return o=(r?function(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}(s,r):""+Math.round(s)).split("."),o[0].length>3&&(o[0]=o[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,a)),(o[1]||"").length<r&&(o[1]=o[1]||"",o[1]+=new Array(r-o[1].length+1).join("0")),o.join(l)},cookieCheckKey:"cchk",isCookieEnabled:function(){var e=t.cookie(this.cookieCheckKey);return null!=e||(t.cookie(this.cookieCheckKey,1,{duration:1e3}),null!=(e=t.cookie(this.cookieCheckKey)))},isMobileDevice:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},arrayChunk:function(e,t){var n,i=[];for(n=0;n<e.length;n+=t)i.push(e.slice(n,n+t));return i},getCurrentEntryId:function(){var e=document.location.pathname,t=e.split("/gag/")[1];return t?t.split("/")[0]:null},getSpinnerHtml:function(){return'<div class="simple-spinner"></div>'},getTagUrl:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="/tag/"+e.toLowerCase().replace(/ /g,"-");return t&&(n=n+"?ref="+t),n}};e.exports=n}).call(t,n(0))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(27),r=o(s),a=n(5),l=o(a),c=t.extend({},new r.default,function(){var e={_isLoggedIn:null,_user:null};return{init:function(){e._user=i.get("user")},isLoggedIn:function(t,n){if(e._isLoggedIn=this.getUserId()>0,t&&!e._isLoggedIn){var i="https://"+l.default.getDomain()+"/login";n&&(i+="?next="+n),l.default.load(i)}return e._isLoggedIn},getUsername:function(){return e._user&&e._user.username?e._user.username:""},getUserId:function(){return e._user&&e._user.id?e._user.id:0},getAccountId:function(){return e._user&&e._user.account_id?e._user.account_id:0}}}());e.exports=c}).call(t,n(0),n(3))},,,,,function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(37),r=o(s),a=n(194),l=o(a),c=n(6),d=o(c),u=n(7),h=o(u),f=n(156),_=o(f),g=n(155),p=o(g),E=function(){function e(t,n,i,o,s,r){(0,d.default)(this,e),this.category=t,this.action=n,this.name=i,this.value=o,this.cvars=s||{},this.customUrl=r}return(0,h.default)(e,[{key:"getUniqueItemKey",value:function(){var e=this.category+"|"+this.action+"|"+this.name;if(this.cvars)for(var t in this.cvars)void 0!=t&&(e+="|"+t+":"+this.cvars[t]);return e}},{key:"getHashCode",value:function(){var e=this.getUniqueItemKey();return t.murmurhash3(e,"event-wrapper")}},{key:"deleteCVar",value:function(e){var t=this.cvars[e];if(void 0==t)return t;try{delete this.cvars[e]}catch(t){this.cvars[e]=void 0}return(0,l.default)({},e,t)}}]),e}(),T={_pageViewTracked:!1,_filters:[],push:function(e){window._paq=window._paq||[],window._paq.push(e)},addFilter:function(e){e&&this._filters.push(e)},trackEvent:function(e,t,n,i,o,s){var r=new E(e,t,n,i,o,s),a=[];if(this._filters&&this._filters.length>0){for(var l=0;l<this._filters.length;l++)r=this._filters[l].filterEvent(r);r&&a.push(r)}else a.push(r);for(var l=0;l<a.length;l++){var c=a[l];p.default.aggregate(c)||this._trackEvent(c)}},_trackEvent:function(e){var t=e.category,n=e.action,i=e.name,o=e.value,s=e.cvars,a=e.customUrl,l=void 0!=a?a:document.location.href;this.push(["setCustomUrl",l]),s=s||{};var c=0;for((0,r.default)(s).forEach(function(e){T.push(["setCustomVariable",++c,e,s[e],"event"])}),void 0==o&&(o=1),this.push(["trackEvent",t,n,i,o]),c=1;c<=(0,r.default)(s).length;c++)T.push(["deleteCustomVariable",c,"event"])},setUserId:function(e){this.push(["setUserId",""+e])},trackPageView:function(){this._pageViewTracked||(this.push(["trackPageView"]),this._pageViewTracked=!0)}};i.log("PiwikUtilsSessionFilter",_.default),p.default.setTrackEventHandler(T._trackEvent.bind(T)),T.addFilter(_.default),e.exports=T}).call(t,n(154),n(2))},,,,,,,,function(e,t,n){"use strict";(function(t,i,o,s){function r(e){return e&&e.__esModule?e:{default:e}}var a=n(1),l=r(a),c=n(5),d=r(c),u=t.extend({},new l.default,{_isShown:!1,_hideUsingBackground:!0,_hideAllOverlayReturnToUpload:!1,selectors:{OVERLAY:"#overlay-container",OVERLAY_COMPONENT:"section",OVERLAY_CLOSE_BUTTON:".badge-overlay-close",OVERLAY_COMPONENT_UPLOAD:".badge-overlay-upload",OVERLAY_COMPONENT_REPORT:".badge-overlay-report",OVERLAY_COMPONENT_LOGIN:".badge-overlay-signin",OVERLAY_COMPONENT_SIGNUP_FB:".badge-overlay-signup-fb",OVERLAY_COMPONENT_SIGNUP_EMAIL:".badge-overlay-signup-email",OVERLAY_COMPONENT_DRAG_AND_DROP:".badge-drag-and-drop"},init:function(){this.bindOverlayCloseButtons(),this.bindMouseLeave()},handlers:{closeButtonClickedHandler:function(e){if(t(e.currentTarget).closest(this.selectors.OVERLAY_COMPONENT).is(this.selectors.OVERLAY_COMPONENT_UPLOAD)&&(i.track("Upload","Clicked","Cancel"),d.default.isUploadPage()))return window.location.href="http://"+d.default.getDomain(),!1;this.hideOverlay(t(e.currentTarget).closest(this.selectors.OVERLAY_COMPONENT)),e.preventDefault()},overlayBackgroundClickedHandler:function(e){this._hideUsingBackground&&this.hideAllOverlay()},overlayComponentClickedHandler:function(e){e.stopPropagation()}},isAnyOverlayShown:function(){return this._isShown},setHideUsingBackground:function(e){this._hideUsingBackground=!1!==e},showOverlay:function(e,n){this.hideAllOverlay(),this._isShown=!0,t(this.selectors.OVERLAY).removeClass("hide"),n||t("body").addClass("no-scroll"),void 0!==e&&(t(e).removeClass("hide"),e==this.selectors.OVERLAY_COMPONENT_UPLOAD?this.setHideUsingBackground(!1):e==o.PostController.selectors.MODAL_POST_ZOOM_CONTAINER&&this.setHideUsingBackground(!0))},hideOverlay:function(e){this._isShown=!1,t(this.selectors.OVERLAY).addClass("hide"),t("body").removeClass("no-scroll"),void 0!==e&&(t(e).addClass("hide"),t(e).hasClass("badge-overlay-upload")&&this.setHideUsingBackground(!0))},hideAllOverlay:function(){s.log("hideAllOverlay"),this._hideAllOverlayReturnToUpload?(this._hideAllOverlayReturnToUpload=!1,this.showOverlay(this.selectors.OVERLAY_COMPONENT_UPLOAD,!1)):(this.hideOverlay(t(this.selectors.OVERLAY).children()),o.ReportController.onCancel())},bindOverlayCloseButtons:function(){t(this.selectors.OVERLAY).find(this.selectors.OVERLAY_CLOSE_BUTTON).click(t.proxy(this.handlers.closeButtonClickedHandler,this)),t(this.selectors.OVERLAY).click(t.proxy(this.handlers.overlayBackgroundClickedHandler,this)),t(this.selectors.OVERLAY).find(this.selectors.OVERLAY_COMPONENT).click(t.proxy(this.handlers.overlayComponentClickedHandler,this))},bindMouseLeave:function(){t(this.selectors.OVERLAY).mouseleave(function(){this._isShown&&!t(this.selectors.OVERLAY_COMPONENT_DRAG_AND_DROP).hasClass("hide")&&this.hideOverlay(this.selectors.OVERLAY_COMPONENT_DRAG_AND_DROP)})},isInsideOverlay:function(e){return t(e).is(this.selectors.OVERLAY+" *")}});e.exports=u}).call(t,n(0),n(8),n(4),n(2))},function(e,t,n){"use strict";var i=n(98),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(){this._base=this};s.prototype=new o.default,s.prototype.getBase=function(){return this._base},s.prototype.init=function(){},e.exports=s},,,,,,,,function(e,t,n){"use strict";(function(t,i,o,s,r){function a(e){return e&&e.__esModule?e:{default:e}}var l=n(11),c=a(l),d=n(1),u=a(d),h=n(26),f=a(h),_=n(13),g=a(_),p=n(5),E=a(p),T=n(65),m=a(T),v=t.extend({},new u.default,{init:function(){this.bindElements()},selectors:{HEADER_LOGIN_BUTTON:".badge-login-button",HEADER_SIGNUP_BUTTON:".badge-signup-button",LOGIN_FORM_NEXT_URL:"#jsid-login-form-next-url",LOGIN_FACEBOOK_CONNECT_BUTTON:".badge-facebook-connect",LOGIN_GPLUS_CONNECT_BUTTON:".badge-gplus-connect",SIGNUP_FB:"#signup-fb",SIGNUP_EMAIL:"#signup-email",SIGNUP_EMAIL_LINK:".badge-signup-email-link",SIGNUP_LOGIN_LINK:".badge-signup-login-link",SIGNUP_FORM_NEXT_URL:".badge-signup-form-next-url",DELETE_CONFIRM_FORM:".badge-delete-confirm-form",SHOW_DELETE_FORM_BTN:"#jsid-show-form-btn",RESET_SUBMIT_BTN:".badge-reset-submit",RESET_SUBMIT_FROM:"#jsid-form-reset",RESET_NEW_PWD:"#jsid-reset-new-pwd",RESET_RETYPE_NEW_PWD:"#jsid-reset-retype-new-pwd"},bindElements:function(){this.bindSignupElements(),this.bindLoginElements(),this.bindDeleteConfirmElements(),this.bindFacebookConnectElements(),this.bindGplusConnectElements(),this.bindResetForm()},bindSignupElements:function(){var e=this;t(this.selectors.HEADER_SIGNUP_BUTTON).on("click",t.proxy(function(e){e.preventDefault(),this.presentSignupForm()},this)),t(this.selectors.SIGNUP_EMAIL_LINK).click(t.proxy(function(e){e.preventDefault(),this.switchToEmailSignup()},this)),t(this.selectors.SIGNUP_LOGIN_LINK).each(function(){f.default.isInsideOverlay(t(this))&&t(this).click(t.proxy(function(e){e.preventDefault(),this.presentLoginForm(t(this.selectors.SIGNUP_FORM_NEXT_URL).val())},e))}),t(this.selectors.SIGNUP_EMAIL).on("submit",t.proxy(function(e){t(".badge-input-tzo").val(this._getTimezoneOffset())},this))},bindLoginElements:function(){t(this.selectors.HEADER_LOGIN_BUTTON).on("click",t.proxy(function(e){e.preventDefault(),this.presentLoginForm()},this))},bindDeleteConfirmElements:function(){t(this.selectors.SHOW_DELETE_FORM_BTN).on("click",t.proxy(function(){t(this.selectors.DELETE_CONFIRM_FORM).removeClass("hide")},this))},bindFacebookConnectElements:function(){t(this.selectors.LOGIN_FACEBOOK_CONNECT_BUTTON).on("click",t.proxy(function(e){e.preventDefault();var n=t(this.selectors.LOGIN_FORM_NEXT_URL).val(),i={a:!1,d:!1,lo:!1,dl:!1},o=(0,c.default)(i);t.cookie("auto_log",o,{path:"/"}),m.default.Connect.connect(n)},this))},bindGplusConnectElements:function(){},bindResetForm:function(){t(this.selectors.RESET_SUBMIT_FROM).submit(t.proxy(function(e){return!!this.validateReset()},this))},validateReset:function(){var e=t(this.selectors.RESET_NEW_PWD).val();if(e!=t(this.selectors.RESET_RETYPE_NEW_PWD).val())return t(".badge-error-message").text("Your new password doesn't seem to be matching.").removeClass("hide"),!1;var n=i.isValidPassword(e,6,30);return n?t(".badge-error-message").text("").addClass("hide"):t(".badge-error-message").text("Invalid password.").removeClass("hide"),n},_getTimezoneOffset:function(){return(new Date).getTimezoneOffset()/-60},presentLoginForm:function(e){o.track("Login","LoginOverlay",E.default.getPageKey()),f.default.showOverlay(f.default.selectors.OVERLAY_COMPONENT_LOGIN,!1),t("#jsid-login-email-name").focus(),void 0!==e?(t(this.selectors.LOGIN_FORM_NEXT_URL).val(e),t(this.selectors.SIGNUP_FORM_NEXT_URL).val(e)):(t(this.selectors.LOGIN_FORM_NEXT_URL).val(location.href),t(this.selectors.SIGNUP_FORM_NEXT_URL).val(location.href))},presentSignupForm:function(e){o.track("SignUp","SignUpOverlay",E.default.getPageKey()),f.default.showOverlay(f.default.selectors.OVERLAY_COMPONENT_SIGNUP_FB,!1),void 0!==e?(t(this.selectors.LOGIN_FORM_NEXT_URL).val(e),t(this.selectors.SIGNUP_FORM_NEXT_URL).val(e)):(t(this.selectors.LOGIN_FORM_NEXT_URL).val(location.href),t(this.selectors.SIGNUP_FORM_NEXT_URL).val(location.href)),this.switchToFacebookSignup()},switchToEmailSignup:function(){o.track("SignUp","SignUpEmailOverlay",E.default.getPageKey()),t(this.selectors.SIGNUP_FB).addClass("hide"),t(this.selectors.SIGNUP_EMAIL).removeClass("hide")},switchToFacebookSignup:function(){t(this.selectors.SIGNUP_EMAIL).addClass("hide"),t(this.selectors.SIGNUP_FB).removeClass("hide")},setSafeMode:function(e,n){if(void 0===n&&(n=""),g.default.isLoggedIn()){var i=E.default.getCookieOptions();i.domain=s.get("page.cookie_domain"),t.cookie(r.PageController._safeModeCookieKey,e,i)}var o="/profile/safe-browse?enable="+e+"&url="+encodeURIComponent(n);window.location=o}});e.exports=v}).call(t,n(0),n(181),n(8),n(3),n(4))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(11),r=o(s),a=n(27),l=o(a),c=n(62),d=o(c),u=t.extend({},new l.default,{remoteHandler:null,cacheKey:"",cacheTTL:3600,remoteKey:"",init:function(e){this.remoteHandler=e},get:function(e){return this.getFromCache(e)},formatRemoteParams:function(e){return{}},getFromCache:function(){if(""==this.cacheKey)return i.log("getFromCache: empty cache key"),null;var e=d.default.storageImpl.getItem(this.cacheKey);return null==e?null:(e=JSON.parse(e),void 0==e.expireAt?(i.log("getFromCache: invalid cache. Reason: no expire time.  do clear:"+this.cacheKey),d.default.storageImpl.removeItem(this.cacheKey),null):e.expireAt<this.getCurrentTime()?(i.log("getFromCache: invalid cache. Reason: expired.  do clear:"+this.cacheKey),d.default.storageImpl.removeItem(this.cacheKey),null):e.data)},addToCache:function(e){return!1},removeFromCache:function(e){return!1},updateCache:function(e){if(""==this.cacheKey)return i.log("updateCache: empty cache key"),!1;var t={};return t.data=e,t.expireAt=this.cacheTTL+this.getCurrentTime(),d.default.storageImpl.setItem(this.cacheKey,(0,r.default)(t)),!0},clearCache:function(){return""==this.cacheKey?(i.log("clearCache: empty cache key"),null):(d.default.storageImpl.removeItem(this.cacheKey),!0)},getCurrentTime:function(){return Math.floor(Date.now()/1e3)}});e.exports=u}).call(t,n(0),n(2))},,,,,,,function(e,t,n){"use strict";var i={controllers:{},setController:function(e,t){this.controllers[e]=t},getController:function(e){return this.controllers[e]}};e.exports=i},function(e,t,n){"use strict";(function(t,i,o,s,r,a){function l(e){return e&&e.__esModule?e:{default:e}}var c=n(11),d=l(c),u=n(37),h=l(u),f=n(1),_=l(f),g=n(45),p=l(g),E=n(5),T=l(E),m=n(62),v=l(m),I=t.extend({},new _.default,{_isLoading:!1,_isLoadingHidden:!1,_page:1,_hiddenItemData:{},_noMoreItem:!1,_currentPosition:0,_cacheKey:"featured",_cacheExpireKey:"featured_expire",_cacheFeaturedMaxItemCount:50,_pageOneExpired:!1,_cacheTtl:900,_lastInsertIsAd:!1,_dataResult:[],_sidebarRepetitiveAdPlacementId:"sidebar_repetitive",STICKY_BUFFER_HEIGHT:1800,STICKY_SIDEBAR_ADS_ENABLED:!0,init:function(){this.bindScrollEvents(),this.bindClickEvents(),t.proxy(this.handlers.loadMoreScrollHandler,this)()},selectors:{TOP_NAV:"#top-nav",FOOTER:"#jsid-footer",SIDEBAR:"#sidebar",SIDEBAR_CONTAINER:"#sidebar-content",SIDEBAR_ITEMS:".badge-featured-item",SIDEBAR_ITEM_PREFIX:"#featured-item-",SIDEBAR_ADS:"#sidebar .badge-gag-ads-container",ITEM_CONTAINER:"#jsid-featured-item-container",FEATURED_AD:"#jsid-featured-sidebar-ad",DIV_GET_THE_APP:".get-the-app",LOADING_DIALOG:"#block-feature-cover .loading",SIDEBAR_FOOTER:"#sidebar .footer",POST_ENTRY_INFO:".badge-entry-info",MAIN_WRAPPER:".main-wrap",FEATURED_TAIL:"#jsid-featured-sidebar-tail",LOADING_SPINNER:".block-feature-cover .loading"},isStickySidebarAdsEnabled:function(){return this.STICKY_SIDEBAR_ADS_ENABLED},handlers:{windowScrollHandler:function(){t.proxy(I.handlers.loadMoreScrollHandler,this)()},resetSidebarToTop:function(){var e=I,n=t(e.selectors.SIDEBAR_CONTAINER);n.removeClass("sticky"),n.css({position:"",top:""})},getRanges:function(){var e=I,n=[],o=t(e.selectors.SIDEBAR_ADS),s=t(e.selectors.SIDEBAR_CONTAINER),r=e.STICKY_BUFFER_HEIGHT,a=0,l=0,c=[],d=s?parseInt(s.css("padding-top")):0;o.each(function(e,n){var i=t(n).position();c.push({y:i.top-d,h:t(n).height()})}),i.log("ad y-offsets without sticky (normalized)",c);for(var u=0;u<c.length-1;u++){var h=c[u];l+=u>0?c[u].y-c[u-1].y:0;var f={beg:h.y+a,end:h.y+a+r,type:"sticky",stickyBufferAccumulated:a,fixedOffsetAccumulated:l};n.push(f),a+=r;var _=u<c.length-1?c[u+1].y:99999999;n.push({beg:f.end,end:_+a,type:"post-sticky",stickyBufferAccumulated:a})}l+=c.length>1?c[c.length-1].y-c[c.length-2].y:0;var g=t(e.selectors.FEATURED_TAIL),p=g?g.height():0;return n.push({beg:n.length>0?n[n.length-1].end:0,end:99999999,type:"sticky",tailHeight:p,stickyBufferAccumulated:a,fixedOffsetAccumulated:l}),n},loadMoreScrollHandler:function(){var e=[];if(!(t(I.selectors.ITEM_CONTAINER).length<=0)){var n=I,r=o.PageController._topStickyElementHeight,a=t(window).height()-r,l=o.PageController.getWindowEffectiveScrollTop(),c=l+a,d=t(n.selectors.SIDEBAR_CONTAINER),u=d.offset().top,h=d.height(),f=u+h,_=f-c;t(n.selectors.FEATURED_TAIL);if(!s.isMobileDevice()&&n.isStickySidebarAdsEnabled()){try{e=I.handlers.getRanges()}catch(e){i.log(e)}var g=0,p=0,E=t(n.selectors.SIDEBAR),m=t(n.selectors.TOP_NAV);m&&!T.default.isPostPage()&&(p=m.height()),g=E?E.offset().top:0;var v=null,C=t(window).scrollTop(),O=C-g;i.log("relativeStickyOffsetsSum="+g+", fixedStickyOffsetsSum="+p),i.log("window.scrollTop="+C+", sidebar.scrollTop="+O),i.log("ranges",e);for(var y=0;y<e.length;y++){if(C<g-p){v=!1;break}if(O>=e[y].beg&&O<e[y].end){v=e[y];break}}for(var N=0,y=e.length-1;y>=0;y--)if(e[y].stickyBufferAccumulated){N=e[y].stickyBufferAccumulated;break}E&&E.height(d.height()+N);var A=(t(document).height(),t(window).height(),d.css("position")),R=null,P=t(n.selectors.FOOTER),S=(P.outerHeight()||0)+100;if(v)if("sticky"==v.type){var L=O-v.beg;v.tailHeight&&C+v.tailHeight+S>t(document).height()?"relative"!=A&&d.css({position:"relative",top:p+v.stickyBufferAccumulated+L,width:"inherit"}):R={position:"fixed",top:p-v.fixedOffsetAccumulated,width:"inherit"}}else"post-sticky"==v.type&&(R={position:"relative",top:p+v.stickyBufferAccumulated,width:"inherit"});else R=!1===v?{position:"relative",top:0,width:"inherit"}:{position:"fixed",top:p,width:"inherit"};null!=R&&(R.position==d.css("position")&&R.top+"px"==d.css("top")||(i.log("update style","t.position="+R.position+", t.top="+R.top+", c.p="+d.css("position")+"c.t="+d.css("top")),d.css(R)))}_<3*a&&n.loadMorePosts()}},loadMoreAjaxCallbackHandler:function(e){if(e&&e.okay){var n=I,i=n.getClickedItemIds();if(!e.result||0==e.result.length){if(!e.areHiddenItems&&!n._isLoadingHidden){var l=[];for(N=0;N<i.length;N++)n._hiddenItemData[i[N]]&&l.push(n._hiddenItemData[i[N]]);var c={okay:!0,result:l,areHiddenItems:!0};n._isLoadingHidden=!0,n.handlers.loadMoreAjaxCallbackHandler(c)}n._noMoreItem=!0}for(var d,u,f,_,g=t(n.selectors.ITEM_CONTAINER),E=g.data("item-displayed"),m=g.data("ads-tag"),v=0,C="",O={},y=[],N=0;N<e.result.length;N++){var A=e.result[N],R=n._currentPosition,P=p.default.getAdContainer(n._sidebarRepetitiveAdPlacementId,R);P&&(d=d||p.default.getCssStyle(P.adPlacement,"width"),u=u||p.default.getCssStyle(P.adPlacement,"height"),_="",d&&u&&(_="width: "+d+"; height: "+u+";"),f='<section class="badge-block-ad block-ad" style="'+_+'">                        <div id="jsid-ad-container-sidebar_repetitive-'+R+'" class="badge-gag-ads-container img-container" data-gag-ads="'+m+'" style="'+_+'"></div>                    </section>',n._lastInsertIsAd||(C+=f,v++,y.push(R),n._lastInsertIsAd=!0));var S='<li class="badge-featured-item" data-item-id="'+A.itemId+'" id="featured-item-'+A.itemId+'"                     data-item-pos="'+R+'" data-item-type="'+A.type+'" data-item-url="'+A.url+'">                    <a href="'+A.url+'?ref=fsidebar" class="badge-evt" target="_blank" >                        <div class="img-container" data-item-id="'+A.itemId+'">                          <img src="'+A.imageURL+'" />                        </div>                        <div class="info-container" data-item-id="'+A.itemId+'">                          <h3>'+A.title+"</h3>                        </div>                    </a>                </li>";0==t("#featured-item-"+A.itemId).length&&(T.default.isPostPage()&&A.url.indexOf(o.PostController._fastCurrentEntryKey)>-1?n.appendClickedItemId(parseInt(A.itemId)):(e.areHiddenItems||-1==t.inArray(parseInt(A.itemId),i)||"Recommendation"==A.type)&&n._currentPosition<E?(C+=S,n._currentPosition++,n._lastInsertIsAd=!1,void 0!==A.type&&(void 0===O[A.type]&&(O[A.type]=[]),O[A.type].push({position:n._currentPosition,url:A.url}))):n._hiddenItemData[A.itemId]=A),n._currentPosition>=E&&(n._noMoreItem=!0)}if(C.length>0){g.append(C);for(var L=(0,h.default)(O),b=0;b<L.length;b++)for(var w=L[b],k=s.arrayChunk(O[w],6),U=0;U<k.length;U++){for(var D={ItemType:w,SidebarId:r.getUuid()},M=k[U],F=0;F<M.length;F++){var x=M[F];D["SidebarItem"+x.position]=x.url}a.trackEvent("Sidebar","DisplaySidebar","","",D)}}v>0&&g.ready(function(){y.forEach(function(e){var t=p.default.getAdContainer(n._sidebarRepetitiveAdPlacementId,e);t&&p.default.renderAds(n._sidebarRepetitiveAdPlacementId,[t.adContainerId])})}),o.CacheController.notifyForCacheUpdate(o.CacheController.keys.FEATURED_LIST),n._page++,n._isLoading=!1,t.proxy(n.handlers.loadMoreScrollHandler(),n)}}},loadMorePosts:function(){var e=this;if(!e._isLoading&&!e._noMoreItem){e._isLoading=!0;var n=t(e.selectors.ITEM_CONTAINER),i=+n.data("load-more-trigger");if(e._page>1&&e._dataResult.length>0){var o=e._dataResult.slice((e._page-1)*i,e._page*i);return void t.proxy(e.handlers.loadMoreAjaxCallbackHandler.call(e,{okay:!0,result:o}),e)}var r="desktop",a="/read/ajax-featured?pageType=desktop",l=s.getCurrentEntryId();if(l&&(a="/read/ajax-featured/"+l+"?pageType=desktop",r="desktop-"+l),!v.default.sessionStorageImpl||!v.default.sessionStorageImpl.getItem(a)||e._pageOneExpired||1==e._page&&e.isCacheExpired(r))t(e.selectors.LOADING_SPINNER).removeClass("hide"),t.ajax({type:"GET",crossDomain:!0,dataType:"jsonp",jsonpCallback:"data",cache:"true",url:a,success:function(n){t(e.selectors.LOADING_SPINNER).addClass("hide"),v.default.sessionStorageImpl&&(1==e._page&&(e.checkAndUpdateCacheExpireTime(r),e._pageOneExpired=!0),v.default.sessionStorageImpl.setItem(a,(0,d.default)(n))),n&&n.okay&&n.result&&n.result.length>0&&(n.result=e.orderItems(n.result),e._dataResult=n.result,n.result=n.result.slice((e._page-1)*i,e._page*i)),t.proxy(e.handlers.loadMoreAjaxCallbackHandler.call(e,n),e)},error:function(){e._noMoreItem=!0,e._isLoading=!1,t(e.selectors.LOADING_SPINNER).addClass("hide")}});else{var c=JSON.parse(v.default.sessionStorageImpl.getItem(a));c.result=e.orderItems(c.result),e._dataResult=c.result,c.result=c.result.slice((e._page-1)*i,e._page*i),t.proxy(e.handlers.loadMoreAjaxCallbackHandler.call(e,c),e)}}},getCacheExpireTimes:function(){var e={};return v.default.sessionStorageImpl.getItem(this._cacheExpireKey)&&(e=JSON.parse(v.default.sessionStorageImpl.getItem(this._cacheExpireKey))),e||{}},setCacheExpireTime:function(e,t){var n=this,i=n.getCacheExpireTimes();i[e]=t,v.default.sessionStorageImpl.setItem(this._cacheExpireKey,(0,d.default)(i))},checkAndUpdateCacheExpireTime:function(e){var n=this;n.isCacheExpired(e)&&n.setCacheExpireTime(e,t.now()+1e3*n._cacheTtl)},isCacheExpired:function(e){var n=this,i=n.getCacheExpireTimes(),o=!0;return i[e]>t.now()&&(o=!1),o},appendClickedItemId:function(e){var n=this.getClickedItemIds();if(n){var i=t.inArray(e,n);-1==i?n.push(e):(n.splice(i,1),n.push(e)),n.length>this._cacheFeaturedMaxItemCount&&(n=n.slice(n.length-this._cacheFeaturedMaxItemCount))}else{var n=[];n.push(e)}v.default.storageImpl.setItem(this._cacheKey,(0,d.default)(n))},getClickedItemIds:function(){var e=v.default.storageImpl.getItem(this._cacheKey),t=JSON.parse(e);return t||[]},bindScrollEvents:function(){t(window).on("scroll resize",null,null,t.proxy(this.handlers.windowScrollHandler,this))},bindClickEvents:function(){var e=this;t("#jsid-featured-item-container").on("click",".badge-featured-item",function(n){var i=t(this).data("itemId"),o={ItemType:t(this).data("itemType"),ItemUrl:t(this).data("itemUrl"),ItemPos:t(this).data("itemPos"),SidebarId:r.getUuid()};a.trackEvent("Sidebar","ClickSidebar","","",o),e.appendClickedItemId(i)})},orderItems:function(e){for(var t=[],n=[],i=0;i<e.length;i++)"Recommendation"==e[i].type?t.push(e[i]):n.push(e[i]);return t.concat(this.shuffle(n))},shuffle:function(e){for(var t,n=e.length,i=0;n--;)i=Math.floor(Math.random()*(n+1)),t=e[n],e[n]=e[i],e[i]=t;return e}});e.exports=I}).call(t,n(0),n(2),n(4),n(12),n(3),n(18))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(1),r=o(s),a=n(150),l=o(a),c=n(5),d=o(c),u=t.extend({},new r.default,{adConfigs:{},rcfgAdConfigs:{},targetedAdConfigs:{},currentAdView:"",defaultAdView:"",adServiceEnabled:!1,fixedAdPlacementsInAdViews:{sidebar:["sidebar_top","sidebar_bottom"],footer:[],postBottom:[]},init:function(){this.rcfgAdConfigs=i.get("rcfgAds"),this.targetedAdConfigs=i.get("targetedAdTags"),this.currentAdView="list_default",this.defaultAdView="list_default",this.adServiceEnabled=!0,this.setCurrentAdView(),this.adConfigs=this.targetedAdTagsOverride(),this.initAdPlugin(),this.renderSidebarTopAndBottomAds(),this.renderPostBottomAds(),this.renderFooterAds()},initAdPlugin:function(){var e={};try{e=l.default.init(this.adConfigs,this.currentAdView,this.defaultAdView)}catch(e){}void 0!==e.adServiceEnabled&&(this.adServiceEnabled=e.adServiceEnabled,this.currentAdView=e.selectedAdView)},targetedAdTagsOverride:function(){var e=this.rcfgAdConfigs,n=t.cookie("____lo");for(var i in this.targetedAdConfigs)if(this.targetedAdConfigs.hasOwnProperty(i)){var o=this.targetedAdConfigs[i],s=o.placements;for(var r in s)if(s.hasOwnProperty(r)){var a=s[r];"string"!=typeof n&&(n="ALL");var l=null;if(a.hasOwnProperty(n))l=a[n];else if(a.hasOwnProperty("ALL")){var c=a.ALL.rules[0].excludeCountry;-1==c.indexOf(n)&&(l=a.ALL)}if(null!=l){var d=this.defaultAdView;e.hasOwnProperty(this.currentAdView)&&(d=this.currentAdView),e[d].placements.hasOwnProperty(r)||(e[d].placements[r]={rules:{}}),e[d].placements[r].rules=l.rules,e[d].displayAdEnabled=!0}}}return e},setCurrentAdView:function(){var e=d.default.getPageKey();if(""!=e){if(d.default.isPostPage())return this.defaultAdView="post_default",void(d.default.isHouseAdPostPage()?this.currentAdView="post_housead":d.default.isFreshPostPage()?this.currentAdView="post_fresh":d.default.isNsfwPostPage()?this.currentAdView="post_nsfw":this.currentAdView="post_default");if(d.default.isProfilePage())return void(this.currentAdView="profile");var t=e.toLowerCase().split("-");if(t.length>=2){var n=t[t.length-1];if("hot"==n||"fresh"==n)return this.defaultAdView="section_"+n,t.pop(),void(this.currentAdView=t.join("-").replace(/_/g,"-")+"_"+n)}if("hot"==t[0]||"trending"==t[0]||"fresh"==t[0])return void(this.currentAdView=t[0])}var i=window.location.pathname.toLowerCase().split("/");i.length>1&&""!=i[1]&&(this.currentAdView=i[1])},renderFooterAds:function(){var e=this,t=e.getFooterPlacements();t&&t.forEach(function(t){e.renderPlacement(t)})},renderPostBottomAds:function(){var e=this,t=e.getPostBottomPlacements();t&&t.forEach(function(t){e.renderPlacement(t)})},renderPlacement:function(e,t){var n=this,i=n.getAdContainer(e,t);if(i){var o=u.getCssStyle(i.adPlacement,"width"),s=u.getCssStyle(i.adPlacement,"height");o&&s&&n.applyAdsWidthHeight(i.adContainerId,o,s),n.renderAds(e,[i.adContainerId])}},switchAdView:function(e,t){try{l.default.switchAdView(e,t)}catch(e){}},getAdContainer:function(e,t){var n=null;if(this.adServiceEnabled)try{n=l.default.getAdPlacementContainerByPosition(e,t)}catch(e){}return n},renderAds:function(e,t){this.adServiceEnabled&&l.default.renderAds(e,t)},reRenderAds:function(){var e=this;l.default.switchAdView(e.currentAdView,e.defaultAdView),e.renderSidebarTopAndBottomAds(),e.renderAllSidebarRepetitiveAds(),e.renderPostBottomAds(),e.renderFooterAds()},renderSidebarTopAndBottomAds:function(){var e=this,t=e.getSidebarTopAndBottomPlacements();t&&t.forEach(function(t){e.renderPlacement(t)})},renderAllSidebarRepetitiveAds:function(){var e=this,n=t("#jsid-featured-item-container").find(".badge-gag-ads-container");n&&n.each(function(t){var i=n[t].id;if("string"==typeof i){var o=i.split("-").pop();e.renderPlacement("sidebar_repetitive",parseInt(o))}})},getSidebarTopAndBottomPlacements:function(){return this.fixedAdPlacementsInAdViews.sidebar},getFooterPlacements:function(){return this.fixedAdPlacementsInAdViews.footer},getPostBottomPlacements:function(){return this.fixedAdPlacementsInAdViews.postBottom},getCssStyle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"height";return void 0!==e.rule&&void 0!==e.rule[t]?e.rule[t]:null},applyAdsWidthHeight:function(e,n,i){t("#"+e).css({width:n,height:i})}});e.exports=u}).call(t,n(0),n(3))},function(e,t,n){"use strict";(function(t,i,o,s,r,a){function l(e){return e&&e.__esModule?e:{default:e}}var c=n(1),d=l(c),u=n(26),h=l(u),f=n(5),_=l(f),g=n(63),p=l(g),E=n(64),T=l(E),m=n(83),v=t.extend({},new d.default,{TITLE_LENGTH_WARNING_THRESHOLD:20,_sectionsCountMax:0,_isUploadingImage:!1,_isVerifyingUrl:!1,_verifyUrlAjax:!1,_quotaCountDown:!1,ENTER_KEY:13,COMMA_KEY:188,BACKSPACE_KEY:8,init:function(){if(this._showLocaleSections(),this._bindElements(),this._sectionsCountMax=t(this.selectors.SECTION_LIST).data("sections-count-max"),_.default.isUploadPage()){h.default.showOverlay(h.default.selectors.OVERLAY_COMPONENT_UPLOAD);var e=t("#jsid-get-url").text(),n=t("#jsid-get-title").text();""!=e?(this.showUploadStep(this.selectors.UPLOAD_URL_STEP),t(this.selectors.UPLOAD_URL_INPUT).val(e),this._validateUrl(),""!=n&&t(this.selectors.UPLOAD_TITLE_INPUT).val(n),this.showUploadStep(this.selectors.UPLOAD_URL_STEP)):this.showUploadStep(this.selectors.UPLOAD_FILE_STEP)}},selectors:{UPLOAD_URL_BTN:"#jsid-upload-url-btn",UPLOAD_FILE_BTN:"#jsid-upload-file-btn",UPLOAD_FILE_BTN_TEXT:".badge-drop-zone-text",UPLOAD_URL_NEXT_BTN:".badge-upload-url-next-btn",UPLOAD_URL_BACK_BTN:".badge-upload-url-back-btn",UPLOAD_INFO_NEXT_BTN:".badge-upload-info-next-btn",UPLOAD_INFO_BACK_BTN:".badge-upload-info-back-btn",UPLOAD_POST_PICK_SECTION_POST_BTN:".badge-upload-pick-section-post-btn",UPLOAD_POST_PICK_SECTION_BACK_BTN:".badge-upload-pick-section-back-btn",UPLOAD_URL_INPUT:"#jsid-upload-url-input",UPLOAD_FILE_INPUT:"#jsid-upload-file-input",UPLOAD_CHAR_COUNT:"#jsid-char-count",UPLOAD_TITLE_INPUT:"#jsid-upload-title",UPLOAD_SOURCE_CHECKBOX:"#jsid-source-checkbox",UPLOAD_SOURCE_CHECKBOX_LABEL:"#jsid-source-checkbox-label",UPLOAD_SOURCE_INPUT:"#jsid-source-input",UPLOAD_SOURCE_CHECKBOX_DIV:"#jsid-source-checkbox-div",UPLOAD_SOURCE_INPUT_TEXTBOX:"#jsid-source-input-textbox",UPLOAD_SUBMIT_BTN:"#jsid-submit-btn",UPLOAD_DISABLE_MASK:"#jsid-disable-mask",UPLOAD_STEP:".badge-upload-step",UPLOAD_FILE_STEP:".badge-upload-file-step",UPLOAD_URL_STEP:".badge-upload-url-step",UPLOAD_INFO_STEP:".badge-upload-info-step",UPLOAD_PICK_SECTION_STEP:".badge-upload-pick-section-step",UPLOAD_FILE_PREVIEW:"#jsid-upload-file-preview",UPLOAD_INFO_MESSAGE:".badge-upload-info-message",UPLOAD_URL_MESSAGE:".badge-upload-url-message",UPLOAD_FILE_ID:"#jsid-upload-file-id",UPLOAD_FILE_CAPTCHA:".badge-upload-captcha",UPLOAD_CSRF_TOKEN:"#jsid-upload-csrf-token",UPLOAD_CONTENT_ERROR_LABEL:"#jsid-upload-content-error",UPLOAD_TITLE_ERROR_LABEL:"#jsid-upload-title-error",UPLOAD_ERROR_LABEL:"#jsid-upload-error",UPLOAD_SECTION_ERROR_LABEL:"#jsid-upload-section-error",UPLOAD_TAG_LIST:".badge-upload-tag-list",UPLOAD_TAG_SCROLL_CONTAINER:".badge-upload-scroll-container",UPLOAD_TAG_INPUT:"#jsid-upload-tag-input",UPLOAD_TAG_FIELD:".badge-upload-tag",UPLOAD_TAG_ITEM:".badge-upload-tag-item",UPLOAD_TAG_REMOVE:".badge-upload-tag-remove",UPLOAD_TAG_STEP:".badge-upload-tag-step",UPLOAD_IS_NSFW:"#jsid-upload-is-nsfw",SECTION_LIST:"#jsid-section-list",SECTION_LIST_ITEMS:".badge-upload-section-list-item",SECTION_LIST_ITEMS_SELECTOR:".badge-upload-section-list-item-selector",SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM:".badge-upload-section-list-profile-only",SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM_SELECTOR:".badge-upload-section-list-item-profile-only",DROPZONE_TEMPLATE:"#jsid-drop-zone-template",DROPZONE_PREVIEW:"#jsid-drop-zone-preview"},css:{METHOD_SELECTED:"upload-selected",TITLE_WARNING:"warn"},showUploadStep:function(e,n){n=n||"",t(this.selectors.UPLOAD_STEP).addClass("hide"),t(e).removeClass("hide"),e===this.selectors.UPLOAD_INFO_STEP?(t(this.selectors.UPLOAD_TITLE_INPUT).focus(),i.get("user.showCaptcha")&&t(this.selectors.UPLOAD_FILE_CAPTCHA).removeClass("hide"),this.showUploadInfoMessage(this.selectors.UPLOAD_INFO_MESSAGE,n)):e===this.selectors.UPLOAD_URL_STEP?(t(this.selectors.UPLOAD_URL_INPUT).focus(),this.showUploadInfoMessage(this.selectors.UPLOAD_URL_MESSAGE,n)):e===this.selectors.UPLOAD_TAG_STEP&&this.showUploadInfoMessage(this.selectors.UPLOAD_INFO_MESSAGE,n)},showUploadInfoMessage:function(e,n){""==n?t(e).addClass("hide"):(t(e).html(n),t(e).removeClass("hide"))},_setCharCount:function(e){var n=t(e.currentTarget),i=parseInt(n.data("maxlength"),10),o=n.val().length,s=i-o,r=t(this.selectors.UPLOAD_CHAR_COUNT).text(s);s<=this.TITLE_LENGTH_WARNING_THRESHOLD?r.addClass(this.css.TITLE_WARNING):r.removeClass(this.css.TITLE_WARNING)},_validateUrl:function(e){t(this.selectors.UPLOAD_URL_INPUT).val().length>0&&"Loading"!=t(this.selectors.UPLOAD_URL_NEXT_BTN).text()?t(this.selectors.UPLOAD_URL_NEXT_BTN).removeClass("disabled"):t(this.selectors.UPLOAD_URL_NEXT_BTN).addClass("disabled")},_updateSourceFields:function(e){var n=t(this.selectors.UPLOAD_SOURCE_CHECKBOX),i=t(this.selectors.UPLOAD_SOURCE_INPUT);n.is(":checked")?(i.removeClass("hide"),i.addClass("last"),t(this.selectors.UPLOAD_SOURCE_CHECKBOX_DIV).removeClass("last")):(i.addClass("hide"),i.removeClass("last"),t(this.selectors.UPLOAD_SOURCE_CHECKBOX_DIV).addClass("last"))},_updateSections:function(e){e.preventDefault();var n=v;1==n._sectionsCountMax&&t(n.selectors.SECTION_LIST).find(n.selectors.SECTION_LIST_ITEMS_SELECTOR).removeClass("selected");var i=0,o=t(e.target).closest(n.selectors.SECTION_LIST_ITEMS);!o.find(n.selectors.SECTION_LIST_ITEMS_SELECTOR).hasClass("selected")&&(i++,o.is(n.selectors.SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM)?t(n.selectors.SECTION_LIST).find(n.selectors.SECTION_LIST_ITEMS_SELECTOR).removeClass("selected"):t(n.selectors.SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM_SELECTOR).removeClass("selected")),i+=t(n.selectors.SECTION_LIST).find(n.selectors.SECTION_LIST_ITEMS_SELECTOR+".selected").length,i<=n._sectionsCountMax&&o.find(n.selectors.SECTION_LIST_ITEMS_SELECTOR).toggleClass("selected"),i>0||t(n.selectors.SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM_SELECTOR).hasClass("selected")?t(n.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).removeClass("disabled"):t(n.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).addClass("disabled")},_getTitleError:function(){var e=t(this.selectors.UPLOAD_TITLE_INPUT).val(),n=t(this.selectors.UPLOAD_TITLE_INPUT).data("minlength"),i=t(this.selectors.UPLOAD_TITLE_INPUT).data("maxlength"),o=e.replace(/[\t!?,:;\-\s\.]/g,"").replace(/[\u2000-\u206F\u2E00-\u2E7F]/g,"");return!e||o.length<n?"Give a funny, creative and descriptive title to the post would give the post a boost!":e.length>i?"Your title is a bit long. Be concise!":void 0},_isValidImageUrl:function(e){var t=/^http(s?):\/\//i;return e.toLowerCase().match(t)},_isValidImageExtension:function(e){e+="";var t=e.split(".").pop(),n=/(jpeg|jpg|gif|png)/i;return t.match(n)},initialize:function(){var e=this;if(0==t(this.selectors.DROPZONE_TEMPLATE).length)return!1;new m("html",{url:"/submit/upload-image",thumbnailWidth:600,thumbnailHeight:600,previewsContainer:this.selectors.DROPZONE_PREVIEW,clickable:this.selectors.UPLOAD_FILE_BTN,acceptedMimeTypes:"image/jpeg, image/jpg, image/png, image/gif, video/mp4, video/webm, video/quicktime, video/x-m4v",previewTemplate:t(this.selectors.DROPZONE_TEMPLATE).html(),maxFilesize:e.getMaxFilesize()}).on("dragover",function(t){_.default.isUploadPage()||e._isUploadingImage||h.default.showOverlay(h.default.selectors.OVERLAY_COMPONENT_DRAG_AND_DROP)}).on("addedfile",function(n){t(e.selectors.UPLOAD_FILE_PREVIEW).html(o.getSpinnerHtml()),t(e.selectors.UPLOAD_INFO_NEXT_BTN).addClass("disabled"),t(e.selectors.UPLOAD_URL_INPUT).val(""),h.default.showOverlay(h.default.selectors.OVERLAY_COMPONENT_UPLOAD),e.showUploadStep(e.selectors.UPLOAD_INFO_STEP),s.track("UploadAction","Upload","Image"),null!=this.files[1]&&this.removeFile(this.files[0])}).on("drop",function(t){if(e._isUploadingImage)return!1;_.default.isUploadPage()||h.default.hideAllOverlay(),s.track("UploadAction","DragFile","Image"),e._isUploadingImage=!0}).on("success",function(t,n){e.uploadedFile(n,t)}).on("error",function(t,n){e.uploadedFile({okay:!1,message:"Error occurred while uploading photo."},t)}).on("complete",function(t){var n="image/gif"===t.type,o=0==t.type.indexOf("image/")&&!n,r=e.isVideoFile(t);o||r||n?r&&t.size>i.get("configs.maxVideoFilesize")?(e.uploadedFile({okay:!1,message:"File size is too large."},t),s.track("UploadAction","UploadError","ExceedMaxVideoFileSize")):n&&t.size>i.get("configs.maxGifFilesize")?(e.uploadedFile({okay:!1,message:"File size is too large."},t),s.track("UploadAction","UploadError","ExceedMaxGifFileSize")):o&&t.size>i.get("configs.maxFilesize")&&(e.uploadedFile({okay:!1,message:"File size is too large."},t),s.track("UploadAction","UploadError","ExceedMaxFileSize")):(e.uploadedFile({okay:!1,message:"Unsupported type."},t),s.track("UploadAction","UploadError","UnSupportedType")),e._isUploadingImage=!1})},getMaxFilesize:function(){return Math.max(i.get("configs.maxFilesize"),i.get("configs.maxVideoFilesize"))/1024/1024},isVideoFile:function(e){return 0==e.type.indexOf("video/")},uploadedFile:function(e,n){if(e.okay){if(this.isVideoFile(n)){var i=URL.createObjectURL(n);this.updatePreviewHotlink("video",i)}else t(this.selectors.UPLOAD_FILE_PREVIEW).html(t(this.selectors.DROPZONE_PREVIEW).html());t(".dz-image").removeClass("hide"),t(this.selectors.UPLOAD_INFO_NEXT_BTN).removeClass("disabled"),t(this.selectors.UPLOAD_FILE_ID).val(e.uploadId),t(this.selectors.UPLOAD_CSRF_TOKEN).val(e.csrftoken)}else t(this.selectors.UPLOAD_FILE_PREVIEW).html(""),e.message&&""!=e.message&&this.showUploadStep(this.selectors.UPLOAD_INFO_STEP,e.message),this.startQuotaCountDown();t(this.selectors.UPLOAD_FILE_PREVIEW).removeClass("uploading")},urlNext:function(){var e=t(this.selectors.UPLOAD_URL_INPUT).val();if(e.length)return this._isValidImageUrl(e)?void this.ajaxVerifyUrl(e):void this.showUploadStep(this.selectors.UPLOAD_URL_STEP,"Invalid URL.")},ajaxVerifyUrl:function(e){var n=this;if(!this._isVerifyingUrl){this._isVerifyingUrl=!0,t(this.selectors.UPLOAD_URL_NEXT_BTN).addClass("disabled").text("Loading");var i={url:e};this._verifyUrlAjax=t.ajax({type:"POST",dataType:"json",url:"/submit/verify-url",data:i,success:function(e){e.okay?(n.showUploadStep(v.selectors.UPLOAD_INFO_STEP),s.track("UploadAction","Upload","Url"),t(n.selectors.UPLOAD_INFO_NEXT_BTN).removeClass("disabled"),e.previewType&&e.previewUrl&&""!=e.previewType&&""!=e.previewUrl?n.updatePreviewHotlink(e.previewType,e.previewUrl):n.updatePreviewHotlink(),t(n.selectors.UPLOAD_CSRF_TOKEN).val(e.csrftoken),t(n.selectors.UPLOAD_FILE_ID).val(e.uploadId)):e.message&&""!=e.message&&n.showUploadStep(v.selectors.UPLOAD_URL_STEP,e.message)},error:function(e,t){"abort"!=t&&n.showUploadStep(v.selectors.UPLOAD_URL_STEP,"Error occurred.")},complete:function(){t(n.selectors.UPLOAD_URL_NEXT_BTN).removeClass("disabled").text("Next"),n._isVerifyingUrl=!1}})}},updatePreviewHotlink:function(e,n){"photo"==e?t(this.selectors.UPLOAD_FILE_PREVIEW).html('<img src="'+n+'" />'):"video"==e?t(this.selectors.UPLOAD_FILE_PREVIEW).html('<video src="'+n+'" muted />'):t(this.selectors.UPLOAD_FILE_PREVIEW).html("")},validateUploadInfo:function(){var e=this._getTitleError(),n=this._checkTagField();return e?(this.showUploadStep(this.selectors.UPLOAD_INFO_STEP,e),!1):i.get("user.showCaptcha")&&!t("[name=g-recaptcha-response]",this.selectors.UPLOAD_INFO_STEP).val()?(this.showUploadStep(this.selectors.UPLOAD_INFO_STEP,"Wrong CAPTCHA."),!1):!n},_pad:function(e,t){return void 0==t&&(t="0"),e<10?t+""+e:e},_convertTime:function(e){var t=0,n=0,i=0,o=0;e<0&&(e=0),t=parseInt(e/86400),e-=86400*t,n=parseInt(e/3600),e-=3600*n,i=parseInt(e/60),e-=60*i,o=e;var s="";return t>0&&(s+=this._pad(t)+":"),s+=this._pad(n)+":",s+=this._pad(i)+":",s+=this._pad(o)},_updateDisplay:function(e){var t=e.data("timestamp"),n=Math.round((new Date).getTime()/1e3),i=e.data("start");null==i&&(i=n,e.data("start",i));var o=n-i;e.text(this._convertTime(t-o))},_updateAll:function(){var e=this;t(".badge-countdown").each(function(){e._updateDisplay(t(this))})},startQuotaCountDown:function(){this._quotaCountDown||(this._updateAll(),this._quotaCountDown=setInterval(this._updateAll.bind(this),1e3))},_showLocaleSections:function(){t(this.selectors.SECTION_LIST).find("li").each(function(){if("string"==typeof t(this).attr("data-locales")){var e=t(this).attr("data-locales").split(",");e.length>0&&r.isMatchAnyLocales(e)&&t(this).removeClass("hide")}})},_checkTagField:function(){var e=t(this.selectors.UPLOAD_TAG_LIST).children().length,n=t(this.selectors.UPLOAD_TAG_INPUT);if(e<n.data("countmax")&&n.show(),0===e&&n.attr("placeholder",n.data("placeholder")),e>n.data("countmax"))return!1;t(this.selectors.UPLOAD_TAG_LIST).children().each(function(){var e=t(this).data("tag").length;if(e<n.data("lengthmin")||e>n.data("lengthmax"))return!1})},_bindElements:function(){var e=this;t(this.selectors.UPLOAD_FILE_BTN).on("click",t.proxy(function(e){s.track("UploadAction","TapSelectImage")},this)),t(this.selectors.UPLOAD_URL_BTN).on("click",t.proxy(function(t){t.preventDefault(),e.showUploadStep(this.selectors.UPLOAD_URL_STEP),s.track("UploadAction","TapAddUrl")},this)),t(this.selectors.UPLOAD_URL_NEXT_BTN).on("click",t.proxy(function(t){t.preventDefault(),e.urlNext()},this)),t(this.selectors.UPLOAD_INFO_NEXT_BTN).on("click",t.proxy(function(n){return n.preventDefault(),!t(n.target).hasClass("disabled")&&(!!e.validateUploadInfo()&&(e.showUploadStep(this.selectors.UPLOAD_PICK_SECTION_STEP),void s.track("UploadAction","SubmitPostTitle")))},this)),t(this.selectors.UPLOAD_URL_BACK_BTN).on("click",t.proxy(function(t){t.preventDefault(),e.showUploadStep(this.selectors.UPLOAD_FILE_STEP),e._verifyUrlAjax&&4!=e._verifyUrlAjax.readyState&&e._verifyUrlAjax.abort()},this)),t(this.selectors.UPLOAD_INFO_BACK_BTN).on("click",t.proxy(function(t){t.preventDefault(),e.showUploadStep(this.selectors.UPLOAD_FILE_STEP)},this)),t(this.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).on("click",t.proxy(function(t){t.preventDefault(),e.submitUpload(),s.track("UploadAction","SubmitUpload")},this)),t(this.selectors.UPLOAD_POST_PICK_SECTION_BACK_BTN).on("click",t.proxy(function(t){t.preventDefault(),e.showUploadStep(this.selectors.UPLOAD_INFO_STEP)},this)),t(this.selectors.UPLOAD_FILE_PREVIEW).on("click",t.proxy(function(n){if(n.preventDefault(),null!=t(e.selectors.UPLOAD_FILE_PREVIEW).find("img, video").attr("src")){var i=t(e.selectors.UPLOAD_FILE_PREVIEW).find("img, video").clone().prop("autoplay",!0);e.showPostZoomOverlay(i),s.track("UploadAction","TapPreviewImage")}})),t(this.selectors.UPLOAD_URL_INPUT).keypress(function(t){13==t.which&&e.urlNext(),t.stopPropagation()}).on("paste",function(t){setTimeout(function(){e.urlNext()},50),t.stopPropagation()}),t(this.selectors.UPLOAD_TAG_INPUT).keydown(function(n){if(n.which===e.COMMA_KEY&&n.preventDefault(),n.which===e.ENTER_KEY||n.which===e.COMMA_KEY){var i=t(this).val().trim();if(""===i)return;var o="";if(i.match(/[,~`!@#$%^&*(){}[\];:"'<.>?\/\\|_+=]/)&&(o="Oops! Tags can contain alphanumerics, numbers and spaces only!"),i.length<t(this).data("lengthmin")&&(o="Oops! Tag is too short"),i.length>t(this).data("lengthmax")&&(o="Oops! Tag is too long"),e.showUploadStep(e.selectors.UPLOAD_TAG_STEP,o),""!==o)return;t(e.selectors.UPLOAD_TAG_LIST).append('<span class="tag tag-item badge-upload-tag-item" data-tag="'+i+'">'+i+'<span class="remove badge-upload-tag-remove">&times;</span></span>'),t(this).val(""),t(this).removeAttr("placeholder");var s=t(e.selectors.UPLOAD_TAG_SCROLL_CONTAINER).width();t(e.selectors.UPLOAD_TAG_SCROLL_CONTAINER).scrollLeft(s),t(e.selectors.UPLOAD_TAG_LIST).children().length===t(this).data("countmax")&&t(this).hide()}if(n.which===e.BACKSPACE_KEY&&""===t(e.selectors.UPLOAD_TAG_INPUT).val()){var r=t(e.selectors.UPLOAD_TAG_LIST).children().length;r>0&&t(e.selectors.UPLOAD_TAG_LIST+" span:nth-child("+r+")").remove(),e._checkTagField()}}),t(this.selectors.UPLOAD_TAG_FIELD).on("click",this.selectors.UPLOAD_TAG_REMOVE,function(n){t(this).parent().remove(),e._checkTagField()}),t(this.selectors.UPLOAD_TITLE_INPUT).on("keydown input",t.proxy(function(e){setTimeout(t.proxy(this._setCharCount,this,e),50)},this)),t(this.selectors.UPLOAD_URL_INPUT).on("keydown input",t.proxy(function(e){setTimeout(t.proxy(this._validateUrl,this,e),50)},this)),t(this.selectors.UPLOAD_SOURCE_CHECKBOX).on("change",t.proxy(this._updateSourceFields,this)),t(this.selectors.SECTION_LIST_ITEMS).on("click",this._updateSections)},showPostZoomOverlay:function(e){t(a.PostController.selectors.MODAL_POST_ZOOM_CONTAINER).find(".badge-post-zoom-img").html(e),t(a.PostController.selectors.MODAL_POST_ZOOM_CONTAINER).find("video").prop({loop:!0}),h.default.showOverlay(a.PostController.selectors.MODAL_POST_ZOOM_CONTAINER),h.default._hideAllOverlayReturnToUpload=!0,h.default.setHideUsingBackground(!0)},submitUpload:function(){var e=this,n=t(this.selectors.UPLOAD_TITLE_INPUT).val(),i=0;t(this.selectors.UPLOAD_IS_NSFW).is(":checked")&&(i=1);var o=t(this.selectors.UPLOAD_FILE_ID).val(),s=this.getSelectedSectionUrls(),r=t(this.selectors.UPLOAD_SOURCE_INPUT_TEXTBOX).val(),a=t("[name=g-recaptcha-response]",this.selectors.UPLOAD_INFO_STEP).val(),l=t(this.selectors.UPLOAD_CSRF_TOKEN).val(),c=0,d=[];t(this.selectors.UPLOAD_TAG_LIST).children().each(function(){d.push(t(this).data("tag"))}),d=d.join(","),t(this.selectors.SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM_SELECTOR).hasClass("selected")&&(c=1);var u={title:n,nsfw:i,uploadId:o,type:"Photo",section:s,source:r,"g-recaptcha-response":a,csrftoken:l,skipFromLists:c,tags:d};t(this.selectors.SECTION_LIST).addClass("disabled"),t(this.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).addClass("disabled"),t(this.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).text("Posting"),t(this.selectors.UPLOAD_POST_PICK_SECTION_BACK_BTN).addClass("disabled"),t(h.default.selectors.OVERLAY_CLOSE_BUTTON).addClass("hide");var f=function(n){var i=n&&n.message&&n.message.length?n.message:"Error occurred. Please try again.";e.showUploadStep(v.selectors.UPLOAD_INFO_STEP,i),t(e.selectors.SECTION_LIST).removeClass("disabled"),t(e.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).removeClass("disabled"),t(e.selectors.UPLOAD_POST_PICK_SECTION_POST_BTN).text("Post"),t(e.selectors.UPLOAD_POST_PICK_SECTION_BACK_BTN).removeClass("disabled"),t(h.default.selectors.OVERLAY_CLOSE_BUTTON).removeClass("hide"),e.startQuotaCountDown()};t.ajax({type:"POST",dataType:"json",url:"/submit",data:u,success:function(e){if(e.okay)return p.default.clearCache(),T.default.clearCache(),void(window.location.href=e.postUrl);f(e)},error:function(){f()}})},getSelectedSectionUrls:function(){var e=[];return t(this.selectors.SECTION_LIST).find(this.selectors.SECTION_LIST_ITEMS_SELECTOR+".selected").each(function(n,i){e.push(t(i).data("url"))}),e},updateMyProfileOnlyIcon:function(e){null!=e?t(this.selectors.SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM).find(".icon").html('<img src="'+e+'"/>'):t(this.selectors.SECTION_LIST_ITEMS_PROFILE_ONLY_ITEM).find(".icon").html("")}});e.exports=v}).call(t,n(0),n(3),n(12),n(8),n(90),n(4))},function(e,t,n){"use strict";(function(t,n){var i={init:function(){t.init(n.get("configs.t"))},onWindowLoad:function(){t.reportPerf()},uniqueViewed:function(e){t.uniqueViewed(e)},event:function(e,i,o){var s=n.get("user.id");s&&(o.user=s),t.event(e,i,o)},logTime:function(e,n){t.logTime(e,n)},logCount:function(e,n){t.logCount(e,n)},downloadFail:function(e){t.downloadFail(e)}};e.exports=i}).call(t,n(91),n(3))},,,,,,,,,,function(e,t,n){"use strict";var i={storageImpl:{},nonPersistentLS:{structureLocalStorage:{},setItem:function(e,t){this.structureLocalStorage[e]=t},getItem:function(e){return void 0!==this.structureLocalStorage[e]?this.structureLocalStorage[e]:null},removeItem:function(e){this.structureLocalStorage[e]=void 0}},hasLocalStorage:function(){try{return localStorage.setItem("test","test"),localStorage.removeItem("test"),!0}catch(e){return!1}},getStore:function(){return this.storageImpl=this.nonPersistentLS,this.hasLocalStorage()&&(this.storageImpl=localStorage),this.storageImpl}};e.exports=i},function(e,t,n){"use strict";var i={aggregatePeriod:800,timers:{},pendingUpdate:{},listeners:[],addListener:function(e){this.listeners.push(e)},removeListeners:function(){this.listeners=[]},onVideoTimeUpdate:function(e,t,n,i,o){var s=this.pendingUpdate[e.key];if(this.pendingUpdate[e.key]={data:e,isPlaying:t,currentTime:n,duration:i,startTime:o},!s){var r=this;setTimeout(function(){r._onVideoTimeUpdate(r.pendingUpdate[e.key]),r.pendingUpdate[e.key]=null},this.aggregatePeriod)}},_onVideoTimeUpdate:function(e){if(e)for(var t=0;t<this.listeners.length;t++)this.listeners[t](e.data,e.isPlaying,e.currentTime,e.duration,e.startTime)}};e.exports=i},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(1),a=s(r),l=n(60),c=s(l),d=n(5),u=s(d),h=n(180),f=s(h),_=t.extend({},new a.default,function(){var e={JUMP_PREV:"JUMP_PREV",JUMP_NEXT:"JUMP_NEXT",VOTE_UP:"VOTE_UP",VOTE_DOWN:"VOTE_DOWN",UNVOTE:"UNVOTE",JUMP_COMMENT:"JUMP_COMMENT",LEFT_ARROW:37,RIGHT_ARROW:39,KEY_END:35,KEY_HOME:36,_track:function(e){},_bindHomeEnd:function(){t(document).keydown(function(n){if(i.isCurrentlyFocusedInTypeable())return!0;if(n.keyCode==e.KEY_HOME||n.keyCode==e.KEY_END){n.preventDefault();var s=o.PostController;return t("html,body").animate({scrollTop:n.keyCode==e.KEY_END?t(document).height():0},100,"swing",function(){o.ListController.handlers.recalculateInViewEntries(),t(s.selectors.ENTRY_CONTAINER+" "+s.selectors.ENTRY_STICKY_ELEMENTS).each(function(){t(this).css({position:"","z-index":"",top:""}),t(this).removeClass(s.CLASS_STICKY)}),o.PostController.handlers.entryStickElementHandler(),c.default.handlers.scanFeaturedItemForArchive()}),!1}})},_bindJumpPrev:function(n){e.bindAction(n,function(){e._track("prev"),u.default.isPostPage()?o.PostController.prevEntry():e.jump(e.JUMP_PREV)}),u.default.isPostPage()&&t(document).keydown(function(t){return!!i.isCurrentlyFocusedInTypeable()||(t.keyCode==e.LEFT_ARROW?(o.PostController.prevEntry(),!1):void 0)})},_bindJumpNext:function(n){e.bindAction(n,function(){e._track("next"),u.default.isPostPage()?o.PostController.nextEntry():e.jump(e.JUMP_NEXT)}),u.default.isPostPage()&&t(document).keydown(function(t){return!!i.isCurrentlyFocusedInTypeable()||(t.keyCode==e.RIGHT_ARROW?(o.PostController.nextEntry(),!1):void 0)})},_bindPostVoteUp:function(n){e.bindAction(n,function(){e._track("upvote");var n=o.PostController,i=u.default.isPostPage()?t(n.selectors.ENTRY_CONTAINER):o.ListController.findCurrentlyInFocusEntry();n.upvoteEntry(i)},"keyup")},_bindPostVoteDown:function(n){e.bindAction(n,function(){e._track("downvote");var n=o.PostController,i=u.default.isPostPage()?t(n.selectors.ENTRY_CONTAINER):o.ListController.findCurrentlyInFocusEntry();n.downvoteEntry(i)},"keyup")},_bindPostComment:function(t){e.bindAction(t,function(){e._track("comment"),o.PostController.commentEntry(o.ListController.findCurrentlyInFocusEntry())})},_bindScrollToTop:function(t){e.bindAction(t,function(){e._track("back-to-top"),e.scrollToTop()})},_bindRandomEntry:function(t){e.bindAction(t,function(){e._track("random"),e.randomEntry()})},_bindPostPlay:function(n){e.bindAction(n,function(){e._track("play");var n=u.default.isPostPage()?t(o.PostController.selectors.ENTRY_CONTAINER):o.ListController.findCurrentlyInFocusEntry();o.PostController.playEntry(n)})},_bindElements:function(){e._bindScrollToTop("b"),e._bindJumpPrev("k"),e._bindJumpNext("j"),e._bindRandomEntry("r"),e._bindPostVoteUp("l"),e._bindPostVoteDown("h"),e._bindPostComment("c"),e._bindPostPlay("p"),e._bindHomeEnd()},_getKeyOptions:function(e){return{type:e||"keypress",propagate:!1,target:document,disable_in_input:!0,require_command_mode:!1}},bindAction:function(t,n,i){f.default.add(t,n,e._getKeyOptions(i))},jump:function(t){t==e.JUMP_PREV?o.ListController.scrollToPrevEntry():o.ListController.scrollToNextEntry()},scrollToTop:function(){o.PageController.scrollToTop()},randomEntry:function(){u.default.load("http://"+u.default.getDomain()+"/random")}};return{init:function(){e._bindElements()},jump:e.jump,bindAction:e.bindAction,scrollToTop:e.scrollToTop,randomEntry:e.randomEntry}}());e.exports=_}).call(t,n(0),n(12),n(4))},function(e,t,n){"use strict";(function(t,i,o,s,r,a){function l(e){return e&&e.__esModule?e:{default:e}}var c=n(1),d=l(c),u=n(44),h=l(u),f=n(5),_=l(f),g=t.extend({},new d.default,{_isLoading:!1,_listViewElement:null,_bottomReached:!1,_loadCountMax:20,_loadItemCount:0,_loadedCount:1,_lastScrollEntryPoint:0,_lastScrollFeaturedPoint:0,_disableAutoHiding:!1,selectors:{LOAD_MORE_BUTTON:".badge-load-more-post",ENTRY_LIST_CONTAINER:".badge-entry-collection",ENTRY_CONTAINER:".badge-entry-container",ENTRY_LIST_VIEW:".badge-list-view-element",ADS_CONTAINER_FEATURED:"#jsid-featured-item-container section"},init:function(){this._listViewElement=t(this.selectors.ENTRY_LIST_VIEW),navigator.userAgent.match(/(iPhone|iPod|iPad)/i)?this._disableAutoHiding=!0:_.default.isPostPage()&&(this._disableAutoHiding=!0),this.bindElements()},bindElements:function(){this.bindScrollEvents(),this.bindLastEntryInFocus()},handlers:{windowScrollHandler:function(){t.proxy(this.handlers.loadMoreScrollHandler,this)(),this._disableAutoHiding||t.proxy(this.handlers.autoHidingScrollHandler,this)()},loadMoreScrollHandler:function(){var e=t(window).height();t(window).scrollTop()+e>=t(document).height()-3*e&&this.loadMorePosts()},loadMoreLastEntryFocusHandler:function(e){var n=t(e.target);t(this.selectors.ENTRY_CONTAINER).last().is(n)&&this.loadMorePosts()},archiveContainer:function(e,t){""!=e.html()&&(i.PostController.postCallback("postWillArchive",e),e.css("min-height",t+"px"),e.data("stored-html",e.html()),e.empty(),e.addClass("archived"),i.PostController.postCallback("postDidArchive",e))},extractContainer:function(e){null!=e.data("stored-html")&&(i.PostController.postCallback("postWillRestore",e),e.html(e.data("stored-html")),e.data("stored-html",null),e.removeClass("archived"),i.PostController.postCallback("postDidRestore",e))},scanEntriesForArchive:function(){var e=g,n=i.CacheController,o=n.getEntryHandler(),s=i.ListController,r=o.getEntryList(),a=t(window).height(),l=3*a,c=4*a,d=i.PageController.getWindowEffectiveScrollTop();r&&0!=r.length&&!n.isUpdateNeeded(n.keys.ENTRY_LIST)||(n.parseEntryInfo(),r=o.getEntryList(),n.notifyForCacheUpdateCompleted(n.keys.ENTRY_LIST)),t(s.selectors.ENTRY_CONTAINER+":not(.archived)").each(function(){var n=t(this),i=n.data("entry-id"),s=o.getEntryInfoForKey(i,"height"),r=o.getEntryInfoForKey(i,"offset"),a=r.top;(r.top+s<d-l-s||a>d+c+s)&&e.handlers.archiveContainer(n,s)});for(var u=0;u<r.length;u++){var h=r[u],f=o.getEntryInfoForKey(h,"height"),_=o.getEntryInfoForKey(h,"offset"),p=_.top;if(_.top+f>=d-l-f&&p<=d+c+f){var E=t(s.selectors.ENTRY_CONTAINER_ID_PREFIX+h);e.handlers.extractContainer(E)}}},scanFeaturedItemForArchive:function(){var e=g,n=i.CacheController,o=n.getFeaturedItemHandler(),s=h.default;if(!s.isStickySidebarAdsEnabled()){var r=t(window).height(),a=2*r,l=3*r,c=i.PageController.getWindowEffectiveScrollTop(),d=o.getFeaturedList();if(!d||0==d.length||n.isUpdateNeeded(n.keys.FEATURED_LIST)){var u=[];t(s.selectors.SIDEBAR_ITEMS).each(function(){var e=t(this).data("item-id"),i=n.handlers.getFeaturedItemInfoFromDOM(t(this));o.setFeaturedItemInfo(e,i),u.push(e)}),o.setFeaturedList(u),d=u,n.notifyForCacheUpdateCompleted(n.keys.FEATURED_LIST)}t(s.selectors.SIDEBAR_ITEMS+":not(.archived)").each(function(){var i=t(this),s=i.data("item-id"),r=o.getFeaturedItemInfo(s);r||(r=n.handlers.getFeaturedItemInfoFromDOM(i),o.setFeaturedItemInfo(s,r));var d=r.top;(d+r.height<c-a-r.height||d>c+l+r.height)&&e.handlers.archiveContainer(i,r.height)});for(var f=0;f<d.length;f++){var _=d[f],p=o.getFeaturedItemInfo(_);p||(p=n.handlers.getFeaturedItemInfoFromDOM(T),o.setFeaturedItemInfo(_,p));var E=p.top;if(E+p.height>=c-a-p.height&&E<=c+l+p.height){var T=t(s.selectors.SIDEBAR_ITEM_PREFIX+_);e.handlers.extractContainer(T)}}}},autoHidingScrollHandler:function(){var e=this,t=i.PageController.getWindowEffectiveScrollTop(),n=Math.abs(t-this._lastScrollEntryPoint),o=Math.abs(t-this._lastScrollFeaturedPoint);n>1e3&&(e._lastScrollEntryPoint=t,e.handlers.scanEntriesForArchive()),o>1e3&&(e._lastScrollFeaturedPoint=t,e.handlers.scanFeaturedItemForArchive())},loadMoreAjaxHandler:function(e){if(e.okay){for(var n=t("#jsid-gat-interval").data("post-interval")+"",a=n.split(","),l=[],c="",d=0;d<e.ids.length;d++){var u=e.ids[d];0==t("#jsid-entry-entity-"+u).length&&(a.indexOf(d+"")>-1&&(c+='<div class="banner-block stream-naughty">                                    <div class="naughty-background">                                        <div class="badge-gag-ads-container naughty-container" data-gag-ads="list-instream-300x250"></div>                                    </div>                                </div>'),c+=e.items[u],l.push("#jsid-entry-entity-"+u),this._loadItemCount++)}var h=this.findLastEntryElement();t(h).append(c),i.TimedViewTrackingController.trackElements(t(l.join(","))),i.PageController.injectEntryImageOnError(),i.PageController.loadAnimatedGif();var f=i.CacheController;f.notifyForCacheUpdate(f.keys.ENTRY_LIST),o.getController("vote").process(),o.getController("vote").remoteHandler.processQueue(),s.track("PostList","LoadList",_.default.getPageKey(),"",{LoadedCount:this._loadedCount}),this._loadedCount++,t(this.selectors.LOAD_MORE_BUTTON).data("load-count-max")&&(this._loadCountMax=t(this.selectors.LOAD_MORE_BUTTON).data("load-count-max")),this._loadedCount==this._loadCountMax&&s.track("PostList","LoadListEnd",_.default.getPageKey());var g=t(this.selectors.LOAD_MORE_BUTTON);this._loadedCount<this._loadCountMax?""!=e.loadMoreUrl?(g.prop("href",e.loadMoreUrl),g.text(g.data("original-text")),g.data("original-text",""),g.removeClass("spin")):(g.removeAttr("href"),g.text("No more posts"),g.removeClass("spin").addClass("end"),this._bottomReached=!0):(g.text("I want more fun"),g.prop("href",e.loadMoreUrl),g.removeClass("spin").addClass("blue"),this._bottomReached=!0),r.firePageviewCandidate(),this._isLoading=!1}}},loadMorePosts:function(){if(!this._isLoading&&!this._bottomReached){var e=t(this.selectors.LOAD_MORE_BUTTON);e.data("original-text",e.text()),e.html(a.getSpinnerHtml()),e.addClass("spin");var n=e.prop("href");this._isLoading=!0,void 0!==n&&""!=n&&t.getJSON(n,null,t.proxy(this.handlers.loadMoreAjaxHandler,this))}},findLastEntryElement:function(){return this._listViewElement.find(this.selectors.ENTRY_LIST_CONTAINER).last()},bindScrollEvents:function(){t(window).scroll(t.proxy(this.handlers.windowScrollHandler,this))},bindLastEntryInFocus:function(){t("body").on(i.ListController.customEvents.IN_FOCUS_SET,this.selectors.ENTRY_CONTAINER,null,t.proxy(this.handlers.loadMoreLastEntryFocusHandler,this))}});e.exports=g}).call(t,n(0),n(4),n(43),n(8),n(95),n(12))},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(1),a=s(r),l=n(13),c=s(l),d=n(35),u=s(d),h=t.extend({},new a.default,function(){var e={PROFILE_MORE_MENU:"#jsid-profile-more-menu",PROFILE_MORE_MENU_ITEMS:"#jsid-profile-more-menu-items",USER_REPORT_BUTTON:".badge-user-report-button"},n={_bindElements:function(){this._bindMoreMenu(),this._bindMoreMenuItems()},_bindMoreMenu:function(){t(e.PROFILE_MORE_MENU).on("click",t.proxy(function(n){n.stopPropagation();var i=(t(n.currentTarget),t(e.PROFILE_MORE_MENU_ITEMS).hasClass("hide"));this._showProfileMoreMenuItems(i)},this))},_bindMoreMenuItems:function(){t(e.PROFILE_MORE_MENU_ITEMS).on("click",e.USER_REPORT_BUTTON,t.proxy(function(e){e.preventDefault();var n=t(e.target);if(!c.default.isLoggedIn())return e.preventDefault(),void u.default.presentSignupForm();var s=n.data("username");i.log("Report username="+s),o.ReportController.showReportOverlay({type:o.ReportController.types.USER,objectId:s})},this))},_showProfileMoreMenuItems:function(n){n?t(e.PROFILE_MORE_MENU_ITEMS).removeClass("hide"):t(e.PROFILE_MORE_MENU_ITEMS).addClass("hide")},_showProfileMoreButton:function(n){n?t(e.PROFILE_MORE_MENU).removeClass("hide"):t(e.PROFILE_MORE_MENU).addClass("hide")},_updateProfileMoreButton:function(o){var s=t(e.PROFILE_MORE_MENU).data("username"),r=o&&(""+o.username).toLowerCase()==(""+s).toLowerCase();i.log(o),i.log("profile.username",s+", isSelf="+r),n._showProfileMoreButton(!r)}};return{init:function(){n._bindElements()},updateProfileMoreButton:n._updateProfileMoreButton,showProfileMoreMenuItems:n._showProfileMoreMenuItems}}());e.exports=h}).call(t,n(0),n(2),n(4))},function(e,t,n){"use strict";(function(t,i,o){var s=n(27),r=function(e){return e&&e.__esModule?e:{default:e}}(s),a=t.extend({},new r.default,{storageImpl:{},sessionStorageImpl:{},init:function(){this.storageImpl=i.getStore();var e=!1;try{window.sessionStorage&&(sessionStorage.setItem("9gagTestStorage",""),sessionStorage.removeItem("9gagTestStorage"),this.sessionStorageImpl=sessionStorage,e=!0)}catch(e){o.log("Session Storage is not available, use non-persistent storage instead")}e||(this.sessionStorageImpl=this.nonPersistentLS)}});e.exports=a}).call(t,n(0),n(57),n(2))},function(e,t,n){"use strict";(function(t){var i=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},o.default,{cacheKey:"cacheableUserUpload",cacheTTL:1800,formatRemoteParams:function(e){return{action:"user-upload",params:{}}},get:function(){return this.getFromCache()},addToCache:function(e){return!1},removeFromCache:function(e){return!1}});e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t){var i=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},o.default,{cacheKey:"cacheableVote",cacheTTL:1800,formatRemoteParams:function(e){return{action:"vote",params:{}}},get:function(){var e=this.getFromCache();return e},addToCache:function(e){var n=this.getFromCache();return null===n&&(n={}),t.each(e,function(e,t){n[e]=t}),this.updateCache(n)},removeFromCache:function(e){return!1}});e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t,i,o,s){function r(e){return e&&e.__esModule?e:{default:e}}var a=n(11),l=r(a),c=n(13),d=r(c),u=n(5),h=r(u),f={_xfbmlRenderItems:[],_fbInitedCallbacks:[],_asyncInited:!1,init:function(){},asyncInit:function(){this._asyncInited=!0,this.initApp(),this.executeRenderQueue(),this.subscribeLike()},initApp:function(){FB.init({appId:t.Facebook.getAppId(),version:"v2.2",xfbml:!1,status:!0,cookie:!0}),this._checkFacebookLoginStatus()},addInitCallback:function(e,t){f._fbInitedCallbacks.push({callbackType:e,callback:t})},_executeFbInitedCallbacks:function(e){for(var t=0;t<this._fbInitedCallbacks.length;t++){var n=this._fbInitedCallbacks[t];-1===e.indexOf(n.callbackType)||"function"!=typeof n.callback||this._fbInitedCallbacks[t].executed||(this._fbInitedCallbacks[t].executed=!0,n.callback())}},sessionChangeHandler:function(e){e&&("connected"===e.status?e.authResponse&&(f.autoLogin(),f._executeFbInitedCallbacks("connected,logged-in,all")):"not_authorized"===e.status?f._executeFbInitedCallbacks("logged-in,all"):f._executeFbInitedCallbacks("logged-out,all"))},_checkFacebookLoginStatus:function(){FB.getLoginStatus(f.sessionChangeHandler),FB.Event.subscribe("auth.authResponseChange",f.sessionChangeHandler)},executeRenderQueue:function(){for(var e=0;e<this._xfbmlRenderItems.length;e++){var t=this._xfbmlRenderItems[e];this.parseElement(t.elementId,t.callback)}},renderElement:function(e,t){this._asyncInited?this.parseElement(e,t):this._xfbmlRenderItems.push({elementId:e,callback:t})},parseElement:function(e,t){var n=document.getElementById(e);if(n)try{t?FB.XFBML.parse(n,t):FB.XFBML.parse(n)}catch(e){}},login:function(e){FB.login(function(t){return t.authResponse&&("function"==typeof e?e.call(t):alert("it is not a callback")),t.authResponse})},autoConnectKey:"auto_log",autoConnectDuration:{path:"/",duration:7300},autoLogin:function(){if(!d.default.isLoggedIn()&&i.isCookieEnabled()){var e=o.cookie(f.autoConnectKey),t={a:!1,d:!1,lo:!1,dl:!1};if((e||!1===e)&&(t=JSON.parse(e)),null!=t){if(t.a)return;if(!t.dl&&(t.lo||t.d))return}s.track("Login","AutoConnectFacebook",h.default.getPageKey()),t.a=!0;var n=(0,l.default)(t);o.cookie(f.autoConnectKey,n,f.autoConnectDuration);f.Connect.autoLogin(location.href)}},renderLike:function(e,t,n){var i=this.Plugins.Like.getElement(n);o("#"+e).html("").append(i);this.renderElement(e,t)},subscribeLike:function(){FB.Event.subscribe("edge.create",function(e){s.track("Social","LikeFacebook",h.default.getPageKey(),"",{Url:e})})},Plugins:{Like:{getElement:function(e){var t={class:"fb-like","data-href":"","data-layout":"button_count","data-show-faces":"false","data-font":"arial","data-width":300};e=o.extend(t,e);var n=o("<div/>");for(var i in e)n.attr(i,e[i]);return n}}},Connect:{FB_CONNECT_CALLBACK_URL:"/connect/facebook-callback",_additionalParams:{},addParam:function(e,t){this._additionalParams[e]=t},_getConnectParamsString:function(){var e="",t=0;for(k in this._additionalParams)e+=(0==t?"":"&")+k+"="+encodeURIComponent(this._additionalParams[k]),t++;return e},_getConnectUrl:function(e){var t=f.Connect.FB_CONNECT_CALLBACK_URL;return t+="?"+this._getConnectParamsString()},autoLogin:function(e){try{void 0!=e&&null!=e||(e="/");var t="https://"+h.default.getDomain()+"/connect/auto-login";t+="?"+("next="+encodeURIComponent(e+"&"+this._getConnectParamsString())),window.location=t}catch(e){return}},connect:function(e){try{void 0!=e&&null!=e||(e="/");var t="https://"+h.default.getDomain()+"/connect/facebook";t+="?"+("next="+encodeURIComponent(e+"&"+this._getConnectParamsString())),window.location=t}catch(e){return}}}};window.fbAsyncInit=function(){f.asyncInit()},e.exports=f}).call(t,n(3),n(12),n(0),n(8))},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}var o=n(6),s=i(o),r=n(7),a=i(r),l=function(){function e(){(0,s.default)(this,e)}return(0,a.default)(e,null,[{key:"getLocales",value:function(){var e=[];navigator.language&&e.push(navigator.language),navigator.userLanguage&&e.push(navigator.userLanguage),navigator.languages&&(e=e.concat(navigator.languages));for(var n=0;n<e.length;n++){var i=e[n],o=i.indexOf("-");if(o>-1){var s=i.substring(0,o);-1==e.indexOf(s)&&e.push(s)}}return t.arrayUnique(e)}},{key:"isMatchAnyLocales",value:function(t){if(""==t)return!0;"string"==typeof t&&(t=t.split(","));for(var n=e.getLocales(),i=0;i<t.length;i++)for(var o=t[i],s=0;s<n.length;s++){var r=n[s];if(o.toLowerCase()==r.toLowerCase().replace("-","_"))return!0}return!1}}]),e}();e.exports=l}).call(t,n(151))},function(e,t,n){"use strict";(function(t,i,o){var s=n(11),r=function(e){return e&&e.__esModule?e:{default:e}}(s),a={uniqueStoreKey:"_tuv",uniqueStoreMax:100,trackUrl:"http://t.9gag.com/img.gif",rlogTrackUrl:"//web-t.9gag.com/img.gif",rlogUrl:"//web-t.9gag.com/m.gif",appId:"web.9gag.desktop.release",appVersion:"0",_entryIDsBuffer:{},_store:null,init:function(e){this.uniqueStoreKey=e.uniqueStoreKey||this.uniqueStoreKey,this.uniqueStoreMax=e.uniqueStoreMax||this.uniqueStoreMax,this.trackUrl=e.trackUrl||this.trackUrl,this.rlogTrackUrl=e.rlogTrackUrl||this.rlogTrackUrl,this.rlogUrl=e.rlogUrl||this.rlogUrl,this.appId=e.appId||this.appId,this.appVersion=e.appVersion||this.appVersion},_checkUnique:function(e){var t=this._getStore().getItem(this.uniqueStoreKey);void 0!=t&&null!=t||(t="[]");var n=JSON.parse(t);return-1==n.indexOf(e)&&(n.length>=this.uniqueStoreMax&&n.shift(),n.push(e),this._getStore().setItem(this.uniqueStoreKey,(0,r.default)(n)),!0)},_getStore:function(){return this._store?this._store:(this._store=t.getStore(),this._store)},uniqueViewed:function(e){if(void 0!==e.entry){var t=e.entry||"";t+="";for(var n=t.split(","),i=[],o=0;o<n.length;o++)a._checkUnique(n[o])&&i.push(n[o]);n.length>0&&i.length>0&&(e.entry=i.join(","),a.event("unique-viewed","v",e))}},event:function(e,t,n){var i={action:e,value:t,ref:"",label:void 0===n.label?"":n.label,labelValue:void 0===n.labelValue?"":n.labelValue,platform:void 0===n.platform?"":n.platform,entry:void 0===n.entry?"":n.entry,user:void 0===n.user?"":n.user,view:void 0===n.view?"":n.view};i.ref=a._getQueryStringParam("ref"),(new Image).src=a._formatUrl(i),(new Image).src=a._formatUrl(i,a.rlogTrackUrl)},_getQueryStringParam:function(e){for(var t=window.location.href,n=t.split(/[\?&]+/),i=0;i<n.length;i++){var o=n[i].split("=");if(o[0]==e)return o[1]}return""},_formatUrl:function(e,t){var n=t||a.trackUrl,i="",o=[];e&&(void 0!=e.action&&null!=e.action&&o.push("a="+encodeURIComponent(e.action)),void 0!=e.value&&null!=e.value&&o.push("v="+encodeURIComponent(e.value)),void 0!=e.ref&&null!=e.ref&&o.push("ref="+encodeURIComponent(e.ref)),void 0!=e.label&&null!=e.label&&o.push("lbl="+encodeURIComponent(e.label)),void 0!=e.labelValue&&null!=e.labelValue&&o.push("lblv="+encodeURIComponent(e.labelValue)),void 0!=e.platform&&null!=e.platform&&o.push("p="+encodeURIComponent(e.platform)),void 0!=e.entry&&null!=e.entry&&o.push("e="+encodeURIComponent(e.entry)),void 0!=e.user&&null!=e.user&&o.push("u="+encodeURIComponent(e.user)),void 0!=e.view&&null!=e.view&&o.push("w="+encodeURIComponent(e.view))),o.push("url="+encodeURIComponent(a._getUrl())),o.push("referrer="+encodeURIComponent(a._getReferrer())),o.push("t="+encodeURIComponent(a._getTime()));for(var s=0;s<o.length;s++)i+=o[s]+"&";return n+="?"+i},_getUrl:function(){return location.href},_getReferrer:function(){return document.referrer},_getTime:function(){var e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds());return Math.round(t.getTime()/1e3)},logTime:function(e,t){var n=i.cookie("____lo")||"O1",o={a:a.appId,v:parseInt(a.appVersion),t:Math.round(t),k:e+"."+n,g:"USER_EXPERIENCE"},s=a.rlogUrl+"?"+i.param(o);(new Image).src=s},logLatencyIfSane:function(e,t,n){var i=n-t;t>0&&n>0&&i>0&&i<6e5&&(o.log("LatencyTracking: "+e+":"+i.toFixed(2)),a.logTime(e,i))},logCount:function(e,t){var n=i.cookie("____lo")||"O1",o={a:a.appId,v:parseInt(a.appVersion),c:t,k:e+"."+n,g:"USER_EXPERIENCE",_uniq:Math.random()+i.now()},s=a.rlogUrl+"?"+i.param(o);(new Image).src=s},profileUrlLoadTime:function(e,t){if(a._shouldTrackPerformance()){var n=function(){a.trackUrlTiming(e,t)},i=new Image;i.onload=n,i.src=e}},trackUrlTiming:function(e,t){var n=performance.getEntriesByName(e);if(n&&n[0]){var i=n[0].requestStart,o=n[0].responseEnd;a.logLatencyIfSane("DELAY_TXFR_"+t,i,o);var s=n[0].connectStart,r=n[0].connectEnd;a.logLatencyIfSane("DELAY_CONN_"+t,s,r)}},reportPerf:function(){setTimeout(function(){a.profilePageLoadTime()},1),setTimeout(function(){a.profileAssetsLoadTime()},1)},_shouldTrackPerformance:function(){return performance&&performance.navigation&&performance.timing&&0==performance.navigation.type},profilePageLoadTime:function(){if(a._shouldTrackPerformance()&&"/"==window.location.pathname){var e=performance.timing.domComplete,t=performance.timing.navigationStart;a.logLatencyIfSane("PAGE_DELAY",t,e)}},profileAssetsLoadTime:function(){if(a._shouldTrackPerformance()){var e=window.performance.getEntriesByType("resource").find(function(e){return e&&e.name&&e.name.endsWith("gag.css")});e&&e.name&&e.transferSize>0&&(o.log("Main CSS resource is :",e),setTimeout(function(){a.trackUrlTiming(e.name,"MAINCSS")},1))}},downloadFail:function(e){setTimeout(function(){a.logCount("DOWNLOAD_FAIL",1)},1)},injectEntryImageOnError:function(){var e=i(GAG.PostController.selectors.CONTAINER),t=e.find(".post-container img");i(t).one("error",function(){var e=i(this).attr("src");a.downloadFail(e)})}};e.exports=a}).call(t,n(57),n(0),n(2))},function(e,t,n){"use strict";(function(t,i){var o=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r=t.extend({},new s.default,{_isLoading:!1,_bottomReached:!1,_loadCount:0,selectors:{NOTIFICATION_LIST:".badge-notification-list",END_OF_LIST:".badge-notification-eol",NEXT_KEY:".badge-notification-nextKey",LOADER:".badge-notification-loader"},init:function(){0!=t(this.selectors.NOTIFICATION_LIST).length&&this.bindElements()},bindElements:function(){this.bindScrollEvents()},bindScrollEvents:function(){t(window).scroll(t.proxy(this.handlers.windowScrollHandler,this))},loadMorePosts:function(){if(!this._isLoading&&!this._bottomReached){i.track("Noti","LoadList","","",{LoadedCount:++this._loadCount});var e=this,n=t(e.selectors.NOTIFICATION_LIST).find(e.selectors.NEXT_KEY).last().text();t(e.selectors.NOTIFICATION_LIST).find(e.selectors.LOADER).removeClass("hide"),this._isLoading=!0,t.ajax({url:"/notifications/load-more",data:{refKey:n},dataType:"html",success:function(n){if(e._isLoading=!1,n){t(e.selectors.NOTIFICATION_LIST).find("ul").find(e.selectors.LOADER).before(n);t(e.selectors.NOTIFICATION_LIST).find(e.selectors.END_OF_LIST).length>0&&(e._bottomReached=!0,i.track("Noti","LoadListEnd"))}else e._bottomReached=!0,i.track("Noti","LoadListEmpty")},error:function(t){e._isLoading=!1,e._bottomReached=!0,i.track("Noti","LoadListError")},complete:function(n){t(e.selectors.NOTIFICATION_LIST).find(e.selectors.LOADER).addClass("hide")}})}},handlers:{windowScrollHandler:function(){t.proxy(r.handlers.loadMoreScrollHandler,this)()},loadMoreScrollHandler:function(){var e=t(window).height();t(window).scrollTop()+e>=t(r.selectors.NOTIFICATION_LIST).height()&&r.loadMorePosts()}}});e.exports=r}).call(t,n(0),n(8))},function(e,t,n){"use strict";(function(t,i,o,s){function r(e){return e&&e.__esModule?e:{default:e}}var a=n(1),l=r(a),c=n(94),d=r(c),u=n(96),h=r(u),f=t.extend({},new l.default,{DELAY:1e3,INIT_DELAY:2e3,_lastBadgetTs:!1,_minBadgeInterval:5e3,_regularLongPollingInterval:18e4,_checkUpdateQueueInterval:1e3,_isRequestingUpdate:!1,unreadCount:0,init:function(){},onWindowLoad:function(){i.get("user.id")&&setTimeout(t.proxy(function(){this._initPush(),this._initBadgeUpdate()},this),this.INIT_DELAY)},selectors:{NOTIFICATION_UNREAD_COUNT:"#jsid-notification-unread-count"},_pullNotificatons:function(e){t(this.selectors.NOTIFICATION_UNREAD_COUNT)&&this.putToUpdateQueue(e)},_initPush:function(){function e(e,t,n){var i={type:"noti",message:e,id:t,channel:n};o.log(i),f._pullNotificatons(i)}var t=h.default.getPushStreamOptions();if(t.host&&t.port){var n=new PushStream(t);n.onmessage=e;var s=i.get("user.noti.channels");if(s instanceof Array)for(var r=0;r<s.length;r++)n.addChannel(s[r]),o.log(s[r]);n.connect()}},_updateQueue:[],putToUpdateQueue:function(e){this._updateQueue.push(e)},getNsReadStateCb:function(e,n){this._isRequestingUpdate=!1,this._lastBadgetTs=(new Date).getTime(),e&&"OK"==e.status?this.unreadCount!=e.payload.unreadCount&&(n&&(t(s.PageController.selectors.HEADER_NOTIFICATION_CONTAINER).empty(),s.PageController.getNotifications()),this.updateNotificationUnreadCount(e.payload.unreadCount)):this._isRequestingUpdate=!1},_getNsReadState:function(){var e=h.default.getReadStateUrl()+"?"+i.get("user.noti.read_state_params");this._isRequestingUpdate=!0;t.ajax({url:e,type:"GET",dataType:"jsonp",success:function(e){f.getNsReadStateCb(e,!0)}})},getNotificationBadge:function(){if(!this._isRequestingUpdate)return this._getNsReadState()},updateNotificationUnreadCount:function(e){var n=t(this.selectors.NOTIFICATION_UNREAD_COUNT);if(n){if(e>0){this.unreadCount=e,n.text(e),n.addClass("new");var i=e+" unread messages. \nClick to read detail.";1==e&&(i=e+" unread message. \nClick to read detail."),d.default.show(i)}else this.unreadCount=0,n.text(""),n.removeClass("new");s.PageController.refreshPageTitle()}},checkUpdateQueue:function(){this._updateQueue.length>0&&(this._updateQueue=[],this.getNotificationBadge())},processUpdateQueue:function(){var e=(new Date).getTime();(!this._lastBadgetTs||e-this._lastBadgetTs>=this._minBadgeInterval)&&this.checkUpdateQueue()},addRegularLongPolling:function(){this.putToUpdateQueue({})},scheduleRegularLongPolling:function(){this.addRegularLongPolling(),this._regularLongPollingInterval=1.5*this._regularLongPollingInterval,setTimeout(this.scheduleRegularLongPolling.bind(this),this._regularLongPollingInterval)},_initBadgeUpdate:function(){setInterval(this.processUpdateQueue.bind(this),this._checkUpdateQueueInterval),setTimeout(this.scheduleRegularLongPolling.bind(this),this._regularLongPollingInterval)}});e.exports=f}).call(t,n(0),n(3),n(2),n(4))},function(e,t,n){"use strict";(function(t,i,o,s,r){var a=n(1),l=function(e){return e&&e.__esModule?e:{default:e}}(a),c=t.extend({},new l.default,{COOKIE_SLEEP_KEY:"webnoti_sleep",init:function(){},requestPermission:function(e){Notification.requestPermission(function(t){Notification.permission!==t&&(Notification.permission=t),e&&"granted"===Notification.permission&&c.initNotification(e)})},show:function(e){return window.Notification?"granted"===Notification.permission?void this.initNotification(e):void("denied"!==Notification.permission&&this.requestPermission(e)):void i.log("No notification")},initNotification:function(e){if(t.cookie(this.COOKIE_SLEEP_KEY))return void i.log("WebNoti skipped");var n=new Notification(e,{tag:"nineGAGNotification",icon:o.get("page.assets_url")+"/logo-noti-black.png"});n.onclick=this.clickHandler,n.onclose=this.closeHandler,n.onerror=this.errorHandler},clickHandler:function(e){try{s.PageController.showMenu(s.PageController.selectors.HEADER_NOTIFICATION_ITEM),t(s.PageController.selectors.HEADER_NOTIFICATION_MENU).addClass("menu"),t(s.PageController.selectors.HEADER_NOTIFICATION_MENU+" a").addClass("selected"),t(s.PageController.selectors.HEADER_NOTIFICATION_ITEM).data("plugin_tinyscrollbar").update({invertscroll:!0}),s.PageController.markNotificationsAsRead(),s.PageController.hidePopupMenu(s.PageController.selectors.HEADER_NOTIFICATION_ITEM),window.focus(),t("html, body").animate({scrollTop:t(s.PageController.selectors.HEADER_NOTIFICATION_ITEM).offset().top},200),r.track("PushNoti","OpenNoti")}catch(e){i.log(e.message)}},closeHandler:function(e){var n=new Date;n.setTime(n.getTime()+1e3*o.get("page.webNotiSleepTtl")),t.cookie(c.COOKIE_SLEEP_KEY,1,{path:"/",expires:n}),r.track("PushNoti","CloseNoti")},errorHandler:function(e){}});e.exports=c}).call(t,n(0),n(2),n(3),n(4),n(8))},function(e,t,n){"use strict";(function(t,n){var i={firePageviewCandidate:function(){t.fireBeaconTag()&&n.ajax({url:t.getPageviewCandidateUrl(),dataType:"xml",type:"GET"})}};e.exports=i}).call(t,n(152),n(0))},function(e,t,n){"use strict";(function(t){var n={API_ENDPOINT:{READ_STATE:"/v1/read-state.json"},getReadStateUrl:function(){return"https://"+t.get("configs.noti.apiHost")+this.API_ENDPOINT.READ_STATE},getPushStreamOptions:function(){var e={host:t.get("configs.noti.pushHost"),port:t.get("configs.noti.pushPort"),modes:t.get("configs.noti.modes")};return"80"!==e.port&&(e.useSSL=!0),e}};e.exports=n}).call(t,n(3))},function(e,t,n){"use strict";(function(t,n){var i={btnClicked:!1,_asyncInited:!1,_renderQueue:[],init:function(){this._checkAsyncInit()},_checkAsyncInit:function(){"undefined"!=typeof gapi?this.asyncInit():setTimeout(t.proxy(this._checkAsyncInit,this),100)},asyncInit:function(){this._asyncInited=!0,this._executeQueue()},renderButton:function(e,t){var n=this._getRenderOptions();n.callback=t,this._asyncInited?gapi.signin.render(e,n):this._renderQueue.push({domId:e,options:n})},_executeQueue:function(){for(;this._renderQueue.length>0;){var e=this._renderQueue.shift();gapi.signin.render(e.domId,e.options)}},_getRenderOptions:function(){var e={clientid:n.get("configs.gplus.client_id"),cookiepolicy:"single_host_origin",accesstype:"offline",scope:"https://www.googleapis.com/auth/plus.login https://www.googleapis.com/auth/plus.me https://www.googleapis.com/auth/userinfo.email"},t=n.get("configs.gplus.app_package_name");return t&&(e.apppackagename=t),e}};e.exports=i}).call(t,n(0),n(3))},function(e,t,n){"use strict";(function(t){var i=n(188),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(){this._namespace=""};s.prototype.setNamespace=function(e){this._namespace=e},s.prototype.log=function(e,n){t.log(this._namespace+" "+(n?n+" ":"")+e)},s.prototype.failed=function(e){return(new o.default).failed(e)},s.prototype.succeeded=function(e){return(new o.default).succeeded(e)},e.exports=s}).call(t,n(2))},function(e,t,n){"use strict";(function(t,i){var o=n(38),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r=function(){var e={_toastMsgCookieKey:"toastMsg",init:function(){},getToast:function(){if(!navigator.cookieEnabled)return{};var n=t.cookie(e._toastMsgCookieKey);if(t.cookie(e._toastMsgCookieKey,0,{expires:-1,domain:i.get("page.cookie_domain"),path:"/"}),!n)return{};if(n=n.split(","),0==n.length)return{};n=n[0];var o=e.mapToastCode(n);return void 0!==o?o:{}},mapToastCode:function(t){var n=e.COLOR,i=e.TEXT,o=e.MAPPING,r={SAFE_MODE_DISABLED:{color:n.COLOR_RED,text:i.SAFE_MODE_DISABLED},POST_REMOVED:{color:n.COLOR_YELLOW,text:i.POST_REMOVED},WELCOME_BACK:{color:n.COLOR_YELLOW,text:i.WELCOME_BACK},WELCOME_TO_9GAG:{color:n.COLOR_YELLOW,text:i.WELCOME_TO_9GAG},POST_DELETED:{color:n.COLOR_YELLOW,text:i.POST_DELETED},POST_DISASSOCIATED:{color:n.COLOR_YELLOW,text:i.POST_DISASSOCIATED},PROFILE_SETTING_SAVED:{color:n.COLOR_GREEN,text:i.PROFILE_SETTING_SAVED},PROFILE_SETTING_ERROR:{color:n.COLOR_RED,text:i.PROFILE_SETTING_ERROR},PROFILE_LANGUAGE_CHANGED:{color:n.COLOR_YELLOW,text:i.PROFILE_LANGUAGE_CHANGED},LOGIN_FAILED:{color:n.COLOR_RED,text:i.LOGIN_FAILED},PRIVACY_SETTING_NOTICE:{color:n.COLOR_YELLOW,text:i.PRIVACY_SETTING_NOTICE},ACCOUNT_DELETED:{color:n.COLOR_YELLOW,text:i.ACCOUNT_DELETED},ACCOUNT_CONFIRM_SENT:{color:n.COLOR_YELLOW,text:i.ACCOUNT_CONFIRM_SENT},ACCOUNT_CONFIRM_ERROR:{color:n.COLOR_RED,text:i.ACCOUNT_CONFIRM_ERROR},ACCOUNT_VERFIY_ERROR:{color:n.COLOR_YELLOW,text:i.ACCOUNT_VERIFY_ERROR},SITE_READ_ONLY_MODE:{color:n.COLOR_YELLOW,text:i.SITE_READ_ONLY_MODE}};if("undefined"!==!(0,s.default)(o[t]))return r[o[t]]},COLOR:{COLOR_RED:"red",COLOR_YELLOW:"yellow",COLOR_GREEN:"green",COLOR_BLUE:"blue"},TEXT:{SAFE_MODE_DISABLED:"NSFW Posts are shown",POST_REMOVED:"Ooooops! The post you're looking for has been reported by the community and removed.",WELCOME_BACK:"Awww Yeah! Welcome back.",WELCOME_TO_9GAG:"Me Gusta! Welcome to 9GAG, go have fun now!",POST_DELETED:"The post is removed.",POST_DISASSOCIATED:"The post is removed from your profile.",PROFILE_SETTING_SAVED:"Your settings have been saved.",PROFILE_SETTING_ERROR:"Ooooops! There is an error.",PROFILE_LANGUAGE_CHANGED:"Language have been changed.",LOGIN_FAILED:"Ooooops! There is an error logging in.",PRIVACY_SETTING_NOTICE:"You can now control your profile privacy in settings.",ACCOUNT_DELETED:"Your account has been deleted.",ACCOUNT_CONFIRM_SENT:"A confirmation message has been sent.",ACCOUNT_CONFIRM_ERROR:"There was a problem sending the confirmation message.",ACCOUNT_VERIFY_ERROR:"There was a problem verifying your email.",SITE_READ_ONLY_MODE:"9GAG is undergoing maintenance right now. Sign-up and Upload will be back shortly."},MAPPING:{1:"SAFE_MODE_DISABLED",2:"WELCOME_BACK",3:"POST_REMOVED",4:"WELCOME_TO_9GAG",5:"POST_DELETED",6:"POST_DISASSOCIATED",7:"PROFILE_SETTING_SAVED",8:"PROFILE_SETTING_ERROR",9:"PROFILE_LANGUAGE_CHANGED",12:"LOGIN_FAILED",13:"PRIVACY_SETTING_NOTICE",14:"ACCOUNT_DELETED",15:"ACCOUNT_CONFIRM_SENT",16:"ACCOUNT_CONFIRM_ERROR",18:"ACCOUNT_VERFIY_ERROR",17:"SITE_READ_ONLY_MODE"}};return{init:e.init,getToast:e.getToast}}();e.exports=r}).call(t,n(0),n(3))},function(e,t,n){"use strict";(function(t,i){var o=n(27),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r=t.extend({},new s.default,{API:{URL_LIKE:"/vote/like",URL_DISLIKE:"/vote/dislike",URL_UNLIKE:"/vote/unlike"},_requests:{},_isRequesting:!1,init:function(){},_submitRequest:function(e,n,o,s){if(void 0!==n){this._isRequesting;var r={id:n};t.ajax({type:"POST",url:e,data:r,beforeSend:function(){this._isRequesting=!0,"function"==typeof o&&o(n)},complete:function(){this._isRequesting=!1},success:function(e){var t=i.parseJsonString(e);t.id&&t.msg?"function"==typeof o&&o(n):"function"==typeof s&&s(n)},error:function(e){"function"==typeof s&&s(n)}})}},like:function(e,t,n){this._submitRequest(this.API.URL_LIKE,e,t,n)},unlike:function(e,t,n){this._submitRequest(this.API.URL_UNLIKE,e,t,n)},dislike:function(e,t,n){this._submitRequest(this.API.URL_DISLIKE,e,t,n)}});e.exports=r}).call(t,n(0),n(12))},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(38),o=function(e){return e&&e.__esModule?e:{default:e}}(i);/*! modernizr 3.2.0 (Custom Build) | MIT *
 * http://modernizr.com/download/?-video !*/
!function(e,t,n){function i(e,t){return(void 0===e?"undefined":(0,o.default)(e))===t}function s(){return"function"!=typeof t.createElement?t.createElement(arguments[0]):u?t.createElementNS.call(t,"http://www.w3.org/2000/svg",arguments[0]):t.createElement.apply(t,arguments)}var r=[],a={_version:"3.2.0",_config:{classPrefix:"",enableClasses:!0,enableJSClass:!0,usePrefixes:!0},_q:[],on:function(e,t){var n=this;setTimeout(function(){t(n[e])},0)},addTest:function(e,t,n){r.push({name:e,fn:t,options:n})},addAsyncTest:function(e){r.push({name:null,fn:e})}},l=function(){};l.prototype=a,l=new l;var c=[],d=t.documentElement,u="svg"===d.nodeName.toLowerCase();l.addTest("video",function(){var e=s("video"),t=!1;try{(t=!!e.canPlayType)&&(t=new Boolean(t),t.ogg=e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),t.h264=e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),t.webm=e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""),t.vp9=e.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,""),t.hls=e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,""))}catch(e){}return t}),function(){var e,t,n,o,s,a,d;for(var u in r)if(r.hasOwnProperty(u)){if(e=[],t=r[u],t.name&&(e.push(t.name.toLowerCase()),t.options&&t.options.aliases&&t.options.aliases.length))for(n=0;n<t.options.aliases.length;n++)e.push(t.options.aliases[n].toLowerCase());for(o=i(t.fn,"function")?t.fn():t.fn,s=0;s<e.length;s++)a=e[s],d=a.split("."),1===d.length?l[d[0]]=o:(!l[d[0]]||l[d[0]]instanceof Boolean||(l[d[0]]=new Boolean(l[d[0]])),l[d[0]][d[1]]=o),c.push((o?"":"no-")+d.join("-"))}}(),delete a.addTest,delete a.addAsyncTest;for(var h=0;h<l._q.length;h++)l._q[h]();e.Modernizr=l}(window,document)},function(e,t,n){"use strict";var i=n(38),o=function(e){return e&&e.__esModule?e:{default:e}}(i);!function(e,t,n){if(!e.PushStream){var i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=function(e){return(e<10?"0":"")+e},a=function(e){var t=r(e.getUTCHours())+":"+r(e.getUTCMinutes())+":"+r(e.getUTCSeconds());return i[e.getUTCDay()]+", "+r(e.getUTCDate())+" "+s[e.getUTCMonth()]+" "+e.getUTCFullYear()+" "+t+" GMT"},l=function(){for(var e=arguments[0]||{},t=0;t<arguments.length;t++){var n=arguments[t];for(var i in n)n.hasOwnProperty&&!n.hasOwnProperty(i)||(e[i]=n[i])}return e},c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,h=/(?:^|:|,)(?:\s*\[)+/g,f=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},_=function(t){if(!t||!m(t))return null;if(t=f(t),e.JSON&&e.JSON.parse)try{return e.JSON.parse(t)}catch(e){throw"Invalid JSON: "+t}if(c.test(t.replace(d,"@").replace(u,"]").replace(h,"")))return new Function("return "+t)();throw"Invalid JSON: "+t},g=function(){return{_:(new Date).getTime()}},p=function(t){var n=t;if("object"===(void 0===t?"undefined":(0,o.default)(t))){n="";for(var i in t)t.hasOwnProperty&&!t.hasOwnProperty(i)||(n+="&"+i+"="+e.escape(t[i]));n=n.substring(1)}return n||""},E=function(e,t){return e+(e.indexOf("?")<0?"?":"&")+p(t)},T=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},m=function(e){return"[object String]"===Object.prototype.toString.call(e)},v={logger:null,debug:function(){"debug"===H.LOG_LEVEL&&v._log.apply(v._log,arguments)},info:function(){"info"!==H.LOG_LEVEL&&"debug"!==H.LOG_LEVEL||v._log.apply(v._log,arguments)},error:function(){v._log.apply(v._log,arguments)},_log:function(){if(!v.logger){var n=e.console;n&&n.log&&(n.log.apply?v.logger=n.log:"object"===(0,o.default)(n.log)&&Function.prototype.bind?v.logger=Function.prototype.bind.call(n.log,n):"object"===(0,o.default)(n.log)&&Function.prototype.call&&(v.logger=function(){Function.prototype.call.call(n.log,n,Array.prototype.slice.call(arguments))}))}v.logger&&v.logger.apply(e.console,arguments);var i=t.getElementById(H.LOG_OUTPUT_ELEMENT_ID);if(i){for(var s="",r=0;r<arguments.length;r++)s+=arguments[r]+" ";i.innerHTML+=s+"\n";var a=i.innerHTML.split("\n");a.length>100&&(i.innerHTML=a.slice(-100).join("\n"))}}},I={_getXHRObject:function(){var t=!1;try{t=new e.XMLHttpRequest}catch(n){try{t=new e.XDomainRequest}catch(n){try{t=new e.ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{t=new e.ActiveXObject("Microsoft.XMLHTTP")}catch(e){t=!1}}}}return t},_send:function(t,n){t=t||{},t.timeout=t.timeout||3e4;var i=I._getXHRObject();if(i&&t.url){I.clear(t),i.onreadystatechange=function(){4===i.readyState&&(I.clear(t),t.afterReceive&&t.afterReceive(i),200===i.status?t.success&&t.success(i.responseText):t.error&&t.error(i.status))},t.beforeOpen&&t.beforeOpen(i);var o={},s=null,r="GET";n?(s=p(t.data),r="POST"):o=t.data||{},i.open(r,E(t.url,l({},o,g())),!0),t.beforeSend&&t.beforeSend(i);var a=function(){try{i.abort()}catch(e){}I.clear(t),t.error(304)};return n?(i.setRequestHeader("Accept","application/json"),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")):t.timeoutId=e.setTimeout(a,t.timeout+2e3),i.send(s),i}},_clear_script:function(e){e&&(e.onerror=e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e))},_clear_timeout:function(t){t.timeoutId&&(t.timeoutId=e.clearTimeout(t.timeoutId))},clear:function(e){I._clear_timeout(e),I._clear_script(t.getElementById(e.scriptId))},jsonp:function(n){n.timeout=n.timeout||3e4,I.clear(n);var i=t.head||t.getElementsByTagName("head")[0],o=t.createElement("script"),s=(new Date).getTime(),r=function(){I.clear(n);var e=(new Date).getTime();n.error(e-s>n.timeout/2?304:0)},a=function(){I.clear(n),n.load()};o.onerror=r,o.onload=o.onreadystatechange=function(e){o.readyState&&!/loaded|complete/.test(o.readyState)||a()},n.beforeOpen&&n.beforeOpen({}),n.beforeSend&&n.beforeSend({}),n.timeoutId=e.setTimeout(r,n.timeout+2e3),n.scriptId=n.scriptId||(new Date).getTime(),o.setAttribute("src",E(n.url,l({},n.data,g()))),o.setAttribute("async","async"),o.setAttribute("id",n.scriptId),i.insertBefore(o,i.firstChild)},load:function(e){return I._send(e,!1)},post:function(e){return I._send(e,!0)}},C=function(t){return t?e.escape(t):""},O=function(t){return t?e.unescape(t):""},y=function(e,t){var n=e;return m(e)&&(n=_(e)),{id:n[t.jsonIdKey],channel:n[t.jsonChannelKey],data:m(n[t.jsonDataKey])?O(n[t.jsonDataKey]):n[t.jsonDataKey],tag:n[t.jsonTagKey],time:n[t.jsonTimeKey],eventid:n[t.jsonEventIdKey]||""}},N=function(e){return e.backtrack?".b"+Number(e.backtrack):""},A=function(e){var t="";for(var n in e)e.hasOwnProperty&&!e.hasOwnProperty(n)||(t+="/"+n+N(e[n]));return t},R=function(e,t,n){var i=e.wrapper.type===D.TYPE,o=e.useSSL,s=i?o?"wss://":"ws://":o?"https://":"http://";s+=e.host,s+=!o&&80===e.port||o&&443===e.port?"":":"+e.port,s+=t;var r=A(e.channels);if(e.channelsByArgument){var a={};a[e.channelsArgument]=r.substring(1),n=l({},n,a)}else s+=r;return E(s,n)},P=function(e){var t="",n=e.useSSL?"https://":"http://";n+=e.host,n+=80!==e.port&&443!==e.port?":"+e.port:"",n+=e.urlPrefixPublisher;for(var i in e.channels)if(!e.channels.hasOwnProperty||e.channels.hasOwnProperty(i)){t=i;break}return n+="?id="+t},S=function(e){if(e.match(/^(\d{1,3}\.){3}\d{1,3}$/))return e;var t=e.split("."),n=Math.max(t.length-1,e.match(/(\w{4,}\.\w{2}|\.\w{3,})$/)?2:3);return t.slice(-1*n).join(".")},L=function(e,t){return function(){return e.apply(t,arguments)}},b=function(e){return e&&clearTimeout(e),null},w=function(e){v.info("["+this.type+"] message received",arguments);var t=y(e.data,this.pushstream);this.pushstream._onmessage(t.data,t.id,t.channel,t.eventid,!0)},k=function(){this.pushstream._onopen(),v.info("["+this.type+"] connection opened")},U=function(e){v.info("["+this.type+"] error (disconnected by server):",e),this.pushstream.readyState===H.OPEN&&this.type===M.TYPE&&"error"===e.type&&this.connection.readyState===EventSource.CONNECTING||(this._closeCurrentConnection(),this.pushstream._onerror({type:e&&"load"===e.type||this.pushstream.readyState===H.CONNECTING?"load":"timeout"}))},D=function t(n){if(!e.WebSocket&&!e.MozWebSocket)throw"WebSocket not supported";this.type=t.TYPE,this.pushstream=n,this.connection=null};D.TYPE="WebSocket",D.prototype={connect:function(){this._closeCurrentConnection();var t=l({},this.pushstream.extraParams(),g()),n=R(this.pushstream,this.pushstream.urlPrefixWebsocket,t);this.connection=e.WebSocket?new e.WebSocket(n):new e.MozWebSocket(n),this.connection.onerror=L(U,this),this.connection.onclose=L(U,this),this.connection.onopen=L(k,this),this.connection.onmessage=L(w,this),v.info("[WebSocket] connecting to:",n)},disconnect:function(){this.connection&&(v.debug("[WebSocket] closing connection to:",this.connection.URL),this.connection.onclose=null,this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(e){}this.connection=null}},sendMessage:function(e){this.connection&&this.connection.send(e)}};var M=function t(n){if(!e.EventSource)throw"EventSource not supported";this.type=t.TYPE,this.pushstream=n,this.connection=null};M.TYPE="EventSource",M.prototype={connect:function(){this._closeCurrentConnection();var t=l({},this.pushstream.extraParams(),g()),n=R(this.pushstream,this.pushstream.urlPrefixEventsource,t);this.connection=new e.EventSource(n),this.connection.onerror=L(U,this),this.connection.onopen=L(k,this),this.connection.onmessage=L(w,this),v.info("[EventSource] connecting to:",n)},disconnect:function(){this.connection&&(v.debug("[EventSource] closing connection to:",this.connection.URL),this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.connection){try{this.connection.close()}catch(e){}this.connection=null}}};var F=function e(t){this.type=e.TYPE,this.pushstream=t,this.connection=null,this.url=null,this.frameloadtimer=null,this.pingtimer=null,this.iframeId="PushStreamManager_"+t.id};F.TYPE="Stream",F.prototype={connect:function(){this._closeCurrentConnection();var e=S(this.pushstream.host);try{t.domain=e}catch(t){v.error("[Stream] (warning) problem setting document.domain = "+e+" (OBS: IE8 does not support set IP numbers as domain)")}var n=l({},this.pushstream.extraParams(),g(),{streamid:this.pushstream.id});this.url=R(this.pushstream,this.pushstream.urlPrefixStream,n),v.debug("[Stream] connecting to:",this.url),this.loadFrame(this.url)},disconnect:function(){this.connection&&(v.debug("[Stream] closing connection to:",this.url),this._closeCurrentConnection(),this.pushstream._onclose())},_clear_iframe:function(){var e=t.getElementById(this.iframeId);e&&(e.onload=null,e.parentNode&&e.parentNode.removeChild(e))},_closeCurrentConnection:function(){this._clear_iframe(),this.connection&&(this.pingtimer=b(this.pingtimer),this.frameloadtimer=b(this.frameloadtimer),this.connection=null,this.transferDoc=null,"function"==typeof e.CollectGarbage&&e.CollectGarbage())},loadFrame:function(n){this._clear_iframe();try{var i=new e.ActiveXObject("htmlfile");i.open(),i.write('<html><script>document.domain="'+t.domain+'";<\/script></html>'),i.parentWindow.PushStream=H,i.close();var o=i.createElement("div");i.appendChild(o),o.innerHTML='<iframe src="'+n+'"></iframe>',this.connection=o.getElementsByTagName("IFRAME")[0],this.connection.onload=L(U,this),this.transferDoc=i}catch(e){var s=t.createElement("IFRAME");s.style.width="1px",s.style.height="1px",s.style.border="none",s.style.position="absolute",s.style.top="-10px",s.style.marginTop="-10px",s.style.zIndex="-20",s.PushStream=H,t.body.appendChild(s),s.setAttribute("src",n),s.onload=L(U,this),this.connection=s}this.connection.setAttribute("id",this.iframeId),this.frameloadtimer=e.setTimeout(L(U,this),this.pushstream.timeout)},register:function(e){this.frameloadtimer=b(this.frameloadtimer),e.p=L(this.process,this),this.connection.onload=L(this._onframeloaded,this),this.pushstream._onopen(),this.setPingTimer(),v.info("[Stream] frame registered")},process:function(e,t,n,i){this.pingtimer=b(this.pingtimer),v.info("[Stream] message received",arguments),this.pushstream._onmessage(O(n),e,t,i,!0),this.setPingTimer()},_onframeloaded:function(){v.info("[Stream] frame loaded (disconnected by server)"),this.connection.onload=null,this.disconnect()},setPingTimer:function(){this.pingtimer&&b(this.pingtimer),this.pingtimer=e.setTimeout(L(U,this),this.pushstream.pingtimeout)}};var x=function e(t){this.type=e.TYPE,this.pushstream=t,this.connection=null,this.lastModified=null,this.etag=0,this.connectionEnabled=!1,this.opentimer=null,this.messagesQueue=[],this._linkedInternalListen=L(this._internalListen,this),this.xhrSettings={timeout:this.pushstream.longPollingTimeout,data:{},url:null,success:L(this.onmessage,this),error:L(this.onerror,this),load:L(this.onload,this),beforeOpen:L(this.beforeOpen,this),beforeSend:L(this.beforeSend,this),afterReceive:L(this.afterReceive,this)}};x.TYPE="LongPolling",x.prototype={connect:function(){this.messagesQueue=[],this._closeCurrentConnection(),this.connectionEnabled=!0,this.xhrSettings.url=R(this.pushstream,this.pushstream.urlPrefixLongpolling);var t=S(this.pushstream.host),n=S(e.location.hostname),i=this.pushstream.port,o=e.location.port||(this.pushstream.useSSL?443:80);this.useJSONP=t!==n||i!==o||this.pushstream.longPollingUseJSONP,this.xhrSettings.scriptId="PushStreamManager_"+this.pushstream.id,this.useJSONP&&(this.pushstream.longPollingByHeaders=!1,this.xhrSettings.data.callback="PushStreamManager["+this.pushstream.id+"].wrapper.onmessage"),this._internalListen(),this.opentimer=e.setTimeout(L(k,this),5e3),v.info("[LongPolling] connecting to:",this.xhrSettings.url)},_listen:function(){this._internalListenTimeout&&b(this._internalListenTimeout),this._internalListenTimeout=e.setTimeout(this._linkedInternalListen,this.pushstream.longPollingInterval)},_internalListen:function(){this.connectionEnabled&&(this.xhrSettings.data=l({},this.pushstream.extraParams(),this.xhrSettings.data),this.useJSONP?I.jsonp(this.xhrSettings):this.connection||(this.connection=I.load(this.xhrSettings)))},disconnect:function(){this.connectionEnabled=!1,this.connection&&(v.debug("[LongPolling] closing connection to:",this.xhrSettings.url),this._closeCurrentConnection(),this.pushstream._onclose())},_closeCurrentConnection:function(){if(this.opentimer=b(this.opentimer),this.connection){try{this.connection.abort()}catch(e){}this.connection=null,this.lastModified=null,this.xhrSettings.url=null}},beforeOpen:function(e){if(null===this.lastModified){var t=new Date;this.pushstream.secondsAgo&&t.setTime(t.getTime()-1e3*this.pushstream.secondsAgo),this.lastModified=a(t)}this.pushstream.longPollingByHeaders||(this.xhrSettings.data[this.pushstream.longPollingTagArgument]=this.etag,this.xhrSettings.data[this.pushstream.longPollingTimeArgument]=this.lastModified)},beforeSend:function(e){this.pushstream.longPollingByHeaders&&(e.setRequestHeader("If-None-Match",this.etag),e.setRequestHeader("If-Modified-Since",this.lastModified))},afterReceive:function(e){this.pushstream.longPollingByHeaders&&(this.etag=e.getResponseHeader("Etag"),this.lastModified=e.getResponseHeader("Last-Modified")),this.connection=null},onerror:function(e){this.connectionEnabled&&(304===e?this._listen():(v.info("[LongPolling] error (disconnected by server):",e),this._closeCurrentConnection(),this.pushstream._onerror({type:403===e?"load":"timeout"})))},onload:function(){this._listen()},onmessage:function(e){v.info("[LongPolling] message received",e);for(var t=null,n=T(e)?e:e.split("\r\n"),i=0;i<n.length;i++)n[i]&&(t=y(n[i],this.pushstream),this.messagesQueue.push(t),!this.pushstream.longPollingByHeaders&&t.time&&(this.etag=t.tag,this.lastModified=t.time));for(this._listen();this.messagesQueue.length>0;){var o=this.messagesQueue.shift();this.pushstream._onmessage(o.data,o.id,o.channel,o.eventid,0===this.messagesQueue.length)}}};var V=[],H=function(t){t=t||{},this.id=V.push(this)-1,this.useSSL=t.useSSL||!1,this.host=t.host||e.location.hostname,this.port=t.port||(this.useSSL?443:80),this.timeout=t.timeout||15e3,this.pingtimeout=t.pingtimeout||3e4,this.reconnecttimeout=t.reconnecttimeout||3e3,this.checkChannelAvailabilityInterval=t.checkChannelAvailabilityInterval||6e4,this.secondsAgo=Number(t.secondsAgo),this.longPollingByHeaders=void 0===t.longPollingByHeaders||t.longPollingByHeaders,this.longPollingTagArgument=t.longPollingTagArgument||"tag",this.longPollingTimeArgument=t.longPollingTimeArgument||"time",this.longPollingUseJSONP=t.longPollingUseJSONP||!1,this.longPollingTimeout=t.longPollingTimeout||3e4,this.longPollingInterval=t.longPollingInterval||100,this.reconnecttimer=null,this.urlPrefixPublisher=t.urlPrefixPublisher||"/pub",this.urlPrefixStream=t.urlPrefixStream||"/sub",this.urlPrefixEventsource=t.urlPrefixEventsource||"/ev",this.urlPrefixLongpolling=t.urlPrefixLongpolling||"/lp",this.urlPrefixWebsocket=t.urlPrefixWebsocket||"/ws",this.jsonIdKey=t.jsonIdKey||"id",this.jsonChannelKey=t.jsonChannelKey||"channel",this.jsonDataKey=t.jsonDataKey||"text",this.jsonTagKey=t.jsonTagKey||"tag",this.jsonTimeKey=t.jsonTimeKey||"time",this.jsonEventIdKey=t.jsonEventIdKey||"eventid",this.modes=(t.modes||"eventsource|websocket|stream|longpolling").split("|"),this.wrappers=[],this.wrapper=null,this.onopen=null,this.onmessage=null,this.onerror=null,this.onstatuschange=null,this.channels={},this.channelsCount=0,this.channelsByArgument=t.channelsByArgument||!1,this.channelsArgument=t.channelsArgument||"channels",this.extraParams=t.extraParams||this.extraParams;for(var n=0;n<this.modes.length;n++)try{var i=null;switch(this.modes[n]){case"websocket":i=new D(this);break;case"eventsource":i=new M(this);break;case"longpolling":i=new x(this);break;case"stream":i=new F(this)}this.wrappers[this.wrappers.length]=i}catch(e){v.info(e)}this._setState(0)};H.LOG_LEVEL="error",H.LOG_OUTPUT_ELEMENT_ID="Log4jsLogOutput",H.CLOSED=0,H.CONNECTING=1,H.OPEN=2,H.prototype={extraParams:function(){return{}},addChannel:function(e,t){if(C(e)!==e)throw"Invalid channel name! Channel has to be a set of [a-zA-Z0-9]";if(v.debug("entering addChannel"),void 0!==this.channels[e])throw"Cannot add channel "+e+": already subscribed";t=t||{},v.info("adding channel",e,t),this.channels[e]=t,this.channelsCount++,this.readyState!==H.CLOSED&&this.connect(),v.debug("leaving addChannel")},removeChannel:function(e){this.channels[e]&&(v.info("removing channel",e),delete this.channels[e],this.channelsCount--)},removeAllChannels:function(){v.info("removing all channels"),this.channels={},this.channelsCount=0},_setState:function(e){this.readyState!==e&&(v.info("status changed",e),this.readyState=e,this.onstatuschange&&this.onstatuschange(this.readyState))},connect:function(){if(v.debug("entering connect"),!this.host)throw"PushStream host not specified";if(isNaN(this.port))throw"PushStream port not specified";if(!this.channelsCount)throw"No channels specified";if(0===this.wrappers.length)throw"No available support for this browser";this._keepConnected=!0,this._lastUsedMode=0,this._connect(),v.debug("leaving connect")},disconnect:function(){v.debug("entering disconnect"),this._keepConnected=!1,this._disconnect(),this._setState(H.CLOSED),v.info("disconnected"),v.debug("leaving disconnect")},_connect:function(){this._disconnect(),this._setState(H.CONNECTING),this.wrapper=this.wrappers[this._lastUsedMode++%this.wrappers.length];try{this.wrapper.connect()}catch(e){this.wrapper&&this.wrapper.disconnect()}},_disconnect:function(){this.reconnecttimer=b(this.reconnecttimer),this.wrapper&&this.wrapper.disconnect()},_onopen:function(){this.reconnecttimer=b(this.reconnecttimer),this._setState(H.OPEN),this._lastUsedMode>0&&this._lastUsedMode--},_onclose:function(){this.reconnecttimer=b(this.reconnecttimer),this._setState(H.CLOSED),this._reconnect(this.reconnecttimeout)},_onmessage:function(e,t,n,i,o){v.debug("message",e,t,n,i,o),-2===t?this.onchanneldeleted&&this.onchanneldeleted(n):t>0&&void 0!==this.channels[n]&&this.onmessage&&this.onmessage(e,t,n,i,o)},_onerror:function(e){this._setState(H.CLOSED),this._reconnect("timeout"===e.type?this.reconnecttimeout:this.checkChannelAvailabilityInterval),this.onerror&&this.onerror(e)},_reconnect:function(t){this._keepConnected&&!this.reconnecttimer&&this.readyState!==H.CONNECTING&&(v.info("trying to reconnect in",t),this.reconnecttimer=e.setTimeout(L(this._connect,this),t))},sendMessage:function(e,t,n){e=C(e),this.wrapper.type===D.TYPE?(this.wrapper.sendMessage(e),t&&t()):I.post({url:P(this),data:e,success:t,error:n})}},H.sendMessage=function(e,t,n,i){I.post({url:e,data:C(t),success:n,error:i})},H.register=function(e){var t=e.window.location.href.match(/streamid=([0-9]*)&?/);t[1]&&V[t[1]]&&V[t[1]].wrapper.register(e)},H.unload=function(){for(var e=0;e<V.length;e++)try{V[e].disconnect()}catch(e){}},e.PushStream=H,e.PushStreamManager=V,e.attachEvent&&e.attachEvent("onunload",H.unload),e.addEventListener&&e.addEventListener.call(e,"unload",H.unload,!1)}}(window,document)},function(e,t,n){"use strict";(function(t,i,o,s){function r(e){return e&&e.__esModule?e:{default:e}}var a=n(62),l=r(a),c=n(3),d=r(c),u=n(5),h=r(u),f=n(99),_=r(f),g=n(47),p=r(g),E=n(13),T=r(E),m=n(65),v=r(m),I=n(97),C=r(I),O=n(100),y=r(O),N=n(35),A=r(N),R=n(161),P=r(R),S=n(167),L=r(S),b=n(168),w=r(b),k=n(44),U=r(k),D=n(169),M=r(D),F=n(170),x=r(F),V=n(59),H=r(V),Y=n(177),B=r(Y),K=n(171),G=r(K),j=n(60),W=r(j),q=n(92),z=r(q),X=n(26),Q=r(X),J=n(175),Z=r(J),$=n(61),ee=r($),te=n(173),ne=r(te),ie=n(172),oe=r(ie),se=n(174),re=r(se),ae=n(93),le=r(ae),ce=n(45),de=r(ce),ue=n(176),he=r(ue),fe=n(178),_e=r(fe),ge=n(46),pe=r(ge),Ee=n(94),Te=r(Ee);t.PageController=oe.default,t.CacheController=P.default,t.ListController=G.default,t.PostController=ne.default,t.ReportController=Z.default,t.TimedViewTrackingController=B.default;var me=me||{};me.GA=i,me.Piwik=o,me.App=function(){var e={_data:{},_models:{},_controllers:{},init:function(){var t=e;s(document).ready(function(){t._onDomReady()}),s(window).on("load",function(){t._onWindowLoad()}),s(window).on("scroll",function(e){t._runOnControllers("onScroll")}),s(window).on("resize",function(e){t._runOnControllers("onResize")})},_onDomReady:function(){e._runOnModels("init"),e._runOnControllers("init")},_onWindowLoad:function(){e._runOnModels("onWindowLoad"),e._runOnControllers("onWindowLoad")},_runOnObjects:function(e,t){!e instanceof Object||s.each(e,function(e,n){n[t]&&"function"==typeof n[t]&&n[t]()})},_runOnModels:function(t){e._runOnObjects(e._models,t)},_runOnControllers:function(t){e._runOnObjects(e._controllers,t)},addModel:function(t){return e._models=t,this},addController:function(t){return e._controllers=t,this},setData:function(t,n){e._data[t]=n},_scriptMap:{facebook:"//connect.facebook.net/en_US/sdk.js",twitter:"//platform.twitter.com/widgets.js",gplus:"https://apis.google.com/js/platform.js",recaptcha:"https://www.google.com/recaptcha/api.js?onload=onCaptchaLoadedCallback&render=explicit&hl=en"},_loadAsyncScript:function(e,t){return function(){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.async=!0,n.id=e;var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)}()},loadAsynScripts:function(t){for(var n=0;n<t.length;n++)if(e._scriptMap[t[n]]){var i=t[n]+"-wbjs",o=e._scriptMap[t[n]];"twitter"==t[n]?window.twttr=e._loadAsyncScript(i,o):e._loadAsyncScript(i,o)}},loadConfigs:function(e){return d.default.load(e),this}};return{init:e.init,loadConfigs:e.loadConfigs,loadAsynScripts:e.loadAsynScripts,addModel:e.addModel,addController:e.addController}}();var ve={CacheFactory:l.default,User:T.default,Configs:d.default,Page:h.default,Toast:_.default,Track:p.default,Facebook:v.default,GPlus:C.default,Vote:y.default},Ie={RcfgAdsController:de.default,AccountController:A.default,CacheController:t.CacheController,CacheableController:L.default,FacebookController:w.default,FeaturedController:U.default,GPlusController:M.default,HeadbarController:x.default,KeyboardController:H.default,TimedViewTrackingController:B.default,ListController:t.ListController,ListScrollingController:W.default,NotificationsScrollingController:z.default,OverlayController:Q.default,ReportController:t.ReportController,ProfileController:ee.default,PostController:t.PostController,PageController:t.PageController,ProfileSettingController:re.default,PushController:le.default,ShareController:he.default,TwitterController:_e.default,UploadController:pe.default,WebNotiController:Te.default};me.App.addModel(ve).addController(Ie).init(),e.exports=me}).call(t,n(4),n(8),n(18),n(0))},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(6),s=i(o),r=n(7),a=i(r),l=function(){function e(){(0,s.default)(this,e)}return(0,a.default)(e,null,[{key:"arrayUnique",value:function(e){for(var t=e.concat(),n=0;n<t.length;++n)for(var i=n+1;i<t.length;++i)t[n]===t[i]&&t.splice(i--,1);return t}},{key:"arrayShuffle",value:function(e){for(var t=e.length;t>0;){var n=Math.floor(Math.random()*t);t--;var i=e[t];e[t]=e[n],e[n]=i}return e}}]),e}();e.exports=l},function(e,t,n){"use strict";var i={getPageviewCandidateUrl:function(){return"/static/pv.xml?ts="+(new Date).getTime()},fireBeaconTag:function(){if(void 0!==window.COMSCORE){var e={c1:"2",c2:"22471533"};return window.COMSCORE.beacon(e),!0}return!1}};e.exports=i},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(6),s=i(o),r=n(7),a=i(r),l=function(){function e(){(0,s.default)(this,e)}return(0,a.default)(e,null,[{key:"getTimestamp",value:function(){return Math.floor((new Date).getTime()/1e3)}},{key:"getDisplayTime",value:function(e){var t=this.getTimestamp()-e;if(t<0)return"";if(t<60)return"just now";var n=t/60;if(n<60)return Math.floor(n)+"m";var i=n/60;if(i<24)return Math.floor(i)+"h";var o=i/24;if(o<7)return Math.floor(o)+"d";var s=new Date(1e3*e);return s.getDate()+" "+this.TIME_MONTHS[s.getMonth()]+" "+s.getFullYear().toString().substr(-2)}},{key:"TIME_MONTHS",get:function(){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}}]),e}();e.exports=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var o=n(6),s=i(o),r=n(7),a=i(r),l=n(269),c=function(){function e(){(0,s.default)(this,e)}return(0,a.default)(e,null,[{key:"murmurhash3",value:function(e,t){return l.murmur3(e,t)}}]),e}();e.exports=c},function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}var o=n(11),s=i(o),r=n(37),a=i(r),l={RULES:[{category:"PostImpression",action:"PostImpression",aggregateCVarBy:"PostKey",debounceTime:2e3}],items:{},values:{},trackEventHandler:null,setTrackEventHandler:function(e){this.trackEventHandler=e},aggregate:function(e){for(var n=this,i=!1,o=0;o<this.RULES.length;o++){var s=this.RULES[o];if(e.category==s.category&&e.action==s.action){switch(function(){var o=e.deleteCVar(s.aggregateCVarBy);if(void 0==o)return"continue";var r=e.getHashCode();t.log("aggregate() hashCode="+r,o),i=!0,n.values[r]=n.values[r]||[],n.values[r].push(o);var a=n;return n.items[r]||(n.items[r]=e,setTimeout(function(){a.mergeTrackEvent(r)},s.debounceTime)),"break"}()){case"continue":continue}}}return i},mergeTrackEvent:function(e){var n=this.items[e],i=this.values[e],o=this.mergeCVars(i);(0,a.default)(o).forEach(function(e){n.cvars[e]=o[e]instanceof Array?(0,s.default)(o[e]):o[e]}),this.items[e]=null,this.values[e]=null,t.log("aggregate mergeTrackEvent() hashCode="+e+", values",i),t.log("aggregate mergeTrackEvent() hashCode="+e+", event-merged",n.getUniqueItemKey()),this.trackEventHandler(n)},mergeCVars:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n];(0,a.default)(i).forEach(function(e){t[e]=t[e]||[],-1==t[e].indexOf(i[e])&&t[e].push(i[e])})}return t}};e.exports=l}).call(t,n(2))},function(e,t,n){"use strict";(function(t,i){var o=n(11),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r={STORAGE_KEY:"sessionEvents",SESSION_TIME:1800,data:{},expireAt:0,fetch:function(){var e=null;if("undefined"!==window.localStorage)try{e=JSON.parse(window.localStorage.getItem(this.STORAGE_KEY))}catch(e){}var n=t.getTimestamp(),o=null==e?0:e.expireAt;i.log("SessionStorage.fetch() expireAt="+o+", TTL="+(o-n)),n>o?(this.data={},this.expireAt=n+this.SESSION_TIME,i.log("SessionStorage.fetch() newSession")):(this.data=e.data,this.expireAt=e.expireAt)},save:function(){"undefined"!==window.localStorage&&window.localStorage.setItem(this.STORAGE_KEY,(0,s.default)({data:this.data,expireAt:this.expireAt}))},extendExpiry:function(){this.expireAt=t.getTimestamp()+this.SESSION_TIME},getItem:function(e){return this.data[e]},setItem:function(e,t){this.data[e]=t}},a={UNIQUE_EVENT_CATEGORIES:["PostImpression"],storage:r,checkEvent:function(e){this.storage.fetch();var t=e.getHashCode(),n=!this.storage.getItem(t);return this.storage.setItem(t,1),this.storage.extendExpiry(),this.storage.save(),i.log("SessionFilter.checkEvent() hashCode="+t+", isNew="+n,e),n},filterEvent:function(e){return-1==this.UNIQUE_EVENT_CATEGORIES.indexOf(e.category)?e:this.checkEvent(e)?e:null}};e.exports=a}).call(t,n(153),n(2))},function(e,t,n){"use strict";(function(t,n){var i={EVENT_CATEGORY:"PostImpression",EVENT_ACTION_IMPRESSION:"PostImpression",timedActionList:[{action:"ViewPostForOneSecond",threshold:1},{action:"ViewPostForThreeSeconds",threshold:3}],trackedActions:{},getActionsByVideoViewTime:function(e,t,n){for(var i=t-n,o=[],s=0;s<this.timedActionList.length;s++)e>=this.timedActionList[s].threshold&&this.timedActionList[s].threshold<=i&&o.push(this.timedActionList[s].action);return o},getUniqueActionKey:function(e,t,n){var i=t;return n&&(i+=":"+n.TriggeredPage,i+=":"+n.TriggeredPageKey),i},filterTrackedActions:function(e,n,i,o){var s=this.getUniqueActionKey(e,i,o);t.log("uniqueActionKey",s);for(var r=this.trackedActions[s]||[],a=[],l=0;l<n.length;l++)-1===r.indexOf(n[l])&&(a.push(n[l]),r.push(n[l]));return this.trackedActions[s]=r,a},onImpression:function(e,t,n){this.sendUntrackedPostActions(e,t,[this.EVENT_ACTION_IMPRESSION],n)},onNonVideoView:function(e,t,n,i){this.sendUntrackedPostActions(e,t,["ViewPostForOneSecond"],i)},onVideoView:function(e,t,n,i,o,s){var r=this.getActionsByVideoViewTime(n,i,o);n>=.95*(i-o)&&r.push("FinishedVideo"),this.sendUntrackedPostActions(e,t,r,s)},sendUntrackedPostActions:function(e,i,o,s){var r=this.filterTrackedActions(e,o,i,s);t.log("sendUntrackedPostActions.untrackedActions entryId="+i,r),s=s||{},s.PostKey=i;for(var a=0;a<r.length;a++)n.trackEvent(this.EVENT_CATEGORY,r[a],e,1,s)}};e.exports=i}).call(t,n(2),n(18))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(6),r=o(s),a=n(7),l=o(a),c=.5,d=function(){function e(t,n){(0,r.default)(this,e),this.id="TTM:"+Math.floor(1e3*Math.random()),this.visibilityManager=t,this.videoTimeManager=n,this.setTimedViewVisibilityThreshold(c),this.timers={},this.videoPlayed={},this.screenKey="",this.trackingCVars={},this.onVisibilityChanges=this.onVisibilityChanges.bind(this),this.onVideoTimeUpdate=this.onVideoTimeUpdate.bind(this)}return(0,l.default)(e,[{key:"getVisibilityManager",value:function(){return this.visibilityManager}},{key:"getVideoTimeManager",value:function(){return this.videoTimeManager}},{key:"setScreenKey",value:function(e){this.screenKey=e}},{key:"setTimedViewVisibilityThreshold",value:function(e){this.log("setTimedViewVisibilityThreshold()",e),this.threshold=e}},{key:"setTrackingCVars",value:function(e){this.log("setTrackingCVars()",e),this.trackingCVars=e}},{key:"log",value:function(e,n){t.log("["+this.id+"] TimedTrackingManager."+e,n)}},{key:"track",value:function(e,t){this.visibilityManager.track(e,t)}},{key:"untrackAll",value:function(){this.visibilityManager.reset()}},{key:"check",value:function(){this.visibilityManager.checkItemVisibility()}},{key:"start",value:function(){this.videoTimeManager.addListener(this.onVideoTimeUpdate),this.visibilityManager.addListener(this.onVisibilityChanges),this.visibilityManager.start()}},{key:"stop",value:function(){this.videoTimeManager.removeListeners(),this.visibilityManager.removeListeners(),this.visibilityManager.stop()}},{key:"handleImpression",value:function(e,t){for(var n=0;n<e.length;n++){var o=e[n],s=this.shouldCheckImpression(o),r=e[n].result;r&&(this.log("handleImpression() key="+o.data.key+", %="+r.visiblePercentage+", screen%="+r.screenPercentage+", shouldCheck="+s),s&&i.onImpression(this.screenKey,o.data.key,this.trackingCVars))}for(var a=0;a<t.length;a++){var l=t[a],c=this.shouldCheckImpression(l);this.log("handleImpression() for skipped item key="+l.data.key+", shouldCheck="+c),c&&i.onImpression(this.screenKey,l.data.key,this.trackingCVars)}}},{key:"handleNonVideoView",value:function(e,t){for(var n=this,o=0;o<e.length;o++){(function(t){var o=e[t],s=o.data.key,r=n.shouldCheckNonVideoView(o);if(n.log("handleNonVideoView() key="+s+", check="+r),!r)return"continue";var a=n;void 0==n.timers[s]&&(n.log("handleNonVideoView() set timer, key="+s),n.timers[s]=setTimeout(function(){a.log("handleNonVideoView() run timer, key="+s),a.timers[s]=0,i.onNonVideoView(a.screenKey,s,1,a.trackingCVars)},1e3+n.visibilityManager.getDebounceTime()))})(o)}for(var o=0;o<t.length;o++){var s=t[o].data.key;if(this.timers[s]){this.log("handleNonVideoView() unset timer="+s),clearTimeout(this.timers[s]),this.timers[s]=void 0;try{delete this.timers[s]}catch(e){}}}}},{key:"onVisibilityChanges",value:function(e,t,n,i){this.handleImpression(t,i),this.handleNonVideoView(e,n)}},{key:"onVideoTimeUpdate",value:function(e,t,n,o,s){s=s||0;var r=e.key;if(r){var a=this.shouldCountVideoTime(e,t,n,o,s);if(this.log("onVideoTimeUpdate() key="+r+", startTime="+s+", currentTime="+n+", duration="+o+", shouldCount="+a,e),a){var l=this.videoPlayed[r]||{accumPlayTime:0,lastPlayTime:0,startTime:s,duration:o},c=l.accumPlayTime>o,d=n-l.lastPlayTime,u=0;u=d>0?d:o-l.lastPlayTime+(n-s),u>0&&1e3*u<=5e3?l.accumPlayTime+=u:(u=0,this.log("onVideoTimeUpdate() key="+r+", accumPlayTimeIncrease="+u+", invalid playtime change")),l.lastPlayTime=n,this.videoPlayed[r]=l,this.log("onVideoTimeUpdate() key="+r+", accumPlayTimeIncrease="+u+", completed="+c,l),c||i.onVideoView(this.screenKey,r,l.accumPlayTime,o,s,this.trackingCVars)}}}},{key:"isVisibilityThresholdPassed",value:function(e){var t=e&&e.result&&(e.result.visiblePercentage>=this.threshold||e.result.screenPercentage>=this.threshold);return this.log("isVisibilityThresholdPassed() passed="+t,e),t}},{key:"shouldCheckImpression",value:function(e){return!0}},{key:"shouldCheckNonVideoView",value:function(e){return this.isVisibilityThresholdPassed(e)}},{key:"shouldCountVideoTime",value:function(e,t,n,i){if(n=n||0,i=i||0,!t||!n||!i)return!1;var o=this.visibilityManager.getVisibleItem(e.domId);return this.isVisibilityThresholdPassed(o)}}]),e}();e.exports=d}).call(t,n(2),n(157))},function(e,t,n){"use strict";(function(t){function i(e){return e&&e.__esModule?e:{default:e}}var o=n(6),s=i(o),r=n(7),a=i(r),l=function(){function e(t,n){(0,s.default)(this,e),this.id="VM:"+Math.floor(1e3*Math.random()),this.updateViewPortOffsets(t,n),this.listeners=[],this.reset(),this.onScrollListener=this.onScrollListener.bind(this),this.onResizeListener=this.onResizeListener.bind(this),this.listenerAdded=!1,this.debounce=100}return(0,a.default)(e,[{key:"updateViewPortOffsetsForLayout",value:function(){}},{key:"updateViewPortOffsets",value:function(e,t){this.viewportBegOffset=e,this.viewportEndOffset=t,this.updateViewPortRange()}},{key:"updateViewPortRange",value:function(){this.viewportBeg=this.viewportBegOffset||0,this.viewportEnd=(window.innerHeight||document.documentElement.clientWidth)-(this.viewportEndOffset||0),this.log("updateViewPortRange() viewportBegOffset="+this.viewportBegOffset+", viewportEndOffset="+this.viewportEndOffset),this.log("updateViewPortRange() viewportBeg="+this.viewportBeg+", viewportEnd="+this.viewportEnd)}},{key:"getDebounceTime",value:function(){return this.debounce}},{key:"log",value:function(e,n){t.log("["+this.id+"] VisibilityManager."+e,n)}},{key:"reset",value:function(){this.log("reset()"),this.domIds=[],this.elementData=[],this.prevVisibleItems=[],this.prevVisibleMap={}}},{key:"track",value:function(e,t){var n=this.domIds.indexOf(e);-1==n?(this.log("track() add domId="+e,t),this.domIds.push(e),this.elementData.push(t),this.debug()):(this.log("track() update domId="+e,t),this.elementData[n]=t)}},{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"removeListeners",value:function(){this.listeners=[]}},{key:"start",value:function(){this.log("start() listenerAdded="+this.listenerAdded),this.listenerAdded||(this.listenerAdded=!0,window.addEventListener("scroll",this.onScrollListener),window.addEventListener("resize",this.onResizeListener)),this.checkItemVisibility()}},{key:"stop",value:function(){this.log("stop()"),window.removeEventListener("scroll",this.onScrollListener),window.removeEventListener("resize",this.onResizeListener),this.listenerAdded=!1}},{key:"debug",value:function(){this.log("tracked domIds",this.domIds)}},{key:"onScrollListener",value:function(){this.onScrollTimer&&clearTimeout(this.onScrollTimer);var e=this;this.onScrollTimer=setTimeout(function(){e.checkItemVisibility(),this.onScrollTimer=null},this.getDebounceTime())}},{key:"onResizeListener",value:function(){this.onResizeTimer&&clearTimeout(this.onResizeTimer);var e=this;this.onResizeTimer=setTimeout(function(){e.updateViewPortRange(),this.onResizeTimer=null},3e3)}},{key:"checkItemVisibility",value:function(){var e=this.binaryCheck(this.domIds,0,this.domIds.length-1),t=this.resultListToMap(this.prevVisibleItems),n=this.resultListToMap(e),i=[];for(var o in t)n[o]||i.push(t[o]);var s=[];for(var r in n)t[r]||s.push(n[r]);var a=this.getSkippedItems(this.prevVisibleItems,e);this.log("checkItemVisibility() in-viewport",e),this.log("checkItemVisibility() becomeVisibleItems",s),this.log("checkItemVisibility() becomeInvisibleItems",i),this.log("checkItemVisibility() skippedItems",a),this.prevVisibleItems=e,this.prevVisibleMap=n;for(var l=0;l<this.listeners.length;l++)this.listeners[l](e,s,i,a)}},{key:"getSkippedItems",value:function(e,t){var n=[];if(e.length>0&&t.length>0){for(var i=void 0,o=void 0,s=void 0,r=void 0,a=0;a<e.length;a++)i=void 0==i?e[a].domIdIndex:Math.min(i,e[a].domIdIndex),o=void 0==o?e[a].domIdIndex:Math.max(o,e[a].domIdIndex);for(var l=0;l<t.length;l++)s=void 0==s?t[l].domIdIndex:Math.min(s,t[l].domIdIndex),r=void 0==r?t[l].domIdIndex:Math.max(r,t[l].domIdIndex);if(Math.max(i,s)>Math.min(o,r))for(var d=Math.min(o,r)+1;d<Math.max(i,s);d++)n.push(new c(this.domIds[d],this.elementData[d],null,d))}return n}},{key:"getVisibleItem",value:function(e){return this.prevVisibleMap[e]}},{key:"resultListToMap",value:function(e){for(var t={},n=0;n<e.length;n++)t[e[n].domId]=e[n];return t}},{key:"binaryCheck",value:function(e,t,n){if(!e||0==e.length)return[];if(t>n||t<0||n>=e.length)return[];var i=Math.floor((t+n)/2),o=[],s=[],r=[],a=this.inViewport(e[i],this.viewportBeg,this.viewportEnd);return this.log("binaryCheck() "+i+": "+e[i],a),a?a.inViewport?(o=this.binaryCheck(e,t,i-1),s.push(new c(e[i],this.elementData[i],a,i)),r=this.binaryCheck(e,i+1,n)):a.belowViewport?o=this.binaryCheck(e,t,i-1):a.aboveViewport&&(r=this.binaryCheck(e,i+1,n)):(o=this.binaryCheck(e,t,i-1),r=this.binaryCheck(e,i+1,n)),o.concat(s).concat(r)}},{key:"inViewport",value:function(e,t,n){var i=document.getElementById(e);if(!i)return null;var o=i.getBoundingClientRect();this.log("inViewport() domId="+e,o);var s=o.top>=t&&o.top<=n,r=o.bottom>=t&&o.bottom<=n,a=n-t;return o.top<t&&o.bottom>n?new d({inViewport:!0,visibleHeight:a,visiblePercentage:a/o.height,screenPercentage:1}):s&&r?new d({inViewport:!0,visibleHeight:o.height,visiblePercentage:1,screenPercentage:o.height/a}):s?new d({inViewport:!0,visibleHeight:n-o.top,visiblePercentage:(n-o.top)/o.height,screenPercentage:(n-o.top)/a}):r?new d({inViewport:!0,visibleHeight:o.bottom-t,visiblePercentage:(o.bottom-t)/o.height,screenPercentage:(o.bottom-t)/a}):o.top>n?new d({belowViewport:!0}):o.bottom<t?new d({aboveViewport:!0}):null}}]),e}(),c=function e(t,n,i,o){(0,s.default)(this,e),this.domId=t,this.data=n||{},this.result=i,this.domIdIndex=o},d=function e(t){(0,s.default)(this,e),this.inViewport=t.inViewport||!1,this.aboveViewport=t.aboveViewport||!1,this.belowViewport=t.belowViewport||!1,this.visibleHeight=t.visibleHeight||0,this.visiblePercentage=t.visiblePercentage||0,this.screenPercentage=t.screenPercentage||0};e.exports=l}).call(t,n(2))},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function o(){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api",e.async=!0;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}Object.defineProperty(t,"__esModule",{value:!0});var s=n(6),r=i(s),a=n(7),l=i(a),c=function(){function e(t){var n=t.id,i=t.onSeek,o=t.onPercentageChange,s=t.onStart,a=t.onResume,l=t.onPause,c=t.onEnded;(0,r.default)(this,e),this.id=n,this.timestamp=Date.now(),this.lastPlayerState=-1,this.lastPercentage=0,this.lastPlayerTime=0,this.started=!1,this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.onPlayerReady=this.onPlayerReady.bind(this),this.onYouTubePlayerAPIReady=this.onYouTubePlayerAPIReady.bind(this),this.onStateChange=this.onStateChange.bind(this),this.checkStatus=this.checkStatus.bind(this),this.isSeeking=this.isSeeking.bind(this),this.getCurrentState=this.getCurrentState.bind(this),this.getPlayerId=this.getPlayerId.bind(this),this.onSeek=i,this.onPercentageChange=o,this.onStart=s,this.onResume=a,this.onPause=l,this.onEnded=c}return(0,l.default)(e,[{key:"start",value:function(){window.YT&&window.YT.Player?this.onYouTubePlayerAPIReady():(window.onYouTubePlayerAPIReady=this.onYouTubePlayerAPIReady,o()),this.checkStatusInterval=setInterval(this.checkStatus,1e3)}},{key:"stop",value:function(){window.onYouTubePlayerAPIReady=null,this.checkStatusInterval&&clearInterval(this.checkStatusInterval)}},{key:"onPlayerReady",value:function(e){this.player=e.target}},{key:"onYouTubePlayerAPIReady",value:function(){var e=this.getPlayerId,t=this.onPlayerReady,n=this.onStateChange;new YT.Player(e(),{videoId:this.id,events:{onReady:t,onStateChange:n}})}},{key:"onStateChange",value:function(e){var t=this.getCurrentState();if(null!==t){var n=this.lastPlayerState===YT.PlayerState.PLAYING,i=this.lastPlayerState===YT.PlayerState.PAUSED,o=e.data===YT.PlayerState.PLAYING,s=e.data===YT.PlayerState.PAUSED&&!this.isSeeking(),r=e.data===YT.PlayerState.ENDED,a=this.onStart,l=this.onResume,c=this.onPause,d=this.onEnded;o&&!this.started&&(a&&a(t),this.started=!0),o&&i&&l&&l(t),s&&n&&c&&c(t),r&&d&&d(t),this.lastPlayerState=e.data}}},{key:"checkStatus",value:function(){var e=this.getCurrentState();if(null!==e){var t=this.onSeek,n=this.onPercentageChange;this.isSeeking()&&t&&t(e),e.percentage>this.lastPercentage&&n&&n(e),this.lastPercentage=e.percentage,this.lastPlayerTime=e.time}}},{key:"isSeeking",value:function(){var e=Math.floor(this.player.getCurrentTime());return Math.abs(e-this.lastPlayerTime)>2}},{key:"getCurrentState",value:function(){if(!this.player)return null;var e=Math.floor(this.player.getCurrentTime()),t=Math.floor(this.player.getDuration());return{state:this.player.getPlayerState(),percentage:e/t*100,isPlaying:this.player.getPlayerState()===YT.PlayerState.PLAYING,time:e,lastTime:this.lastPlayerTime,duration:t}}},{key:"getPlayerId",value:function(){return"embedded-youtube-view-"+this.id+"-"+this.timestamp}}]),e}();t.default=c},function(e,t,n){"use strict";(function(t,i){var o=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r=t.extend({},new s.default,{_dataMap:{},_updateQueue:[],_entryUpdateQueue:[],init:function(){this._dataMap.entryInfo={}},keys:{ENTRY_LIST:"entryList",ENTRY_INFO:"entryInfo",FEATURED_LIST:"featuredList",FEATURED_INFO:"featuredInfo"},getValue:function(e){return this._dataMap[e]},setValue:function(e,t){this._dataMap[e]=t},invalidate:function(e){delete this._dataMap[e]},reset:function(){this._dataMap={}},notifyForCacheUpdate:function(e){this._updateQueue.push(e)},isUpdateNeeded:function(e){return t.inArray(e,this._updateQueue)>=0},notifyForCacheUpdateCompleted:function(e){var n=t.inArray(e,this._updateQueue);n>=0&&this._updateQueue.splice(n,1)},setList:function(e,t){e instanceof Array&&(this._dataMap[t]=e)},getList:function(e){return this._dataMap[e]||(this._dataMap[e]=[]),this._dataMap[e]},addItemsToList:function(e,n){for(var i=0;i<e.length;i++)!1===t.inArray(e[i],this.getList(n))&&this.getList(n).push(e[i])},setItemInfoForList:function(e,t,n){this.getList(n)[e]=t},getItemInfoForList:function(e,t){return this.getList(t)||(this.getList(t)[e]={}),this.getList(t)[e]},getItemInfoForKeyInList:function(e,t,n){return this.getItemInfoForList(e,n)?this.getItemInfoForList(e,n)[t]:null},handlers:{getEntryInfoFromDOM:function(e){return{offset:t(e).offset(),height:t(e).height(),outerHeight:t(e).outerHeight()}},getFeaturedItemInfoFromDOM:function(e){return{top:t(e).offset().top,height:t(e).height()}},featuredItemHandler:{setFeaturedList:function(e){var t=r;t.setList(e,t.keys.FEATURED_LIST)},getFeaturedList:function(){var e=r;return e.getList(e.keys.FEATURED_LIST)},addFeaturedItemsToList:function(e){var t=r;t.addItemsToList(e,t.keys.FEATURED_LIST)},setFeaturedItemInfo:function(e,t){var n=r;n.setItemInfoForList(e,t,n.keys.FEATURED_INFO)},getFeaturedItemInfo:function(e){var t=r;return t.getItemInfoForList(e,t.keys.FEATURED_INFO)},getFeaturedItemInfoForKey:function(e,t){var n=r;return n.getItemInfoForKeyInList(e,t,n.keys.FEATURED_INFO)}},entryHandler:{__self:r,setEntryList:function(e){var t=r;t.setList(e,t.keys.ENTRY_LIST)},getEntryList:function(){var e=r;return e.getList(e.keys.ENTRY_LIST)},addEntriesToList:function(e){var t=r;t.addItemsToList(e,t.keys.ENTRY_LIST)},setEntryInfo:function(e,t){var n=r;n.setItemInfoForList(e,t,n.keys.ENTRY_INFO)},getEntryInfo:function(e){var t=r;return t.getItemInfoForList(e,t.keys.ENTRY_INFO)},getEntryInfoForKey:function(e,t){var n=r;return n.getItemInfoForKeyInList(e,t,n.keys.ENTRY_INFO)}}},getFeaturedItemHandler:function(){return r.handlers.featuredItemHandler},getEntryHandler:function(){return r.handlers.entryHandler},parseEntryInfo:function(){var e=r,n=[];t(i.ListController.selectors.ENTRY_CONTAINER).each(function(){var i=t(this).data("entry-id");n.push(i);var o=e.handlers.getEntryInfoFromDOM(t(this));e.handlers.entryHandler.setEntryInfo(i,o)}),e.handlers.entryHandler.setEntryList(n)},updateEntryInfoForEntryIds:function(e){for(var n=0;n<e.length;n++){var i=t("#jsid-entry-entity-"+e[n]);i&&1==i.length&&this.handlers.getEntryInfoFromDOM(i)}}});e.exports=r}).call(t,n(0),n(4))},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(1),a=s(r),l=n(183),c=s(l),d=n(5),u=s(d),h=t.extend({},new a.default,{controllerName:"userPreference",selectors:{},handler:null,remoteHandler:null,init:function(e){return this.handler=c.default,this.remoteHandler=e,this},process:function(){this.handler.get()||this.remoteHandler.addToQueue(this.controllerName,this.handler.formatRemoteParams(),"responseCallback")},responseCallback:function(e){if(void 0!=e["user-preference"]){var t=e["user-preference"];this._updateCookies(t),this._updateUI(),this.handler.updateCache(t)}},_updateCookies:function(e){var n=u.default.getCookieOptions();n.domain=i.get("page.cookie_domain"),void 0!==e.isSafeModeOn&&t.cookie(o.PageController._safeModeCookieKey,e.isSafeModeOn?"1":"0",n)},_updateUI:function(){}});e.exports=h}).call(t,n(0),n(3),n(4))},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(1),a=s(r),l=n(46),c=s(l),d=n(184),u=s(d),h=t.extend({},new a.default,{controllerName:"userQuota",handler:null,remoteHandler:null,init:function(e){return this.handler=u.default,this.remoteHandler=e,this},process:function(){var e=this.handler.get();e?(i._configs.user.showCaptcha=!1!==e.restricted,this.updateUI()):(o.log("empty cacheUserQuota. try to retrieve from server"),this.remoteHandler.addToQueue(this.controllerName,this.handler.formatRemoteParams(),"responseCallback"))},responseCallback:function(e){void 0!=e["user-quota"]&&(this.handler.updateCache(e["user-quota"]),i._configs.user.showCaptcha=!1!==e["user-quota"].restricted,this.updateUI())},updateUI:function(e){c.default.initialize()}});e.exports=h}).call(t,n(0),n(3),n(2))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(1),r=o(s),a=n(63),l=o(a),c=t.extend({},new r.default,{controllerName:"userUpload",selectors:{ENTRY_INFO:".badge-entry-info",DELETE_SEPARATOR:".badge-item-delete-dot",DELETE_LINK:".badge-item-delete",REPORT_SEPARATOR:".badge-item-report-dot",REPORT_LINK:".badge-item-report",ARTICLE:"#individual-post article"},handler:null,remoteHandler:null,init:function(e){return this.handler=l.default,this.remoteHandler=e,this},process:function(){var e=this.handler.get();e&&(i.log("found cacheUserUpload. update ui"),this.updateUI(e)),e||(i.log("empty cacheUserUpload. try to retrieve from server"),this.remoteHandler.addToQueue(this.controllerName,this.handler.formatRemoteParams(),"responseCallback"))},responseCallback:function(e){void 0!=e["user-upload"]&&(this.handler.updateCache(e["user-upload"]),this.updateUI(e["user-upload"]))},updateUI:function(e){var n=this,i=""+t(n.selectors.ARTICLE).data("entry-id");-1!=e.indexOf(i)&&(t(n.selectors.DELETE_LINK).removeClass("hide"),t(n.selectors.REPORT_SEPARATOR).addClass("hide"),t(n.selectors.REPORT_LINK).addClass("hide"),t(n.selectors.ENTRY_INFO).text().match(/ ago/)&&t(n.selectors.REPORT_SEPARATOR).removeClass("hide"))}});e.exports=c}).call(t,n(0),n(2))},function(e,t,n){"use strict";(function(t,i,o,s){function r(e){return e&&e.__esModule?e:{default:e}}var a=n(1),l=r(a),c=n(46),d=r(c),u=n(61),h=r(u),f=n(185),_=r(f),g=n(13),p=r(g),E=t.extend({},new l.default,{controllerName:"user",selectors:{},handler:null,remoteHandler:null,_unverifiedCookieKey:"unverified",init:function(e){return this.handler=_.default,this.remoteHandler=e,this},process:function(){var e=this.handler.get();e&&(i.log("found cache cachedUser. update ui"),this.updateUI(e)),e||(i.log("empty cache cachedUser. try to retrieve from server"),this.remoteHandler.addToQueue(this.controllerName,this.handler.formatRemoteParams(),"responseCallback"))},responseCallback:function(e){if(void 0!=e.user){var n=this.handler.getFromCache();null==n&&(n={}),t.each(e.user,function(e,t){n[e]=t}),this.handler.updateCache(n),this.updateUI(e)}else o.PageController.initUserFunction()},updateUI:function(e){if(e.user)var n=e.user;else var n=e;var i=n.username,r=n.userId,a=n.accountId,l=n.avatar,c=n.notiOptions,u=n.commentSso,f=n.hashId,_=n.authUrl;if(s._configs.user.username=i,s._configs.user.id=r,s._configs.user.account_id=a,s._configs.user.avatar=l,s._configs.user.noti=c,s._configs.user.comment_auth=u,s._configs.user.hashId=f,s._configs.user.acs_url=_,p.default.init(),o.PageController.initUserFunction(),1==t.cookie(this._unverifiedCookieKey)&&o.PageController.showConfirmEmailBanner(i),i&&document.getElementById("jsid-my-profile")){document.getElementById("jsid-my-profile").href="/u/"+i}l&&(t("#jsid-avatar").attr("src",l),d.default.updateMyProfileOnlyIcon(l)),h.default.updateProfileMoreButton(n)}});e.exports=E}).call(t,n(0),n(2),n(4),n(3))},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(1),a=s(r),l=n(64),c=s(l),d=t.extend({},new a.default,{controllerName:"vote",selectors:{ENTRY:"article[data-entry-id]"},handler:null,remoteHandler:null,init:function(e){return this.handler=c.default,this.remoteHandler=e,this},process:function(){var e=this.handler.get();e&&(i.log("found cache. update ui"),this.updateUI(e)),e||(i.log("empty cache. try to retrieve from server"),this.remoteHandler.addToQueue(this.controllerName,this.handler.formatRemoteParams(),"responseCallback"))},responseCallback:function(e){if(void 0!=e.vote){var n=this.handler.getFromCache();null==n&&(n={}),t.each(e.vote,function(e,t){n[e]=parseInt(t)}),this.handler.updateCache(n),this.updateUI(e.vote)}},updateUI:function(e){t(this.selectors.ENTRY).each(function(n,i){var s=t(i).data("entry-id");if(void 0!=e[s]){var r=parseInt(e[s]);r>0?o.PostController.handlers.likeHandler(s):r<0?o.PostController.handlers.dislikeHandler(s):o.PostController.handlers.unlikeHandler(s)}})}});e.exports=d}).call(t,n(0),n(2),n(4))},function(e,t,n){"use strict";(function(t,i,o,s,r){function a(e){return e&&e.__esModule?e:{default:e}}var l=n(1),c=a(l),d=n(166),u=a(d),h=n(165),f=a(h),_=n(162),g=a(_),p=n(164),E=a(p),T=n(163),m=a(T),v=n(182),I=a(v),C=t.extend({},new c.default,{cacheableControllersOrderedList:["vote","user","userPreference","userUpload","userQuota"],cacheableControllers:{vote:u.default,user:f.default,userPreference:g.default,userUpload:E.default,userQuota:m.default},clearCookieKey:"cacheableClear",remoteHandler:null,selectors:{BTN_LOGOUT:".badge-logout-btn"},init:function(){this.remoteHandler=I.default;var e=this;if(t.each(this.cacheableControllersOrderedList,function(t,n){var o=e.cacheableControllers[n].init(e.remoteHandler);i.setController(n,o)}),t.cookie(this.clearCookieKey)&&(this.clearAllCache(),t.cookie(this.clearCookieKey,0,{domain:o.get("page.cookie_domain"),expires:-1,path:"/"})),!this.remoteHandler.issetPhpSessionId()||this.remoteHandler.isInGracePeriod())return this.remoteHandler.issetPhpSessionId()||s.log("CacheableRemoteHandler php session id is not set. Bye!!"),this.remoteHandler.isInGracePeriod()&&s.log("CacheableRemoteHandler is in grace period. Bye!!"),void r.PageController.initUserFunction();s.log("calling cacheable"),this.bindDomReady(),this.bindLogoutBtn()},clearAllCache:function(){s.log("CacheableController clear all cache"),t.each(this.cacheableControllersOrderedList,function(e,t){i.getController(t).handler.clearCache()}),r.PageController.initUserFunction()},bindDomReady:function(){var e=this;t(function(){t.each(e.cacheableControllersOrderedList,function(e,t){i.getController(t).process()}),e.remoteHandler.processQueue()})},bindLogoutBtn:function(){var e=this;t(this.selectors.BTN_LOGOUT).on("click",function(t){e.clearAllCache()})}});e.exports=C}).call(t,n(0),n(43),n(3),n(2),n(4))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(1),r=o(s),a=n(65),l=o(a),c=t.extend({},new r.default,function(){var e={BADGE_FACEBOOK_RENDER:".badge_facebook_render",FB_RENDER_PREFIX:"jsid-fb-render",_pushFbElementsToQueue:function(){t(e.BADGE_FACEBOOK_RENDER).each(function(e,n){var o=t(n).attr("id");o||(o=i.PageController.getUniqueDomId(c.FB_RENDER_PREFIX),t(n).attr("id",o)),l.default.renderElement(o)})},_bindAddToTimelineButtons:function(){t(".badge-add-fb-timeline").on("click",function(e){if(e.preventDefault(),t(this).hasClass("switch_on"))return void c.enableFbTimelineAck(!1);try{FB.login(function(e){var t=!!e.authResponse;c.enableFbTimelineAck(t)},{scope:"email"})}catch(e){}})}};return{init:function(){e._pushFbElementsToQueue(),e._bindAddToTimelineButtons()},enableFbTimelineAck:function(e){var n="/member/facebook-timeline",i={platform:"facebook"};e||(n="/connect/unlink"),t.ajax({type:"POST",dataType:"json",url:n,data:i,success:function(e){window.location.reload()}})}}}());e.exports=c}).call(t,n(0),n(4))},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(1),a=s(r),l=n(97),c=s(l),d=n(5),u=s(d),h=t.extend({},new a.default,{init:function(){this._bindElements(),this._bindSocialTransfer()},_bindProfile:function(e){if("profile"==c.default.btnClicked&&e.access_token){var n=e.code,o={platform:"google-plus"};n&&(o.code=n),t.ajax({url:"/connect/social",type:"POST",dataType:"json",data:o,success:function(e){window.location.reload()},error:function(e){i.log(e)}})}},_bindSocialTransfer:function(){var e=t("#social-transfer form");0!=e.length&&c.default.renderButton("jsid-confirm-transfer",function(n){"transfer"==c.default.btnClicked&&(n.access_token?(t("input[name=code]",e).val(n.code),e.submit()):window.location.reload())})},_doLogin:function(e){if("login"==c.default.btnClicked&&e.access_token){var t=e.code,n="https://"+u.default.getDomain()+"/connect/google-plus-callback?code="+encodeURIComponent(t);window.location.href=n}},_bindElements:function(){c.default.renderButton("jsid-gplus-btn-settings",this._bindProfile),t(".badge-gplus-connect").each(function(e,n){var i=t(n),s=i.attr("id");s||(s=o.PageController.getUniqueDomId("gplus"),i.attr("id",s)),c.default.renderButton(s,h._doLogin)}),t(".badge-gplus-connect-btn").click(function(){c.default.btnClicked=t(this).data("type")||"login"})}});e.exports=h}).call(t,n(0),n(2),n(4))},function(e,t,n){"use strict";(function(t){var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},new o.default,function(){var e={_bindElements:function(){e._bindSearchIcon()},_bindSearchIcon:function(){t("#jsid-search-icon").on("click",function(t){t.preventDefault(),e._toggleSearchBar()})},SLIDE_DURATION:300,_toggleSearchBar:function(){t("#header_searchbar").slideToggle(e.SLIDE_DURATION)}};return{init:function(){e._bindElements()}}}());e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(1),r=o(s),a=n(60),l=o(a),c=n(5),d=o(c),u=n(47),h=o(u),f=t.extend({},new r.default,{_scrollDuration:100,_focusMinimumInViewPortion:150,_entryReadTimeout:800,_playGifTimeout:300,_scrollFaultTolerance:20,_lastScrolledTop:-500,_scrollAutoPlayGifTimeoutObject:!1,_scrollAutoPlayGifRatio:.6,selectors:{LIST_VIEW:".badge-list-view-element",ENTRY_CONTAINER:".badge-entry-container",IN_VIEW_ELEMENTS:".badge-in-view",IN_FOCUS_ELEMENTS:".badge-in-view-focus",IN_VIEW_CLASS:"badge-in-view",IN_FOCUS_CLASS:"badge-in-view-focus",ENTRY_CONTAINER_ID_PREFIX:"#jsid-entry-entity-"},customEvents:{IN_FOCUS_SET:"inViewFocusSet",IN_FOCUS_UNSET:"inViewFocusUnset",ENTRY_READ:"entryRead"},init:function(){this.bindElements(),t.proxy(this.handlers.listViewScrollHandler,this)()},bindElements:function(){this.bindInViewTrackerEvents(),this._bindViewHistoryTrackingEvents()},handlers:{recalculateInViewEntries:function(){var e=f,n=i.PageController.getWindowEffectiveScrollTop(),o=n+t(window).height();e._lastScrolledTop=n;var s=i.CacheController,r=s.getEntryHandler(),a=r.getEntryList();a&&0!=a.length&&!s.isUpdateNeeded(s.keys.ENTRY_LIST)||(s.parseEntryInfo(),a=r.getEntryList());for(var l=[],c=[],u=0;u<a.length;u++){var h=a[u],_=r.getEntryInfoForKey(h,"offset").top-i.PageController._topStickyElementHeight,g=r.getEntryInfoForKey(h,"outerHeight");_<o&&_+g>n&&(l.push(h),_+g>=n+e._focusMinimumInViewPortion&&_+e._focusMinimumInViewPortion<=o&&c.push(h))}e._updateEntriesInView(l),e._updateEntriesInViewFocus(c),!d.default.isPostPage()&&i.PageController.getScrollAutoPlayMp4State()>0&&e.scrollAutoPlayGifHandler(c)},listViewScrollHandler:function(e){var t=this,n=i.PageController.getWindowEffectiveScrollTop();Math.abs(n-t._lastScrolledTop)>200&&t.handlers.recalculateInViewEntries()}},bindInViewTrackerEvents:function(){t(window).on("scroll resize",null,null,t.proxy(this.handlers.listViewScrollHandler,this)),t("body").on(this.customEvents.IN_FOCUS_SET,this.selectors.ENTRY_CONTAINER,null,t.proxy(function(e){var n=t(e.target),i=setTimeout(t.proxy(function(){t(n).trigger(t.Event(this.customEvents.ENTRY_READ))},this),this._entryReadTimeout);t(n).data("entry-read-timeout-object",i)},this)),t("body").on(this.customEvents.IN_FOCUS_UNSET,this.selectors.ENTRY_CONTAINER,null,t.proxy(function(e){var n=t(e.target);clearTimeout(t(n).data("entry-read-timeout-object"))},this))},scrollAutoPlayGifHandler:function(e){this._scrollAutoPlayGifTimeoutObject&&clearTimeout(this._scrollAutoPlayGifTimeoutObject);var n=setTimeout(t.proxy(function(){this.autoPlayFocusedVideos(e)},this),this._playGifTimeout);this._scrollAutoPlayGifTimeoutObject=n},autoPlayFocusedVideos:function(e){for(var n=[],o=i.CacheController,s=o.getEntryHandler(),r=i.PageController.getWindowEffectiveScrollTop(),a=t(window).scrollTop()+t(window).height(),l=i.PageController.getScrollAutoPlayMp4State(),c=-1,d=0;d<e.length;d++){var u=e[d],h=s.getEntryInfoForKey(u,"offset").top,f=h+s.getEntryInfoForKey(u,"outerHeight"),_=0;h<r&&f>a?_=a-r:h>r&&f<a?_=f-h:h<r&&f>r?_=f-r:h<a&&h>r&&(_=a-h);var g=_/(f-h);1==l?g>c&&(c=g,n=[u]):2==l&&this._scrollAutoPlayGifRatio<g&&n.push(u)}i.PostController.playVideosAndPauseOthersByEntryIds(n)},_updateEntriesInView:function(e){var t=f,n=t.selectors.IN_VIEW_CLASS;t._unsetEntriesInViewInFocus(n,e,!1),t._setEntriesInViewInFocus(n,e,!1)},_updateEntriesInViewFocus:function(e){var t=f,n=t.selectors.IN_FOCUS_CLASS;t._unsetEntriesInViewInFocus(n,e,!0),t._setEntriesInViewInFocus(n,e,!0)},_unsetEntriesInViewInFocus:function(e,n,i){var o=f;t("."+e).each(function(){var s=t(this).data("entry-id");t.inArray(s,n)<0&&(t(this).removeClass(e),i&&t(this).trigger(t.Event(o.customEvents.IN_FOCUS_UNSET)))})},_setEntriesInViewInFocus:function(e,n,i){for(var o=f,s=[],r=0;r<n.length;r++)s.push(o.selectors.ENTRY_CONTAINER_ID_PREFIX+n[r]);t(s.join(", ")).each(function(){t(this).addClass(e),!0===i&&t(this).trigger(t.Event(o.customEvents.IN_FOCUS_SET))})},findCurrentlyInViewEntries:function(){return t(this.selectors.IN_VIEW_ELEMENTS)},findCurrentlyInViewEntry:function(){return this.findCurrentlyInViewEntries().first()},findCurrentlyInFocusEntries:function(){return t(this.selectors.IN_FOCUS_ELEMENTS)},findCurrentlyInFocusEntry:function(){return this.findCurrentlyInFocusEntries().first()},scrollToNextEntry:function(e){void 0===e&&(e=this.findCurrentlyInViewEntry());var n=f,o=t(this.selectors.ENTRY_CONTAINER),s=o.index(e),r=s+1>=o.length?s:s+1,a=t(o[r]);if(s+1>=o.length){var c=l.default;if(c._loadedCount>=c._loadCountMax){var d=t(c.selectors.LOAD_MORE_BUTTON);d&&d.length>0&&d[0].click()}}a.offset()&&t("html,body").animate({scrollTop:a.offset().top-i.PageController._topStickyElementHeight},this._scrollDuration,"swing",function(){n.handlers.recalculateInViewEntries()})},scrollToPrevEntry:function(e){var n=f;if(void 0===e&&(e=this.findCurrentlyInViewEntry()),0!=t(window).scrollTop()&&e.offset()){var o=t(e),s=!1;if(Math.abs(e.offset().top-i.PageController.getWindowEffectiveScrollTop())<this._scrollFaultTolerance){var r=t(this.selectors.ENTRY_CONTAINER),a=r.index(e),l=a-1<0?0:a-1;o=t(r[l]),s=0==l}o.offset()&&t("html,body").animate({scrollTop:s?0:o.offset().top-i.PageController._topStickyElementHeight},this._scrollDuration,"swing",function(){n.handlers.recalculateInViewEntries()})}},_readIds:{},_readIdsBuffer:[],_readIdsBufferFlushThreshold:5,_bindViewHistoryTrackingEvents:function(){t("body").on(this.customEvents.ENTRY_READ,this.selectors.ENTRY_CONTAINER,null,t.proxy(function(e){var n=t(e.target),i=t(n).data("entry-id");if(!this._readIds[i]&&(this._readIds[i]=1,this._readIdsBuffer.push(i),this._readIdsBuffer.length>=this._readIdsBufferFlushThreshold)){var o={label:"",labelValue:"",platform:"d",entry:this._readIdsBuffer.join(","),view:"l"};h.default.uniqueViewed(o),this._readIdsBuffer=[]}},this))}});e.exports=f}).call(t,n(0),n(4))},function(e,t,n){"use strict";(function(t,i,o,s,r,a,l,c,d){function u(e){return e&&e.__esModule?e:{default:e}}var h=n(11),f=u(h),_=n(5),g=u(_),p=n(99),E=u(p),T=n(13),m=u(T),v=n(47),I=u(v),C=n(1),O=u(C),y=n(26),N=u(y),A=n(93),R=u(A),P=n(44),S=(u(P),n(45)),L=(u(S),n(35)),b=u(L),w=n(59),k=u(w),U=n(46),D=u(U),M=n(92),F=u(M),x=n(61),V=u(x),H=n(96),Y=u(H),B=n(135),K=u(B),G=t.extend({},new O.default,{docTitle:"",init:function(){this.showLocaleSections(),this.bindElements(),this.injectEntryImageOnError(),this.updateTimeZoneOffset(),this.updateSignUpReferrer(),this.showStickyButton(),this.loadAnimatedGif(),this.removeUnusedCookies(),this.docTitle=document.title},getUniqueDomId:function(e){for(var t;!t||document.getElementById(t);)t=(e||"jsid_dom")+"_"+parseInt(999999*Math.random(),10);return t},_toastFadeDuration:500,_showFooterNavAfter:600,_sidebarStickyElementMarginTop:20,_sidebarStickyHeight:0,_topVolatileElementHeight:0,_topStickyElementHeight:0,_autoCompleteMinLength:1,_autoCompleteMaxResult:10,_isNotificationShown:!1,_lastNotificationUpdateTs:!1,_isUpdatingNotification:!1,_isMarkingNotificationAsRead:!1,_notificationLoadCount:0,_CLASS_STICKY:"sticked",_CLASS_SHOW_BACK_TO_TOP:"show",_signUpReferrerCookieKey:"sign_up_referer",_safeModeCookieKey:"safemode",_stickyPromoteButtonCookieKey:"sticky_button",_dismissStickyPromoteButtonCookieKey:"dismiss_sticky",_syncAccountSessionCookieKey:"__ssid",_unusedCookies:["undefined"],_pageViewTracked:!1,selectors:{THEME_FILES:".badge-theme-file",FOOTER_NAV:"a.badge-scroll-to-top",SCROLL_TO_TOP:"a.badge-scroll-to-top",HEADER_TOP_NAV:".badge-sticky-nav",HEADER_TOP_BANNER:".badge-volatile-banner",HEADER_USER_FUNCTION_PLACEHOLDER:".badge-user-function-placeholder",HEADER_USER_FUNCTION:"#jsid-user-function",HEADER_VISITOR_FUNCTION:"#jsid-visitor-function",HEADER_USER_MENU:"#jsid-header-user-menu",HEADER_USER_ITEM:"#jsid-header-user-menu-items",HEADER_BANNER_CONFIRM_EMAIL:"#jsid-banner-confirm-email",HEADER_BANNER_CONFIRM_EMAIL_USERNAME:"#jsid-banner-confirm-email-username",HEADER_FUNNY_MENU:"#jsid-header-funny-menu",HEADER_FUNNY_ITEM:"#jsid-header-funny-menu-items",HEADER_NOTIFICATION_MENU:"#jsid-header-notification-menu",HEADER_NOTIFICATION_UNREAD_COUNT:"#jsid-notification-unread-count",HEADER_NOTIFICATION_ITEM:"#jsid-header-notification-items",HEADER_NOTIFICATION_CONTAINER:"#jsid-header-notification-items-container",HEADER_NOTIFICATION_SEE_ALL:"#jsid-header-notification-see-all",HEADER_UPLOAD_BTN:"#jsid-upload-btn",HEADER_SEARCH_BTN:"#jsid-header-search-btn",HEADER_SEARCH_DROPDOWN:"#jsid-header-search-dropdown",HEADER_SEARCH:".badge-header-search",HEADER_SEARCH_INPUT:"#jsid-search-input",HEADER_SEARCH_SUGGEST:"#jsid-headbar-search-suggest",HEADER_TOAST:".badge-toast-container",HEADER_TOAST_MESSAGE:".badge-toast-message",HEADER_TOAST_CLOSE:".badge-toast-close",NOTIFICATION_LIST_ITEMS:".badge-notification-item",SUBNAV_STICKY_STATIC:".badge-sticky-subnav-static",CONTAINTER:"#container",PAGE:".badge-page",CLICK_EVENT_SELECTOR:".badge-evt, .badge-track",CLICK_EVENT_NOFOLLOW_SELECTOR:".badge-track-no-follow",STICKY_BUTTON:".badge-sticky-button"},isSafari:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},onScroll:function(){this.checkFooterNavElements()},bindElements:function(){this.calculateHeights(),this.bindStickyNav(),this.bindFooterNavElements(),this.bindUploadElements(),this.bindUserSettingElements(),this.bindGroupElements(),this.bindSearchElements(),this.bindToastElements(),this.bindEventTracking(),this.bindPopupMenu(),this.bindNotificationItem()},calculateHeights:function(){var e=this;this._topStickyElementHeight=t(this.selectors.HEADER_TOP_NAV).height(),this._topVolatileElementHeight=0,t(this.selectors.HEADER_TOP_BANNER).each(function(){t(this).hasClass("hide")||(e._topVolatileElementHeight+=t(this).height())})},bindSearchElements:function(){var e=t(this.selectors.HEADER_SEARCH_BTN),n=t(this.selectors.HEADER_SEARCH_INPUT);if(e.click(t.proxy(function(e){e.stopPropagation();var t=this.toggleMenu(this.selectors.HEADER_SEARCH_DROPDOWN);this.hidePopupMenu(t?this.selectors.HEADER_SEARCH_DROPDOWN:null),t&&n.attr("placeholder",n.data("placeholder")).focus()},this)),n.length){var i={appendTo:this.selectors.HEADER_SEARCH_SUGGEST,menuClass:""};this.loadAutoComplete(this.selectors.HEADER_SEARCH_INPUT,i)}},loadAutoComplete:function(e,n){var s=this,r=(0,K.default)(i.get("configs.algolia.appId"),i.get("configs.algolia.apiKey")),a=i.get("configs.algolia.searchIndex"),l=i.get("configs.algolia.minSuggestCount"),c={appendTo:void 0===n.appendTo?"":n.appendTo,minLength:void 0===n.minLength?this._autoCompleteMinLength:n.minLength,maxResult:void 0===n.maxResult?this._autoCompleteMaxResult:n.maxResult,menuClass:void 0===n.menuClass?"":n.menuClass};t(e).autocomplete({source:function(e,n){r.initIndex(a).searchForFacetValues({facetName:"tags",facetQuery:e.term,highlightPreTag:"<strong>",highlightPostTag:"</strong>",maxFacetHits:c.maxResult}).then(function(e){n(e.facetHits.filter(function(e){return e.count>l})),t(".ui-helper-hidden-accessible").addClass("hide"),t(s.selectors.HEADER_SEARCH_SUGGEST).find("ul").first().removeAttr("style")})},delay:50,minLength:c.minLength,appendTo:c.appendTo,open:function(){t(".ui-autocomplete").removeAttr("class").addClass(c.menuClass).removeAttr("style"),t(".ui-helper-hidden-accessible").addClass("hide")},select:function(e,t){var n=t.item,i=n.value;window.location.href=o.getTagUrl(i,"search")}}).data("ui-autocomplete")._renderItem=function(e,n){return t("<li></li>").data("ui-autocomplete-item",n).append('<a><span class="suggested">'+n.highlighted+'</span><span class="count">'+n.count+"</span></a>").appendTo(e)}},toggleMenu:function(e){return!t(e).toggleClass("hide").hasClass("hide")},showMenu:function(e){t(e).removeClass("hide")},hideMenu:function(e){t(e).addClass("hide")},bindStickyNav:function(){g.default.isPostPage()||t(window).scroll(t.proxy(function(){var e=t(this.selectors.HEADER_TOP_NAV);t(this.selectors.SUBNAV_STICKY_STATIC).height(e.height()+0),t(window).scrollTop()>this._topVolatileElementHeight&&!e.hasClass(this._CLASS_STICKY)?(e.css({top:0,position:"fixed","z-index":13}),e.addClass(this._CLASS_STICKY)):t(window).scrollTop()<=this._topVolatileElementHeight&&e.hasClass(this._CLASS_STICKY)&&(e.removeClass(this._CLASS_STICKY),e.removeAttr("style"))},this))},bindUserSettingElements:function(){t(this.selectors.HEADER_USER_MENU+", "+this.selectors.HEADER_USER_ITEM).click(t.proxy(function(e){e.stopPropagation();var t=this.toggleMenu(this.selectors.HEADER_USER_ITEM);this.hidePopupMenu(t?this.selectors.HEADER_USER_ITEM:null)},this))},hidePopupMenu:function(e){var n=[this.selectors.HEADER_FUNNY_ITEM,this.selectors.HEADER_USER_ITEM,this.selectors.HEADER_NOTIFICATION_ITEM,this.selectors.HEADER_SEARCH_DROPDOWN],i={};i[this.selectors.HEADER_FUNNY_ITEM]=this.selectors.HEADER_FUNNY_MENU,i[this.selectors.HEADER_USER_ITEM]=this.selectors.HEADER_USER_MENU,i[this.selectors.HEADER_NOTIFICATION_ITEM]=this.selectors.HEADER_NOTIFICATION_MENU,i[this.selectors.HEADER_SEARCH_DROPDOWN]=this.selectors.HEADER_SEARCH_BTN,e!=this.selectors.HEADER_NOTIFICATION_ITEM&&(this._isNotificationShown=!1),n=t.grep(n,function(t){return t!=e}),t(n.join(",")).addClass("hide");for(var o in i){var s=i[o],r="";switch(o){case this.selectors.HEADER_USER_ITEM:case this.selectors.HEADER_NOTIFICATION_ITEM:r="selected",s+=" a";break;case this.selectors.HEADER_FUNNY_ITEM:case this.selectors.HEADER_SEARCH_DROPDOWN:r="selected"}o!=e?t(s).removeClass("selected"):t(s).addClass(r)}},bindPopupMenu:function(){t("body").on("click",t.proxy(function(e){(e.ctrlKey||e.metaKey)&&t(e.target).parents(this.selectors.HEADER_NOTIFICATION_ITEM).length>0?this.hidePopupMenu(this.selectors.HEADER_NOTIFICATION_ITEM):t(e.target).parents(this.selectors.HEADER_FUNNY_ITEM).length>0?this.hidePopupMenu(this.selectors.HEADER_FUNNY_ITEM):t(e.target).parents(this.selectors.HEADER_SEARCH_DROPDOWN).length>0?this.hidePopupMenu(this.selectors.HEADER_SEARCH_DROPDOWN):this.hidePopupMenu(),s.PostController.hideListEntryMenus(),V.default.showProfileMoreMenuItems(!1)},this))},bindGroupElements:function(){t(this.selectors.HEADER_FUNNY_MENU).click(t.proxy(function(e){e.stopPropagation();var t=this.toggleMenu(this.selectors.HEADER_FUNNY_ITEM);this.hidePopupMenu(t?this.selectors.HEADER_FUNNY_ITEM:null)},this)),t(this.selectors.HEADER_FUNNY_MENU+", "+this.selectors.HEADER_FUNNY_ITEM).hover(t.proxy(function(e){e.stopPropagation();var t="mouseenter"==e.type;t&&this.showMenu(this.selectors.HEADER_FUNNY_ITEM),this.hidePopupMenu(t?this.selectors.HEADER_FUNNY_ITEM:null)},this))},bindNotificationElements:function(){var e=this;t(this.selectors.HEADER_NOTIFICATION_ITEM).on("click",this.selectors.CLICK_EVENT_SELECTOR,t.proxy(this._handelClickEventTracking,this)),this.bindNotificationScrollbar(),this.getNotifications(),t(document).click(t.proxy(function(n){e._isNotificationShown&&(e._isNotificationShown=!e._isNotificationShown,(n.ctrlKey||n.metaKey)&&t(n.target).parents(this.selectors.HEADER_NOTIFICATION_ITEM).length>0||(this.hideMenu(this.selectors.HEADER_NOTIFICATION_ITEM),t(this.selectors.HEADER_NOTIFICATION_MENU).removeClass("menu"),t(this.selectors.HEADER_NOTIFICATION_MENU+" a").removeClass("selected")))},this)),t(this.selectors.HEADER_NOTIFICATION_MENU).click(t.proxy(function(n){n.stopPropagation(),n.preventDefault(),e._isNotificationShown?(this.hideMenu(this.selectors.HEADER_NOTIFICATION_ITEM),t(this.selectors.HEADER_NOTIFICATION_MENU).removeClass("menu"),t(this.selectors.HEADER_NOTIFICATION_MENU+" a").removeClass("selected"),this._handelClickEventTracking(n)):(this.showMenu(this.selectors.HEADER_NOTIFICATION_ITEM),t(this.selectors.HEADER_NOTIFICATION_MENU).addClass("menu"),t(this.selectors.HEADER_NOTIFICATION_MENU+" a").addClass("selected"),t(this.selectors.HEADER_NOTIFICATION_UNREAD_COUNT).removeClass("new"),t(this.selectors.HEADER_NOTIFICATION_UNREAD_COUNT).text(""),e.bindNotificationScrollbar(),e.markNotificationsAsRead(),this._handelClickEventTracking(n),this.hidePopupMenu(this.selectors.HEADER_NOTIFICATION_ITEM)),e._isNotificationShown=!e._isNotificationShown},this)),t(this.selectors.NOTIFICATION_LIST_ITEMS).click(t.proxy(function(e){var n=t(e.currentTarget),i=t(n).attr("data-url"),o=t(n).attr("data-type");r.track("Noti","TapLink","","",{Type:o,ObjectUrl:i})},this))},bindNotificationScrollbar:function(){var e=this;t(this.selectors.HEADER_NOTIFICATION_ITEM).data("plugin_tinyscrollbar")?t(this.selectors.HEADER_NOTIFICATION_ITEM).data("plugin_tinyscrollbar").update("relative"):(t(this.selectors.HEADER_NOTIFICATION_ITEM).tinyscrollbar({invertscroll:!0}),t(this.selectors.HEADER_NOTIFICATION_ITEM).bind("move",function(){e.bindNotificationLoadMore()}))},bindNotificationLoadMore:function(){var e=t(this.selectors.HEADER_NOTIFICATION_ITEM).data("plugin_tinyscrollbar"),n=e.contentPosition+e.viewportSize,i=.9*e.contentSize,o=t(this.selectors.HEADER_NOTIFICATION_CONTAINER);!o.data("didEndOfList")&&!this._isUpdatingNotification&&n>=i&&(r.track("Noti","LoadNotiMenuList",g.default.getPageKey(),"",{LoadedCount:++this._notificationLoadCount}),this.getNotifications(o.data("nextKey")))},bindUploadElements:function(){t(this.selectors.HEADER_UPLOAD_BTN).on("click",function(e){e.preventDefault(),N.default.showOverlay(N.default.selectors.OVERLAY_COMPONENT_UPLOAD,!1),D.default.showUploadStep(D.default.selectors.UPLOAD_FILE_STEP)})},bindFooterNavElements:function(){t(this.selectors.SCROLL_TO_TOP).on("click",function(e){e.preventDefault(),k.default.scrollToTop()})},checkFooterNavElements:function(){var e=t(window).scrollTop();e>this._showFooterNavAfter&&!t(this.selectors.FOOTER_NAV).hasClass(this._CLASS_SHOW_BACK_TO_TOP)?t(this.selectors.FOOTER_NAV).addClass(this._CLASS_SHOW_BACK_TO_TOP):e<=this._showFooterNavAfter&&t(this.selectors.FOOTER_NAV).hasClass(this._CLASS_SHOW_BACK_TO_TOP)&&t(this.selectors.FOOTER_NAV).removeClass(this._CLASS_SHOW_BACK_TO_TOP)},bindToastElements:function(){if(t(this.selectors.HEADER_TOAST).is(":hidden")){var e=E.default.getToast();a.isEmptyObject(e)||this.showToast(e.text,e.color,5e3)}},_trackGaEvent:function(e){var t=e.attr("data-evt");if(t){t+="";var n=t.split(","),i="",o="",s="",a="",l="";i=n.shift(),o=n.shift(),s=n.shift(),a=n.shift(),l=n.shift();var c={},d=e.attr("data-entry-id");d&&(c.PostKey=d);var u=e.attr("data-position");u&&(c.Position=u),l&&(c.Element=l),r.track(i,o,s,a,c)}},_trackEvent:function(e){var t=e.attr("data-track");if(t&&void 0!=t){t+="";var n=t.split(","),i=n.shift(),o=n.shift(),s=n.shift(),r=n.shift(),a=n.shift(),l=n.shift(),c=n.shift(),d={label:s,labelValue:r,platform:a,entry:l,view:c};I.default.event(i,o,d)}},_handelClickEventTracking:function(e){var n=t(e.currentTarget);this._trackGaEvent(n),this._trackEvent(n);var i=n.prop("tagName"),o=n.attr("href")+"",s=n.attr("target");if(!(n.is(this.selectors.CLICK_EVENT_NOFOLLOW_SELECTOR)||"A"!=i||0!==o.indexOf("http")&&0!==o.indexOf("/")||s)){e&&e.preventDefault();var r="window.location.href = '"+o+"';";window.setTimeout(r,100)}},bindEventTracking:function(){t(this.selectors.CONTAINTER).on("click",this.selectors.CLICK_EVENT_SELECTOR,t.proxy(this._handelClickEventTracking,this))},_cleanToastColor:function(e){e=t(e);for(var n=e.attr("class").split(/\s+/),i=0;i<n.length;i++)"toast-color-"==n[i].substr(0,12)&&e.removeClass(n[i])},setPageTitle:function(e){this.docTitle=e;var t=R.default.unreadCount,n=t>0?"("+t+") ":"";document.title=n+e},setPageTitleWithSpecialChars:function(e){var t=document.createElement("div");t.innerHTML=e,this.setPageTitle(t.firstChild.nodeValue)},refreshPageTitle:function(){this.setPageTitle(this.docTitle)},getWindowEffectiveScrollTop:function(){return t(window).scrollTop()<this._topVolatileElementHeight?this._topVolatileElementHeight+this._topStickyElementHeight:t(window).scrollTop()+this._topStickyElementHeight},scrollToTop:function(){t("html, body").animate({scrollTop:0},300)},ensureLoggedIn:function(e){return!!m.default.isLoggedIn()||(b.default.presentSignupForm(e),!1)},isMp4AutoPlay:function(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t="undefined"!=typeof InstallTrigger,n=!!window.chrome&&!e,i=!!document.documentMode,o=navigator.userAgent.toLowerCase(),s=o.indexOf("android")>-1;o.indexOf("android")>-1&&o.indexOf("mobile"),navigator.userAgent.match(/iPad/i),null!=navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i);return!(!n||s)||(!!t||(!!this.isSafari()||(!!i||!!e)))},getScrollAutoPlayMp4State:function(){var e=!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,t="undefined"!=typeof InstallTrigger,n=!!window.chrome&&!e,i=!!document.documentMode,o=navigator.userAgent.toLowerCase(),s=o.indexOf("android")>-1,r=(o.indexOf("android")>-1&&o.indexOf("mobile"),null!=navigator.userAgent.match(/iPad/i)),a=null!=navigator.userAgent.match(/iPhone/i)||null!=navigator.userAgent.match(/iPod/i);return r||a||s?0:this.isSafari()?1:n&&!s?2:t?2:i?2:e?2:0},isSafeModeEnabled:function(){return"0"!==t.cookie(this._safeModeCookieKey)},loadAnimatedGif:function(){g.default.isPostPage()&&this.isMp4AutoPlay()?t(s.PostController.selectors.ENTRY_ANIMATED_COVER).each(function(){t(this).hasClass("badge-auto-clicked")||(t(this).trigger("click",{auto_action:!0}),t(this).addClass("badge-auto-clicked"))}):t(s.PostController.selectors.ENTRY_ANIMATED_PLAY_BUTTON).each(function(){t(this).hasClass("badge-auto-clicked")||(t(this).removeClass("hide"),t(this).addClass("badge-auto-clicked"))})},showConfirmEmailBanner:function(e){t(this.selectors.HEADER_BANNER_CONFIRM_EMAIL_USERNAME).text(e),t(this.selectors.HEADER_BANNER_CONFIRM_EMAIL).removeClass("hide"),this.calculateHeights()},showToast:function(e,n,i,o){var s=t(this.selectors.HEADER_TOAST);s.hide(),this._cleanToastColor(s),t(this.selectors.HEADER_TOAST).addClass("toast-color-"+n),t(this.selectors.HEADER_TOAST_MESSAGE).html(e),t(this.selectors.HEADER_TOAST_CLOSE).click(t.proxy(function(e){e.preventDefault(),this.hideToast()},this)),t(this.selectors.HEADER_TOAST).css("position",void 0==o?"absolute":o),t(this.selectors.HEADER_TOAST).fadeIn(this._toastFadeDuration),void 0!==i&&setTimeout(t.proxy(function(){this.hideToast()},this),i)},hideToast:function(){t(this.selectors.HEADER_TOAST).fadeOut(this._toastFadeDuration)},getNotifications:function(e){var n=this;if(!this._isUpdatingNotification){this._isUpdatingNotification=!0;var i='<li class="loading badge-notification-loader"><a class="btn spin">'+o.getSpinnerHtml()+"</a></li>";t(this.selectors.HEADER_NOTIFICATION_CONTAINER).append(i),this.bindNotificationScrollbar();var s={};R.default._lastBadgetTs||(s.includeReadState=1),e&&(s.refKey=e);t.ajax({url:"/notifications",data:s,dataType:"json",success:function(e){n._isUpdatingNotification=!1,n._lastNotificationUpdateTs=(new Date).getTime(),n.updateNotification(e),e["read-state"]&&R.default.getNsReadStateCb({status:"OK",payload:e["read-state"],error:""})},error:function(e){n._isUpdatingNotification=!1},complete:function(e){t(n.selectors.HEADER_NOTIFICATION_CONTAINER).find(".badge-notification-loader").remove(),n.bindNotificationScrollbar()}})}},markNotificationsAsRead:function(){var e=this;if(!this._isMarkingNotificationAsRead){this._isMarkingNotificationAsRead=!0;var n=Y.default.getReadStateUrl(),o=i.get("user.noti.read_state_params");t.ajax({url:n,data:o,dataType:"json",type:"POST",success:function(t){e._isMarkingNotificationAsRead=!1,"OK"==t.status&&R.default.updateNotificationUnreadCount(0)},error:function(t){e._isMarkingNotificationAsRead=!1}})}},markNotificationItemAsRead:function(e,n,i){t(e).data("markedRead")||t.ajax({url:"/notifications/mark-item",data:{actionType:n,objectId:i,state:1},dataType:"json",type:"POST",success:function(n){"OK"==n.status&&t(e).data("markedRead",!0).removeClass("new")},error:function(e){}})},bindNotificationItem:function(){var e=this,n=this.selectors.HEADER_NOTIFICATION_CONTAINER+","+F.default.selectors.NOTIFICATION_LIST;t(n).on("click",".badge-unread-notification-item",function(){e.markNotificationItemAsRead(this,t(this).data("actiontype"),t(this).data("objectid"))})},updateNotification:function(e){var n=t(this.selectors.HEADER_NOTIFICATION_CONTAINER);if(n.find(".empty").remove(),"OK"==e.status)if(e.items.length>0){for(var i=0;i<e.items.length;i++)n.append(e.items[i].message);R.default.unreadCount>20?t(this.selectors.HEADER_NOTIFICATION_SEE_ALL).text("See "+(R.default.unreadCount-20)+" more"):t(this.selectors.HEADER_NOTIFICATION_SEE_ALL).text("See all"),n.data("didEndOfList",e.didEndOfList),n.data("nextKey",e.nextKey)}else 0==n.find(".badge-evt").length&&n.append(e.message),n.data("didEndOfList",1);else n.append(e.message),n.data("didEndOfList",1);this.bindNotificationScrollbar()},updateTimeZoneOffset:function(){var e=(new Date).getTimezoneOffset()/-60;t.cookie("gag_tz",e,{domain:i.get("page.cookie_domain"),expires:365,path:"/"})},syncAccountSystemSession:function(){if(m.default.isLoggedIn()){var e=t.cookie(this._syncAccountSessionCookieKey);if(e<=0)return;var n=i.get("user.acs_url");if(n){(new Image).src=n,t.cookie(this._syncAccountSessionCookieKey,e-1,{domain:i.get("page.cookie_domain"),expires:1,path:"/"})}}},trackPageView:function(){if(!this._pageViewTracked){var e=m.default.getAccountId();e>0&&l.setUserId(e),l.trackPageView(),this._pageViewTracked=!0}},removeUnusedCookies:function(){t.each(this._unusedCookies,function(e,n){t.cookie(n,0,{expires:-1,path:"/"})})},initUserFunction:function(){t(this.selectors.HEADER_USER_FUNCTION_PLACEHOLDER).addClass("hide"),m.default.isLoggedIn()?(t(this.selectors.HEADER_USER_FUNCTION).hasClass("hide")&&this.bindNotificationElements(),t(this.selectors.HEADER_VISITOR_FUNCTION).addClass("hide"),t(this.selectors.HEADER_USER_FUNCTION).removeClass("hide")):(t(this.selectors.HEADER_USER_FUNCTION).addClass("hide"),t(this.selectors.HEADER_VISITOR_FUNCTION).removeClass("hide")),s.PostController.renderPendingComment(),this.syncAccountSystemSession(),this.trackPageView()},updateSignUpReferrer:function(){m.default.isLoggedIn()||null!=t.cookie(this._signUpReferrerCookieKey)||t.cookie(this._signUpReferrerCookieKey,document.referrer,{domain:i.get("page.cookie_domain"),expires:365,path:"/"})},showStickyButton:function(){if(t.cookie(this._dismissStickyPromoteButtonCookieKey))return!1;this.updateStickyCookie();var e=i.get("sticky.buttons"),n=new Date,o={},s=9999999999999,r="",a=c.getStore();a.getItem(this._stickyPromoteButtonCookieKey)&&(o=JSON.parse(a.getItem(this._stickyPromoteButtonCookieKey))),t.each(o,function(e,t){t>n.getTime()&&t<s&&(s=t,r=e)}),e.forEach(function(e){t(".badge-sticky-button").hasClass("hide")&&e[1]==r&&(t(".badge-sticky-button").html('<a href="'+e[1]+'" target="_blank" style="font-weight:bold;color:#ffffff;" onclick="GAG.GA.track(\'StickyPromote\', \'TapLink\', \''+g.default.getPageKey()+"', '', {Url : '"+e[1]+"'});\">"+e[0]+'</a><a class="btn-close badge-toast-close" href="javascript:void(0);" data-sticky="'+e[1]+'" style="padding-left:5px;color:#ffffff;"></a>'),t(".badge-sticky-button .badge-toast-close").click(function(){G.dismissSticky(t(this).data("sticky"))}),t(".badge-sticky-button").removeClass("hide"))})},updateStickyCookie:function(){var e=i.get("sticky.buttons"),n=new Date,o=new Date,s={},r={},a="",l=n.getTime(),d=c.getStore();d.getItem(this._stickyPromoteButtonCookieKey)?(s=JSON.parse(d.getItem(this._stickyPromoteButtonCookieKey)),t.each(s,function(i){t.each(e,function(e,t){i==t[1]&&s[i]>n.getTime()&&(r[i]=s[i],s[i]>l&&(l=s[i]))})}),e.forEach(function(e){(a=e[1])in s||(o.setTime(l+60*e[2]*60*1e3),r[a]=o.getTime(),l=o.getTime())})):e.forEach(function(e){a=e[1],o.setTime(o.getTime()+60*e[2]*60*1e3),r[a]=o.getTime()}),d.setItem(this._stickyPromoteButtonCookieKey,(0,f.default)(r))},dismissSticky:function(e){t(".badge-sticky-button").addClass("hide");var n=i.get("sticky.dismiss"),o=i.get("sticky.noAd"),s={},a=new Date;a.setTime(a.getTime()+60*o*60*1e3),t.cookie(this._dismissStickyPromoteButtonCookieKey,1,{domain:i.get("page.cookie_domain"),expires:a,path:"/"}),r.track("StickyPromote","Dismiss","","",{Url:e});var l=c.getStore();l.getItem(this._stickyPromoteButtonCookieKey)&&(s=JSON.parse(l.getItem(this._stickyPromoteButtonCookieKey))),t.each(s,function(t){s[t]+=t==e?60*(o+n)*60*1e3:60*o*60*1e3}),l.setItem(this._stickyPromoteButtonCookieKey,(0,f.default)(s))},injectEntryImageOnError:function(){var e=t(s.PostController.selectors.ENTRY_CONTAINER),n=e.find(".badge-item-img");t(n).one("error",function(){var e=t(this).attr("src");I.default.downloadFail(e)})},onRecaptchaLoaded:function(){for(var e=0;e<5;e++)setTimeout(function(){var e=t(".badge-g-recaptcha");t.each(e,function(e,n){t(n).html().length||grecaptcha.render(n,{sitekey:i.get("configs.captchaPublicKey")})})},1e3*e)},showLocaleSections:function(){t(this.selectors.HEADER_FUNNY_ITEM).find("li").each(function(){var e=t(this).data("locales");"string"==typeof e&&(e=e.split(","),e.length>0&&d.isMatchAnyLocales(e)&&t(this).removeClass("hide"))})},tabVisibilityChange:function(){var e,t,n={hidden:"visibilitychange",webkitHidden:"webkitvisibilitychange",mozHidden:"mozvisibilitychange",msHidden:"msvisibilitychange"};for(e in n)if(e in document){t=n[e];break}return function(n){return n&&document.addEventListener(t,n),!document[e]}}()});window.onCaptchaLoadedCallback=G.onRecaptchaLoaded,e.exports=G}).call(t,n(0),n(3),n(12),n(4),n(8),n(0),n(18),n(57),n(90))},function(e,t,n){"use strict";(function(t,i,o,s,r,a,l,c,d,u){function h(e){return e&&e.__esModule?e:{default:e}}var f=n(1),_=h(f),g=n(26),p=h(g),E=n(44),T=h(E),m=n(45),v=h(m),I=n(35),C=h(I),O=n(59),y=h(O),N=n(5),A=h(N),R=n(47),P=h(R),S=n(100),L=h(S),b=n(186),w=h(b),k=n(64),U=h(k),D=n(63),M=(h(D),n(13)),F=h(M),x=t.extend({},new _.default,{_entryStickyElementMarginTop:20,_entryStickyElementMarginTopProfile:20,_reportInProgress:!1,_voteUp:"up",_voteDown:"down",_fastInitLoad:!0,_domReady:!1,_commentInited:!1,CLASS_STICKY:"sticked",init:function(){this._domReady=!0,this.bindElements(),this.trackPostUV()},availableCallbacks:["postWillArchive","postDidArchive","postWillRestore","postDidRestore"],selectors:{CONTAINER:"div#container",ENTRY_CONTAINER:".badge-entry-container",ENTRY_CONTAINER_RAW:"badge-entry-container",ENTRY_ENTITY:".badge-entry-entity",ENTRY_ALBUM_ITEM_ENTITY:".badge-album-item-entity",ENTRY_STICKY_ELEMENTS:".badge-entry-sticky",ENTRY_STICKY_ELEMENTS_SHADOW:".badge-entry-sticky-shadow",ENTRY_TITLE:".badge-item-title",ENTRY_DESCRIPTION:".badge-item-description",ENTRY_TAGS:".badge-item-tags",ENTRY_IMG:".badge-item-img",ENTRY_LOVE_COUNT:".badge-item-love-count",ENTRY_COMMENT_COUNT:".badge-item-comment-count",ENTRY_FB_SHARE:".badge-facebook-share",ENTRY_FB_BOT_SHARE:".badge-facebook-bot-share",ENTRY_TW_SHARE:".badge-twitter-share",ENTRY_GPLUS_SHARE:".badge-gplus-share",ENTRY_PIN_SHARE:".badge-pinterest-share",ENTRY_PIN_BOTTOM_SHARE:".badge-pinterest-bottom-share",ENTRY_EMAIL_SHARE:".badge-email-share",ENTRY_NSFW_COVER:".badge-nsfw-entry-cover",ENTRY_VIDEO_CONTAINER:".badge-video-container",ENTRY_VIDEO_COVER:".badge-video-cover",ENTRY_YOUTUBE_VIDEO_PLACEHOLDER:".badge-youtube-video-placeholder",ENTRY_ANIMATED_COVER:".badge-animated-cover",ENTRY_ANIMATED_CONTAINER_ANIMATED:".badge-animated-container-animated",ENTRY_ANIMATED_VIDEO_PLAYER:"video",ENTRY_ANIMATED_CONTAINER_STATIC:".badge-animated-container-static",ENTRY_ANIMATED_SPINNER:".gif-spinner",ENTRY_ANIMATED_PLAY_BUTTON:".badge-gif-play",ENTRY_ANIMATED_PLAYING:"badge-gif-playing",ENTRY_NEXT_POST_ENTRY:".badge-next-post-entry",ENTRY_PREV_POST_ENTRY:".badge-prev-post-entry",ENTRY_POST_GRID_ENTRY:".badge-post-grid-entry",ENTRY_CONTENT:".badge-entry-content",ENTRY_INFO:".badge-entry-info",ENTRY_UPVOTE_BUTTON:".badge-item-vote-up",ENTRY_DOWNVOTE_BUTTON:".badge-item-vote-down",ENTRY_COMMENT_BUTTON:".badge-item-comment",ENTRY_VOTE_CONTAINER:".badge-item-vote-container",ENTRY_COMMENT_SYS:"#jsid-comment-sys",ENTRY_POST_ZOOM:".badge-post-zoom",ENTRY_POST_CONTAINER:".badge-post-container",LIST_ENTRY_BUTTONS_CONTAINER:".badge-list-entry-buttons",LIST_ENTRY_MORE_BUTTON:".badge-list-entry-more-button",LIST_ENTRY_MORE_ITEMS:".badge-list-entry-more-items",MODAL_POST_ZOOM_CONTAINER:"#jsid-modal-post-zoom",MODAL_REPORT_CONTAINER:".badge-overlay-report",ENTRY_REPORT:".badge-item-report",ENTRY_DELETE:".badge-item-delete",ENTRY_TOOLBAR_PRE:".badge-toolbar-pre",ENTRY_TOOLBAR_STICKY:".badge-entry-toolbar-sticky",ENTRY_TOOLBAR_BOTTOM:".badge-share-bar",FEATURED_SIDEBAR_BOTTOM_ADS:"#jsid-featured-sidebar-ad .img-container",VIDEO_SOUND_TOGGLE:".badge-video-sound-toggle",VIDEO_DURATION:".badge-video-duration"},bindElements:function(){this.bindVoteUpElements(),this.bindVoteDownElements(),this.bindEntryMenuElements(),this.bindCommentElements(),this.bindReportElements(),this.bindDeleteElements(),this.bindEntryCoverElements(),this.bindStickyEntryBars(),this.bindZoomElements(),this.bindFastElements()},_fastItems:null,_fastEntryIds:[],_fastCurrentEntryKey:null,_fastLastEntryKey:null,_fastForwardDirection:!0,_fastTriggerLoadThreshold:9,_fastPostGridSize:6,_fastTimer:null,_fastReloadAdsThreshold:5,_fastReloadAdsCount:1,_fastSkipBackward:[],_fastSkipForward:[],_fastForwardByButton:!1,initLoadFastEntries:function(){var e=i.get("data");this._fastCurrentEntryKey=t(this.selectors.ENTRY_ENTITY).data("entry-id"),e&&null!=e.fast_entries&&this.extractFastEntries(e.fast_entries)},getFastEntriesJson:function(e){var n="next";if(!this._fastForwardDirection)var n="prev";e=e+"?direction="+n+"&c=13",i.get("configs").from_section&&i.get("configs").section_url&&(e+="&sc="+i.get("configs").section_url),t.getJSON(e,null,t.proxy(this.extractFastEntries,this))},extractFastEntries:function(e){if(e.okay){null==this._fastItems?this._fastItems=e.items:t.extend(this._fastItems,e.items);var n=e.entryIds;this._fastForwardDirection||n.reverse();for(var i=0,o=0;o<n.length;o++)t.inArray(n[o],this._fastEntryIds)<0&&(this._fastForwardDirection?this._fastEntryIds.push(n[o]):this._fastEntryIds.unshift(n[o]),i++);var s=t.inArray(this._fastCurrentEntryKey,this._fastEntryIds);this.updatePrevNextButtons(s),n.length>0&&0==i&&(this._fastForwardDirection?this._fastSkipForward.push(e.entryIds[0]):this._fastSkipBackward.push(e.entryIds[0]))}},fastEntriesMapElements:function(e,t){if(null!=this._fastItems[e]){var n=this._fastItems[e];this.mapPostContent(n),this._fastReloadAdsCount>=this._fastReloadAdsThreshold?(v.default.reRenderAds(),this._fastReloadAdsCount=1):this._fastReloadAdsCount++}else window.location.href=t},bindFastElements:function(){A.default.isPostPage()&&(this.initLoadFastEntries(),t(this.selectors.CONTAINER).on("click",".badge-fast-entry",t.proxy(function(e){e.preventDefault();var n=t(e.currentTarget);if(!n.hasClass("disabled")){var i=n.data("entry-key"),r=n.attr("href"),a="";if(n.hasClass("badge-next-post-entry")?(a="NextPost",this._fastForwardDirection=!0):n.hasClass("badge-prev-post-entry")&&(a="PrevPost",this._fastForwardDirection=!1),this._fastLastEntryKey=this._fastCurrentEntryKey,this._fastCurrentEntryKey=i,this._fastForwardByButton=!0,r){this.fastEntriesMapElements(i,r);var l=t.inArray(this._fastCurrentEntryKey,this._fastEntryIds),c=this._fastTriggerLoadThreshold,d=this._fastEntryIds.length-this._fastTriggerLoadThreshold,u=t.makeArray(this._fastEntryIds);if(!this._fastForwardDirection&&l<=c){var h=u[1];t.inArray(h,this._fastSkipBackward)<0&&(r=this._fastItems[h].entryRelativeUrl,this.getFastEntriesJson(r))}else if(this._fastForwardDirection&&l>=d){var f=u[u.length-2];t.inArray(f,this._fastSkipForward)<0&&(r=this._fastItems[f].entryRelativeUrl,this.getFastEntriesJson(r))}a&&(o.track("PostAction",a,this._fastLastEntryKey),s.firePageviewCandidate());var _={label:"",labelValue:"",platform:"d",entry:i,view:"p"};P.default.uniqueViewed(_)}}},this)),A.default.isPostPage()&&(window.onpopstate=t.proxy(function(e){this.trackPostUV();var t=window.location.href,n=t.split("/");if(r.inArray("gag",n)>=0)if(this._fastInitLoad)this._fastInitLoad=!1;else{var i=n[r.inArray("gag",n)+1],o=window.location.hash&&window.location.hash.length>0;o||this.fastEntriesMapElements(i,t)}},this)))},updatePrevNextButtons:function(e){T.default.handlers.resetSidebarToTop(),this.handlers.resetEntryStickyToolbar();var n=this._fastItems[this._fastEntryIds[e+1]];t(this.selectors.ENTRY_NEXT_POST_ENTRY).removeData("entry-key"),void 0!==n?(t(this.selectors.ENTRY_NEXT_POST_ENTRY).removeClass("disabled"),t(this.selectors.ENTRY_NEXT_POST_ENTRY).data("entry-key",n.entryId),t(this.selectors.ENTRY_NEXT_POST_ENTRY).attr("href",n.entryRelativeUrl)):(t(this.selectors.ENTRY_NEXT_POST_ENTRY).addClass("disabled"),t(this.selectors.ENTRY_NEXT_POST_ENTRY).attr("href",""));var i=this._fastItems[this._fastEntryIds[e-1]];t(this.selectors.ENTRY_PREV_POST_ENTRY).removeData("entry-key"),void 0!==i?(t(this.selectors.ENTRY_PREV_POST_ENTRY).removeClass("disabled"),t(this.selectors.ENTRY_PREV_POST_ENTRY).data("entry-key",i.entryId),t(this.selectors.ENTRY_PREV_POST_ENTRY).attr("href",i.entryRelativeUrl)):(t(this.selectors.ENTRY_PREV_POST_ENTRY).addClass("disabled"),t(this.selectors.ENTRY_PREV_POST_ENTRY).attr("href",""))},mapPostContent:function(e){t("html, body").animate({scrollTop:0},0);var n=t(this.selectors.ENTRY_ENTITY),i=t.inArray(e.entryId,this._fastEntryIds);if(this._fastCurrentEntryKey=e.entryId.toString(),this._fastForwardByButton)this._fastLastEntryKey&&(this.replacePostUrl(this._fastLastEntryKey),this.updatePostUrl(this._fastCurrentEntryKey));else{for(var o=t.makeArray(this._fastEntryIds),s=0;s<o.length;s++)o[s]=o[s].toString();var r=n.data("entry-id").toString();this._fastForwardDirection=!(o.indexOf(r)>o.indexOf(this._fastCurrentEntryKey))}this._fastForwardByButton=!1,n.removeData("entry-id"),n.removeData("entry-url"),n.removeData("entry-votes"),n.removeData("entry-comments"),n.attr("id","jsid-entry-entity-"+e.entryId),n.attr("data-entry-id",e.entryId),n.data("entry-id",e.entryId),n.data("entry-url",e.entryUrl),n.data("entry-votes",e.votes),n.data("entry-comments",e.comments),t(this.selectors.ENTRY_TITLE).text(e.title),a.PageController.setPageTitleWithSpecialChars(e.pageTitle),t(this.selectors.ENTRY_DESCRIPTION).html(e.description),t(this.selectors.ENTRY_TAGS).html(e.tags);var d=t(this.selectors.ENTRY_LOVE_COUNT).parent().attr("id","love-count-"+e.entryId);t(this.selectors.ENTRY_LOVE_COUNT,d).text(l.formatNumber(e.votes)),t(this.selectors.ENTRY_COMMENT_COUNT).text(e.comments),t(this.selectors.ENTRY_TOOLBAR_STICKY).find(".badge-evt").attr("data-entry-id",e.entryId),t(this.selectors.ENTRY_TOOLBAR_BOTTOM).find(".badge-evt").attr("data-entry-id",e.entryId),t(this.selectors.ENTRY_CONTENT).html(e.entryContent),"video"===e.entryType&&this.renderYouTubeToPostView(),1==e.currentVote?this.handlers.likeHandler(e.entryId):-1==e.currentVote?this.handlers.dislikeHandler(e.entryId):this.handlers.unlikeHandler(e.entryId),c.getController("vote").process(),c.getController("vote").remoteHandler.processQueue(),"link"==e.entryType?t(this.selectors.ENTRY_CONTENT).addClass("with-button"):t(this.selectors.ENTRY_CONTENT).removeClass("with-button"),t(this.selectors.ENTRY_INFO).html(e.entryInfo),this.updatePrevNextButtons(i),t("link[rel=image_src]").attr("href",e.entryUrl),t("link[rel=canonical]").attr("href",e.entryUrl),t("meta[name=title]").attr("href",e.title),t(this.selectors.ENTRY_FB_SHARE).removeAttr("data-track").attr("data-track",e.fbTrack),t(this.selectors.ENTRY_FB_SHARE).removeAttr("data-evt").attr("data-evt",e.fbEvt),t(this.selectors.ENTRY_FB_SHARE).removeAttr("data-share").attr("data-share",e.fbShare),t(this.selectors.ENTRY_FB_BOT_SHARE).removeAttr("data-evt").attr("data-evt",e.fbBotEvt),t(this.selectors.ENTRY_TW_SHARE).removeAttr("data-track").attr("data-track",e.twTrack),t(this.selectors.ENTRY_TW_SHARE).removeAttr("data-evt").attr("data-evt",e.twEvt),t(this.selectors.ENTRY_TW_SHARE).removeAttr("data-title").attr("data-title",e.twTitle),t(this.selectors.ENTRY_TW_SHARE).removeAttr("data-share").attr("data-share",e.twShare),t(this.selectors.ENTRY_GPLUS_SHARE).removeAttr("data-track").attr("data-track",e.gPlusTrack),t(this.selectors.ENTRY_GPLUS_SHARE).removeAttr("data-evt").attr("data-evt",e.gPlusEvt),t(this.selectors.ENTRY_GPLUS_SHARE).removeAttr("data-share").attr("data-share",e.gPlusShare),t(this.selectors.ENTRY_PIN_SHARE).removeAttr("data-track").attr("data-track",e.pinTrack),t(this.selectors.ENTRY_PIN_SHARE).removeAttr("data-evt").attr("data-evt",e.pinEvt),t(this.selectors.ENTRY_PIN_SHARE).removeAttr("data-title").attr("data-title",e.pinTitle),t(this.selectors.ENTRY_PIN_SHARE).removeAttr("data-share").attr("data-share",e.pinShare),t(this.selectors.ENTRY_PIN_SHARE).removeAttr("data-img").attr("data-img",e.pinImg),t(this.selectors.ENTRY_PIN_BOTTOM_SHARE).removeAttr("data-evt").attr("data-evt",e.pinBottomShare),t(this.selectors.ENTRY_EMAIL_SHARE).attr("href",e.emailHref),t(this.selectors.ENTRY_EMAIL_SHARE).removeAttr("data-track").attr("data-track",e.emailTrack),t(this.selectors.ENTRY_EMAIL_SHARE).removeAttr("data-evt").attr("data-evt",e.emailEvt),t(this.selectors.ENTRY_REPORT).data("entry-id",e.entryId),t(this.selectors.LIST_ENTRY_MORE_BUTTON).data("entry-id",e.entryId),this.renderCommentElement(e.entryUri,e.entryId,e.commentOpClientId,e.commentOpSignature),"undefined"!=e.entryAdminMeta&&t("#jsid-admin-meta").html(e.entryAdminMeta),a.PageController.loadAnimatedGif(),a.TimedViewTrackingController.untrackAll(),a.TimedViewTrackingController.trackElements(t("#jsid-entry-entity-"+e.entryId))},renderPendingComment:function(){null!=window.pendingComment&&this.renderCommentElement(window.pendingComment.url,window.pendingComment.postKey,window.pendingComment.opClientId,window.pendingComment.opSignature)},renderCommentElement:function(e,n,s,r){var l=i.get("user.comment_auth")||"";if((this._currentEntryUri!=e||this._currentAuth!=l)&&(window.pendingComment.url=e,window.pendingComment.postKey=n,window.pendingComment.opClientId=s,window.pendingComment.opSignature=r,window.pendingComment.auth=l,window.pendingComment.loginUrl="https://"+i.get("page.domain")+"/login?next="+encodeURIComponent(window.location.href.split(/[?#]/)[0])+"#comment",this._currentCommentOptions=window.pendingComment,this._currentEntryUri=e,this._currentAuth=l,t(".badge-comment").removeAttr("data-href").attr("data-href",e),window.CS3.init(this._currentCommentOptions),window.CS3.registerCommentReportPromiseProvider&&window.CS3.registerCommentReportPromiseProvider(a.ReportController.getReportOverlayPromiseForComment),t(".badge-comment").show(),t(this.selectors.CONTAINER).one("mouseenter",this.selectors.ENTRY_COMMENT_SYS,null,t.proxy(function(e){o.track("CommentAction","OpenComment","")},this)),!this._commentInited)){var c=window.location.hash;c&&c.length>0&&-1!==c.indexOf("comment")&&this.scrollToComment(),this._commentInited=!0}},handlers:{likeHandler:function(e){a.PostController.handlers.loveHandler(e,1)},dislikeHandler:function(e){a.PostController.handlers.loveHandler(e,-1)},unlikeHandler:function(e){a.PostController.handlers.loveHandler(e,0)},loveHandler:function(e,n){var i=t("#jsid-entry-entity-"+e),o=i.find(a.PostController.selectors.ENTRY_VOTE_CONTAINER),s=i.find(a.PostController.selectors.ENTRY_DOWNVOTE_BUTTON),r=i.find(a.PostController.selectors.ENTRY_UPVOTE_BUTTON);o.removeClass(a.PostController._voteDown),o.removeClass(a.PostController._voteUp),s.removeClass("active"),r.removeClass("active"),n>0?(o.addClass(a.PostController._voteUp),r.addClass("active")):n<0&&(o.addClass(a.PostController._voteDown),s.addClass("active")),a.PostController.updateFastItem(e,"currentVote",n)},reportHandler:function(e){if(!F.default.isLoggedIn())return e.preventDefault(),void C.default.presentSignupForm();var n=t(e.currentTarget).data("entry-id");a.ReportController.showReportOverlay({type:a.ReportController.types.POST,objectId:n})},deleteHandler:function(e){if(!F.default.isLoggedIn())return e.preventDefault(),void C.default.presentSignupForm();var n=t(e.currentTarget).data("entry-id"),i=t(e.currentTarget).data("message");confirm(i)&&w.default.deleteEntry(n)},resetEntryStickyToolbar:function(){var e=a.PostController,n=t(e.selectors.ENTRY_TOOLBAR_STICKY);n&&n.length>0&&(n.css({position:"","z-index":"",top:""}),n.removeClass("sticked"))},entryStickyToolbarHandler:function(){var e=a.PostController,n=t(window).scrollTop(),i=(t(window).height(),t(e.selectors.ENTRY_CONTAINER)),o=i.find(e.selectors.ENTRY_TOOLBAR_PRE),s=i.find(e.selectors.ENTRY_TOOLBAR_STICKY);if(s&&s.length>0){var r=o.offset().top,l=s.height(),c=(s.height(),t(e.selectors.ENTRY_POST_CONTAINER)),d=c.offset().top+c.height()-l-20;n<r&&s.hasClass("sticked")?e.handlers.resetEntryStickyToolbar():n>=r&&n<=d&&!s.hasClass("sticked")&&(s.css({position:"fixed","z-index":"13",top:"0"}),s.addClass("sticked"))}},entryStickElementHandler:function(e){var n=a.PostController,i=a.CacheController,o=a.ListController,s=t(window).scrollTop(),r=t(window).height(),l=i.getEntryHandler(),c=l.getEntryList();c&&0!=c.length&&!i.isUpdateNeeded(i.keys.ENTRY_LIST)||(i.parseEntryInfo(),c=l.getEntryList(),i.notifyForCacheUpdateCompleted(i.keys.ENTRY_LIST));for(var d=[],u=0;u<c.length;u++){var h=c[u],f=l.getEntryInfoForKey(h,"height"),_=l.getEntryInfoForKey(h,"offset"),g=_.top;if(_.top+f>=s-r-f&&g<=s+r+f){var p=t(o.selectors.ENTRY_CONTAINER_ID_PREFIX+h),E=p.find(n.selectors.ENTRY_STICKY_ELEMENTS_SHADOW),T=p.find(n.selectors.ENTRY_STICKY_ELEMENTS);if(E&&E.length>0&&T&&T.length>0){var m=E.offset().top,v=T.height()||T.outerHeight();if(m-n._entryStickyElementMarginTop>=a.PageController.getWindowEffectiveScrollTop())T.css({position:"relative","z-index":11,top:""}),T.removeClass(n.CLASS_STICKY);else if(m-n._entryStickyElementMarginTop<a.PageController.getWindowEffectiveScrollTop()&&g+f+parseFloat(p.css("paddingTop"))-v-n._entryStickyElementMarginTop>a.PageController.getWindowEffectiveScrollTop()){var I=a.PageController._topStickyElementHeight+n._entryStickyElementMarginTop+"px";T.css({position:"fixed","z-index":12,top:I}),T.addClass(n.CLASS_STICKY),d.push(h)}else{var I=f+parseFloat(p.css("paddingTop"))-(m-g)-v+"px";T.css({position:"relative","z-index":12,top:I}),T.removeClass(n.CLASS_STICKY)}}}}var C=i.getValue("entrySticked");if(C&&C.length>0)for(var u=0;u<C.length;u++)if(t.inArray(C[u],d)<0){var h=C[u],p=t(o.selectors.ENTRY_CONTAINER_ID_PREFIX+h),T=p.find(n.selectors.ENTRY_STICKY_ELEMENTS);T.hasClass(n.CLASS_STICKY)&&(T.css({position:"","z-index":"",top:""}),T.removeClass(n.CLASS_STICKY),needUpdate=!0)}i.setValue("entrySticked",d)},onVideoTimeUpdateHandler:function(e){var n=e.target;if(n){var i=t(n).closest(this.selectors.ENTRY_ENTITY).data("entry-id");d.onVideoTimeUpdate({key:i,domId:"jsid-entry-entity-"+i},!n.paused,n.currentTime,n.duration,0)}}},onVoteUp:function(e){var n=t(e.currentTarget),i=n.closest(this.selectors.ENTRY_ENTITY).data("entry-id"),o=n.closest(this.selectors.ENTRY_ENTITY).data("entry-url"),s=n.closest(this.selectors.ENTRY_VOTE_CONTAINER);if(a.PageController.ensureLoggedIn(o)){var r=s.hasClass(this._voteUp)||n.hasClass("up active");(s.hasClass(this._voteDown)||n.hasClass("down active"))&&this.addLoveCount(i);var l={};r?(L.default.unlike(i,function(){},function(){}),this.minusLoveCount(i),this.handlers.unlikeHandler(i),l[i]=0,A.default.isPostPage()?u.trackEvent("PostAction","UnvotePost",i):u.trackEvent("PostList","UnvotePost",A.default.getPageKey(),"",{PostKey:i})):(L.default.like(i,function(){},function(){}),this.addLoveCount(i),this.handlers.likeHandler(i),l[i]=1,A.default.isPostPage()?u.trackEvent("PostAction","UpvotePost",i):u.trackEvent("PostList","UpvotePost",A.default.getPageKey(),"",{PostKey:i})),U.default.addToCache(l)}},onVoteDown:function(e){var n=t(e.currentTarget),i=n.closest(this.selectors.ENTRY_ENTITY).data("entry-id"),o=n.closest(this.selectors.ENTRY_ENTITY).data("entry-url"),s=n.closest(this.selectors.ENTRY_VOTE_CONTAINER);if(a.PageController.ensureLoggedIn(o)){var r=s.hasClass(this._voteDown);s.hasClass(this._voteUp)&&this.minusLoveCount(i);var l={};r?(L.default.unlike(i,function(){},function(){}),this.addLoveCount(i),this.handlers.unlikeHandler(i),l[i]=0,A.default.isPostPage()?u.trackEvent("PostAction","UnvotePost",i):u.trackEvent("PostList","UnvotePost",A.default.getPageKey(),"",{PostKey:i})):(L.default.dislike(i,function(){},function(){}),this.minusLoveCount(i),this.handlers.dislikeHandler(i),l[i]=-1,A.default.isPostPage()?u.trackEvent("PostAction","DownvotePost",i):u.trackEvent("PostList","DownvotePost",A.default.getPageKey(),"",{PostKey:i})),U.default.addToCache(l)}},addLoveCount:function(e){var n=this.getLoveCounter(e),i=t("#jsid-entry-entity-"+e),o=parseInt(i.data("entry-votes"));isNaN(o)||(o++,t(this.selectors.ENTRY_LOVE_COUNT,n).text(l.formatNumber(o)),i.data("entry-votes",o),this.updateFastItem(e,"votes",o))},minusLoveCount:function(e){var n=this.getLoveCounter(e),i=t("#jsid-entry-entity-"+e),o=parseInt(i.data("entry-votes"));isNaN(o)||(o--,t(this.selectors.ENTRY_LOVE_COUNT,n).text(l.formatNumber(o)),i.data("entry-votes",o),this.updateFastItem(e,"votes",o))},updateFastItem:function(e,t,n){null!=this._fastItems&&"undefined"!=this._fastItems[e]&&(this._fastItems[e][t]=n)},getLoveCounter:function(e){return t("#love-count-"+e)},renderYouTubeToPostView:function(){var e=t(this.selectors.ENTRY_YOUTUBE_VIDEO_PLACEHOLDER),n=e.parents(this.selectors.ENTRY_VIDEO_CONTAINER);if(n.length){var i=(n.width()-e.width())/2;n.css("margin-left",i),w.default.renderYouTubePlayer(e)}},trackPostUV:function(){if(A.default.isPostPage()){var e=t(this.selectors.ENTRY_ENTITY).data("entry-id"),n={label:"",labelValue:"",platform:"d",entry:e,view:"p"};P.default.uniqueViewed(n)}},bindStickyEntryBars:function(){A.default.isPostPage()?t(window).on("scroll resize",null,null,t.proxy(this.handlers.entryStickyToolbarHandler,this)):(A.default.isProfilePage()&&(this._entryStickyElementMarginTop=this._entryStickyElementMarginTopProfile),t(window).on("scroll resize",null,null,t.proxy(this.handlers.entryStickElementHandler,this)))},bindVoteUpElements:function(){t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_UPVOTE_BUTTON,t.proxy(this.onVoteUp,this))},bindVoteDownElements:function(){t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_DOWNVOTE_BUTTON,t.proxy(this.onVoteDown,this))},bindEntryMenuElements:function(){t(this.selectors.CONTAINER).on("click",this.selectors.LIST_ENTRY_MORE_BUTTON,t.proxy(this.showEntryMenu,this))},showingMenusElements:[],showEntryMenu:function(e){e.stopPropagation();var n=t(e.target),i=""+n.data("entry-id"),s=n.parents(this.selectors.LIST_ENTRY_BUTTONS_CONTAINER).siblings(this.selectors.LIST_ENTRY_MORE_ITEMS);s.hasClass("hide")?(this.showingMenusElements.push(s),s.find(this.selectors.ENTRY_DELETE).addClass("hide"),s.find(this.selectors.ENTRY_REPORT).removeClass("hide"),s.removeClass("hide"),o.track("PostAction","OpenMoreMenu",i)):(s.addClass("hide"),o.track("PostAction","CloseMoreMenu",i))},hideListEntryMenus:function(){for(var e=0;e<this.showingMenusElements.length;e++)this.showingMenusElements[e].addClass("hide");this.showingMenusElements=[]},_currentEntryUri:"",_currentAuth:"",_currentCommentOptions:"",bindCommentElements:function(){var e=this;setTimeout(function(){e.renderPendingComment()},1e4)},setHideDurationTimer:function(){var e=this;setTimeout(function(){t("."+e.selectors.ENTRY_ANIMATED_PLAYING).each(function(n,i){t(i).find(e.selectors.VIDEO_DURATION).addClass("hide")})},3e3)},toggleSoundHandler:function(e,n,i,s){var r=void 0===i?n.hasClass("off"):i,a=n.length>0&&!s;r?(n.removeClass("off").addClass("on"),t(e)[0].muted=!1,a&&o.track("PostAction","ToggleSoundOn",l.getCurrentEntryId())):(n.removeClass("on").addClass("off"),t(e)[0].muted=!0,a&&o.track("PostAction","ToggleSoundOff",l.getCurrentEntryId()))},bindEntryCoverElements:function(){var e=this;t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_NSFW_COVER,null,t.proxy(function(e){e.preventDefault();var n=t(e.currentTarget).parents(this.selectors.ENTRY_ENTITY).data("entry-url");C.default.setSafeMode(0,n)},this)),t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_VIDEO_COVER,null,t.proxy(function(e){e.preventDefault();var n=t(e.currentTarget),i=n.parents(this.selectors.ENTRY_VIDEO_CONTAINER);w.default.renderYouTubePlayer(i)},this)),t(this.selectors.ENTRY_YOUTUBE_VIDEO_PLACEHOLDER).ready(function(){e.renderYouTubeToPostView()}),t(this.selectors.CONTAINER).on("click",this.selectors.VIDEO_SOUND_TOGGLE,null,t.proxy(function(e){e.stopPropagation(),e.preventDefault();var n=this,i=t(e.currentTarget),o=i.parent().parent().find(n.selectors.ENTRY_ANIMATED_VIDEO_PLAYER);this.toggleSoundHandler(o,i)},this));var n=this;a.PageController.tabVisibilityChange(function(){a.PageController.tabVisibilityChange()||n.playVideosAndPauseOthersByEntryIds([])});var i=t.proxy(function(e,n){e.preventDefault();var i=this,o=t(e.currentTarget),s=o.find(i.selectors.ENTRY_ANIMATED_CONTAINER_STATIC),r=o.find(i.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED),a=o.find(i.selectors.ENTRY_ANIMATED_VIDEO_PLAYER),l=s.parent(),c=r.find("video"),d=s.find(".badge-item-img");if(0==c.length){var u=s.find("img").attr("style"),h="width:"+l.css("width")+"; height:"+l.css("height")+";";Modernizr.video?r.append('<video preload="none" poster="'+d[0].src+'" style="'+h+'" loop muted><source src="'+r.data("mp4")+'" type="video/mp4"><source src="'+r.data("webm")+'" type="video/webm"><div class="badge-item-animated-img"></div></video>'):r.append('<img src="'+r.data("image")+'" style="'+u+'"/>'),r.removeData("image"),r.attr("data-image",""),r.removeData("mp4"),r.attr("data-mp4",""),r.removeData("webm"),r.attr("data-webm",""),i.bindImageLoadedEvent(l)}else{var f=n&&n.auto_action,_=o.find(i.selectors.VIDEO_SOUND_TOGGLE),g=o.find(i.selectors.VIDEO_DURATION),p=0===_.length;if(!s.hasClass("loading")&&(s.hasClass("presenting")||s.hasClass("hide"))&&e&&"click"===e.type)if(t(a)[0].paused&&(s.hasClass("presenting")||s.hasClass("hide"))){var E=_.hasClass("inited-play");_.removeClass("hide"),_.addClass("inited-play");var T=t(a)[0].muted||!E;f||(T=!1),this.toggleSoundHandler(t(a)[0],_,!T,f),g.removeClass("hide"),i.setHideDurationTimer(),t(a).attr("timeupdate-monitor")||(t(a).attr("timeupdate-monitor",1),t(a).on("timeupdate",t.proxy(this.handlers.onVideoTimeUpdateHandler,this))),t(a)[0].play(),l.addClass(i.selectors.ENTRY_ANIMATED_PLAYING),s.addClass("hide"),s.removeClass("presenting")}else f||p?(t(a)[0].pause(),_.addClass("hide"),g.removeClass("hide"),l.removeClass(i.selectors.ENTRY_ANIMATED_PLAYING),s.removeClass("hide"),s.addClass("presenting"),d.addClass("hide")):this.toggleSoundHandler(t(a)[0],_,void 0,f);if(s.hasClass("presenting"))t(this.selectors.ENTRY_ANIMATED_PLAY_BUTTON).removeClass("hide");else{var m=r.find("img");m.prop("src",m.prop("src"))}}},this);t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_ANIMATED_COVER,i)},bindImageLoadedEvent:function(e){var n=this,i=e.find(n.selectors.ENTRY_ANIMATED_CONTAINER_STATIC),o=e.find(n.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED),s=e.find(".badge-item-img");o.find("img").load(function(){i.removeClass("loading"),i.addClass("hide"),i.removeClass("presenting"),o.removeClass("hide"),Modernizr.video&&(i.css("padding-left",s.css("padding-left")),s.css("padding-left",""),s.addClass("hide"));var e=t(this);e.prop("src",e.prop("src")),o.find("img").unbind()}).each(function(){this.complete&&t(this).load()})},bindReportElements:function(){t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_REPORT,null,t.proxy(this.handlers.reportHandler,this))},bindDeleteElements:function(){t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_DELETE,null,t.proxy(this.handlers.deleteHandler,this))},bindShortcutKeys:function(){y.default.bindAction("l",t.proxy(this.onVoteUp,this)),y.default.bindAction("h",t.proxy(this.onVoteDown,this))},bindZoomElements:function(){t(this.selectors.CONTAINER).on("click",this.selectors.ENTRY_POST_ZOOM,t.proxy(function(e){e.preventDefault();var n=t(e.currentTarget),i=n.closest(this.selectors.ENTRY_ENTITY+", "+this.selectors.ENTRY_ALBUM_ITEM_ENTITY);this.showPostZoomOverlay(i)},this))},replacePostUrl:function(e){var t="/gag/"+e;void 0!==window.history.pushState&&window.history.pushState({},"",t)},updatePostUrl:function(e){var t="/gag/"+e;void 0!==window.history.replaceState&&window.history.replaceState({},"",t)},recoverOrginialUrl:function(){window.history.go(-1)},showPostZoomOverlay:function(e){var n=e.find("img").first().clone().removeAttr("class");t(this.selectors.MODAL_POST_ZOOM_CONTAINER).find(".badge-post-zoom-img").html("").append(n),p.default.showOverlay(this.selectors.MODAL_POST_ZOOM_CONTAINER,!1)},hidePostZoomOverlay:function(){t(this.selectors.MODAL_POST_ZOOM_CONTAINER).addClass("hide"),t("body").removeClass("no-scroll")},scrollToComment:function(){var e=t("#comment");t("html,body").animate({scrollTop:e.offset().top},100)},playVideosAndPauseOthersByEntryIds:function(e){var n=this,i=[];t("."+n.selectors.ENTRY_ANIMATED_PLAYING).each(function(){var o=t(this).closest("article").data("entry-id");if(t.inArray(o,e)<0){var s=t(this).find("video");s&&s.length>0&&s[0].pause();t(this).find(n.selectors.VIDEO_DURATION).removeClass("hide");t(this).find(n.selectors.VIDEO_SOUND_TOGGLE).addClass("hide");var r=t(this).find(n.selectors.ENTRY_ANIMATED_CONTAINER_STATIC);r.removeClass("hide"),r.addClass("presenting"),r.find(".badge-item-img").addClass("hide"),t(this).removeClass(n.selectors.ENTRY_ANIMATED_PLAYING)}else i.push(o)}),a.ListController.findCurrentlyInFocusEntries().each(function(){var o=t(this).closest("article").data("entry-id");if(t.inArray(o,e)>=0&&t.inArray(o,i)<0){var s=t(this).find(n.selectors.ENTRY_ANIMATED_VIDEO_PLAYER);t(s)[0]&&(t(s)[0].muted=!0),t(this).find(n.selectors.ENTRY_ANIMATED_COVER).trigger("click",{auto_action:!0})}})},upvoteEntry:function(e){t(e).find(this.selectors.ENTRY_UPVOTE_BUTTON).first().click()},downvoteEntry:function(e){t(e).find(this.selectors.ENTRY_DOWNVOTE_BUTTON).first().click()},commentEntry:function(e){t(e).first();if(A.default.isPostPage())this.scrollToComment();else if(e.length>0){var n=t(e).find(this.selectors.ENTRY_COMMENT_BUTTON).first();n.click(),window.open(n.attr("href"),"_blank")}},playEntry:function(e){var n=t(e).first(),i=n.find(this.selectors.ENTRY_VIDEO_COVER),o=n.find(this.selectors.ENTRY_ANIMATED_COVER);i.length?i.click():o.length&&o.click()},prevEntry:function(){t(this.selectors.ENTRY_PREV_POST_ENTRY).click()},nextEntry:function(){t(this.selectors.ENTRY_NEXT_POST_ENTRY).click()},postCallback:function(e,n){var i=this;t.inArray(e,i.availableCallbacks)>=0&&i[e](n)},postWillArchive:function(e){var t=this;if(e.hasClass(t.selectors.ENTRY_CONTAINER_RAW)){var n=e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_STATIC);if(n&&n.length>0){var i=e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED+" img"),o=e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED+" video");i&&i.length>0&&i.unbind(),o&&o.length>0&&(o.attr("preload","none"),o.unbind())}var s=e.find(t.selectors.ENTRY_VIDEO_CONTAINER);if(s&&s.length>0){var r=s.data("youtubePlayer");r&&r.stop()}var a=e.find(t.selectors.ENTRY_ANIMATED_VIDEO_PLAYER);a&&a.length>0&&(a.unbind(),a.attr("timeupdate-monitor",""))}},postDidArchive:function(e){},postWillRestore:function(e){},postDidRestore:function(e){var t=this;if(e.hasClass(t.selectors.ENTRY_CONTAINER_RAW)){var n=e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_STATIC),i=(e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED),e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED+" img")),o=e.find(t.selectors.ENTRY_ANIMATED_CONTAINER_ANIMATED+" video"),s=i&&i.length>0,r=o&&o.length>0;s&&i[0].complete&&n.hasClass("loading")?(n.removeClass("loading"),n.removeClass("presenting"),n.addClass("hide")):s&&!i[0].complete&&n.hasClass("loading")&&(n.addClass("loading"),n.removeClass("presenting"),t.bindImageLoadedEvent(e)),r&&(n.removeClass("loading"),n.removeClass("hide"),n.addClass("presenting"));var a=e.find(t.selectors.ENTRY_VIDEO_CONTAINER);a&&a.length>0&&a.hasClass("playing")&&w.default.renderYouTubePlayer(a,!1)}}});e.exports=x}).call(t,n(0),n(3),n(8),n(95),n(0),n(4),n(12),n(43),n(58),n(18))},function(e,t,n){"use strict";(function(t,i){var o=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(o),r=t.extend({},new s.default,{init:function(){this.bindElements()},selectors:{SETTING_SOCIAL_UNLINK_BTNS:".badge-social-unbind",PROFILE_AVATAR_IMAGE:"#jsid-profile-avatar",PROFILE_AVATAR_UPLOAD:"input[name=avatar]",PROFILE_DEFAULT_AVATAR:"input[name=default_avatar]",PROFILE_COLOR_BTN:".badge-profile-color",PROFILE_COLOR:"input[name=profile_color]",RANDOM_AVATAR_BTN:"#jsid-random-avatar-btn"},_bindSocialUnlinkButtons:function(){t(this.selectors.SETTING_SOCIAL_UNLINK_BTNS).on("click",function(e){var n=t(this),i=n.attr("data-platform");t.ajax({url:"/connect/unlink",data:{platform:i},dataType:"json",success:function(e){e&&e.okay&&window.location.reload()},error:function(e){}})})},_bindRandomAvatarButton:function(){var e=t(this.selectors.PROFILE_AVATAR_IMAGE),n=t(this.selectors.PROFILE_DEFAULT_AVATAR),i=t(this.selectors.RANDOM_AVATAR_BTN);t(i).click(t.proxy(function(){var o=i.data("path"),s=i.data("max"),r=Math.floor(Math.random()*s+1),a=o.replace("%random%",r);if(e.attr("src")!=a){e.attr("src",a),n.val(r);var l=t(this.selectors.PROFILE_AVATAR_UPLOAD);l.replaceWith(l.clone())}else i.click();return!1},this)),t(document).on("change",this.selectors.PROFILE_AVATAR_UPLOAD,function(){n.val("")})},_bindProfileColorButton:function(){t(this.selectors.PROFILE_COLOR_BTN).click(function(e){t(r.selectors.PROFILE_COLOR_BTN).removeClass("selected"),t(this).addClass("selected"),t(r.selectors.PROFILE_COLOR).val(t(this).data("color")),i.track("ProfileAction","ChangeColor","","",{Color:t(this).data("color")}),e.preventDefault()})},bindElements:function(){this._bindSocialUnlinkButtons(),this._bindRandomAvatarButton(),this._bindProfileColorButton()}});e.exports=r}).call(t,n(0),n(8))},function(e,t,n){"use strict";(function(t,i,o,s){function r(e){return e&&e.__esModule?e:{default:e}}var a=n(1),l=r(a),c=n(35),d=(r(c),n(26)),u=r(d),h=n(187),f=r(h),_=n(52).Promise,g=t.extend({},new l.default,{types:{POST:"Post",USER:"User",COMMENT:"Comment"},selectors:{MODAL_REPORT_BUTTON_BACK:"#jsid-report-explain-back",MODAL_REPORT_BUTTON_SUBMIT:"#jsid-report-explain-confirm",MODAL_REPORT_BUTTON_PROCEED:"#jsid-report-option-proceed",MODAL_REPORT_BUTTON_CANCEL:"#jsid-report-option-cancel",MODAL_REPORT_OPTION:".badge-report-type",MODAL_REPORT_OPTION_SELECTOR:".badge-report-selector",MODAL_REPORT_EXPLAIN_PANEL:".badge-report-explain",MODAL_REPORT_ENTITY_CLASS_COMMENT:"badge-report-entity-comment",MODAL_REPORT_ENTITY_CLASS_POST:"badge-report-entity-post",MODAL_REPORT_ENTITY_CLASS_USER:"badge-report-entity-user",MODAL_REPORT_OPTIONS_PANEL:"#jsid-report-type-container",REPORT_LINK:".badge-item-report"},urls:{DMCA:"https://www.surveymonkey.com/r/GQ83JXB",ReportImpersonation:"https://www.surveymonkey.com/r/GSJ3NTF"},init:function(){this.bindElements()},bindElements:function(){this.bindReportElements()},bindReportElements:function(){t(this.selectors.MODAL_REPORT_BUTTON_BACK).on("click",null,null,t.proxy(this.handlers.reportBackHandler,this)),t(this.selectors.MODAL_REPORT_BUTTON_SUBMIT).on("click",null,null,t.proxy(this.handlers.reportSubmitHandler,this)),t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).on("click",null,null,t.proxy(this.handlers.reportProceedHandler,this)),t(this.selectors.MODAL_REPORT_BUTTON_CANCEL).on("click",null,null,t.proxy(this.handlers.reportCancelHandler,this)),t(this.selectors.MODAL_REPORT_OPTION).on("click",null,null,t.proxy(this.handlers.reportOptionChangeHandler,this))},clearHandlers:function(){this.onDoneHandler=null,this.onCancelHandler=null},onCancel:function(){i.log("ReportController.onCancel"),this.onCancelHandler&&this.onCancelHandler(),this.clearHandlers()},getReportOverlayPromiseForComment:function(e){i.log("Report comment",e);var t=o.ReportController,n=e?e.commentId:"",s={type:t.types.COMMENT,objectId:n};return t.getReportOverlayPromise(s)},getReportOverlayPromise:function(e){i.log("getReportOverlayPromise",e);var t=o.ReportController;return new _(function(n,o){t.showReportOverlay(e,function(e){i.log("ReportController.promise resolve()",e),n(e)},function(){i.log("ReportController.promise reject()"),o()})})},showReportOverlay:function(e,t,n){this.currentConfigs=e,u.default.showOverlay(u.default.selectors.OVERLAY_COMPONENT_REPORT,!1),this.onDoneHandler=t,this.onCancelHandler=n,this.enableReportButtons(!0),this.showReportExplainPanel(!1,0),this.setSelectedReportType(0),this.showReportOptionsPanel(!0)},hideReportOverlay:function(){u.default.hideOverlay(u.default.selectors.OVERLAY_COMPONENT_REPORT)},getReportEntityFilterClass:function(){var e=void 0;return this.currentConfigs.type==this.types.COMMENT?e=this.selectors.MODAL_REPORT_ENTITY_CLASS_COMMENT:this.currentConfigs.type==this.types.POST?e=this.selectors.MODAL_REPORT_ENTITY_CLASS_POST:this.currentConfigs.type==this.types.USER&&(e=this.selectors.MODAL_REPORT_ENTITY_CLASS_USER),e},selectedReportType:0,getSelectedReportType:function(){return this.selectedReportType},setSelectedReportType:function(e){var n=!1;t(this.selectors.MODAL_REPORT_OPTION).each(function(i,s){var r=t(s).data("report-type"),a=t(s).find(o.ReportController.selectors.MODAL_REPORT_OPTION_SELECTOR);e==r?(a.addClass("selected"),n=!0):a.removeClass("selected")}),n?(this.selectedReportType=e,t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).removeClass("disabled")):t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).addClass("disabled")},showReportOptionsPanel:function(e){if(e){var n=this.getReportEntityFilterClass();t(this.selectors.MODAL_REPORT_OPTION).each(function(e,i){t(i).hasClass(n)?t(i).removeClass("hide"):t(i).addClass("hide")}),t(this.selectors.MODAL_REPORT_OPTIONS_PANEL).removeClass("hide"),t(this.selectors.MODAL_REPORT_BUTTON_CANCEL).removeClass("hide"),t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).removeClass("hide")}else t(this.selectors.MODAL_REPORT_OPTIONS_PANEL).addClass("hide"),t(this.selectors.MODAL_REPORT_BUTTON_CANCEL).addClass("hide"),t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).addClass("hide")},showReportExplainPanel:function(e,n){var o=t(this.selectors.MODAL_REPORT_BUTTON_SUBMIT),s=o.data("default-text"),r=!1,a=this.getReportEntityFilterClass();a&&(t(this.selectors.MODAL_REPORT_EXPLAIN_PANEL).each(function(o,l){var c=t(l).data("report-type"),d=t(l).data("submit-button-text");e&&n==c&&t(l).hasClass(a)?(t(l).removeClass("hide"),r=!0,i.log("customSubmitButtonText",d),d&&(s=d)):t(l).addClass("hide")}),i.log("submitButtonText",s),o.text(s),1==n||11==n?o.removeClass("red"):o.addClass("red"),r?(t(this.selectors.MODAL_REPORT_BUTTON_BACK).removeClass("hide"),o.removeClass("hide")):(t(this.selectors.MODAL_REPORT_BUTTON_BACK).addClass("hide"),o.addClass("hide")))},enableReportButtons:function(e){e?(t(this.selectors.MODAL_REPORT_BUTTON_CANCEL).removeClass("disabled"),t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).removeClass("disabled"),t(this.selectors.MODAL_REPORT_BUTTON_BACK).removeClass("disabled"),t(this.selectors.MODAL_REPORT_BUTTON_SUBMIT).removeClass("disabled")):(t(this.selectors.MODAL_REPORT_BUTTON_CANCEL).addClass("disabled"),t(this.selectors.MODAL_REPORT_BUTTON_PROCEED).addClass("disabled"),t(this.selectors.MODAL_REPORT_BUTTON_BACK).addClass("disabled"),t(this.selectors.MODAL_REPORT_BUTTON_SUBMIT).addClass("disabled"))},sendReport:function(e,n,o){if(!this.currentConfigs)return void i.log("ReportController: configurations not found");t(e.currentTarget);if(i.log("ReportController reportType:"+n),i.log("ReportController objectType:"+this.currentConfigs.type),i.log("ReportController objectId:"+this.currentConfigs.objectId),i.log("ReportController silentMode:"+o),!this._reportInProgress){this._reportInProgress=!0;var s=t(this.selectors.MODAL_REPORT_BUTTON_SUBMIT),r=s.text();o||(this.enableReportButtons(!1),s.text(s.data("loading-text"))),f.default.reportEntity(this.currentConfigs.type,this.currentConfigs.objectId,n,"",t.proxy(function(){this.hideReportOverlay(),this._reportInProgress=!1,this.enableReportButtons(!0),o||(s.text(r),this.showSuccessToast())},this),t.proxy(function(){this._reportInProgress=!1,this.enableReportButtons(!0),o||(s.text(r),this.showErrorToast())},this))}},showSuccessToast:function(){o.PageController.showToast("Reported. Thanks for making 9GAG better.","yellow",5e3,"fixed")},showErrorToast:function(){o.PageController.showToast("Something went wrong, please try again later.","yellow",5e3,"fixed")},handlers:{reportOptionChangeHandler:function(e){var n=t(e.currentTarget),o=n.data("report-type");this.setSelectedReportType(o),i.log("ReportController::reportOptionChangeHandler reportType:"+this.getSelectedReportType())},reportCancelHandler:function(e){u.default.hideAllOverlay()},reportProceedHandler:function(e){var t=this.getSelectedReportType();this.showReportOptionsPanel(!1),this.showReportExplainPanel(!0,t)},reportBackHandler:function(e){this.showReportExplainPanel(!1,0),this.showReportOptionsPanel(!0)},reportSubmitHandler:function(e){var n=(t(e.currentTarget),this.getSelectedReportType()),o=!1;1==n?(o=!0,this.hideReportOverlay(),window.open(this.urls.DMCA,"_blank")):11==n&&(this.hideReportOverlay(),window.open(this.urls.ReportImpersonation,"_blank"),o=!0);var r=this.currentConfigs.type+"Action",a="Report"+this.currentConfigs.type;s.track(r,a,"ReportType_"+n),this.onDoneHandler?(i.log("ReportController.onDoneHandler"),this.onDoneHandler({reportType:n}),this.hideReportOverlay(),this.showSuccessToast(),this.clearHandlers()):this.sendReport(e,n,o)}}});e.exports=g}).call(t,n(0),n(2),n(4),n(8))},function(e,t,n){"use strict";(function(t){var i=n(1),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},new o.default,function(){var e={selectors:{CLICK_EVENT_SELECTOR_DELEGATE:"#container"},_openFacebookShareDialog:function(n){n.preventDefault();var i=t(this),o=i.attr("data-share"),s="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(o);e._openWindow(s)},_openTwitterShareDialog:function(n){n.preventDefault();var i=t(this),o=i.attr("data-share"),s=i.attr("data-title"),r="https://twitter.com/intent/tweet?via=9GAG&source=tweetbutton&original_referer="+encodeURIComponent(o)+"&text="+s+"&url="+encodeURIComponent(o);e._openWindow(r)},_openGPlusShareDialog:function(n){n.preventDefault();var i=t(this),o=i.attr("data-share"),s="https://plus.google.com/share?url="+encodeURIComponent(o);e._openWindow(s)},_openPinterestShareDialog:function(n){n.preventDefault();var i=t(this),o=i.attr("data-share"),s=i.attr("data-img"),r=i.attr("data-title"),a="//pinterest.com/pin/create/button/?url="+encodeURIComponent(o)+"&media="+encodeURIComponent(s)+"&description="+r;e._openWindow(a)},_openWindow:function(e){var t=window.screen.height/2-230,n=window.screen.width/2-320;window.open(e,"Share","status=1,height=460,width=640,top="+t+",left="+n+",resizable=0")},_bindElements:function(){t(e.selectors.CLICK_EVENT_SELECTOR_DELEGATE).on("click",".badge-facebook-share",e._openFacebookShareDialog),t(e.selectors.CLICK_EVENT_SELECTOR_DELEGATE).on("click",".badge-twitter-share",e._openTwitterShareDialog),t(e.selectors.CLICK_EVENT_SELECTOR_DELEGATE).on("click",".badge-gplus-share",e._openGPlusShareDialog),t(e.selectors.CLICK_EVENT_SELECTOR_DELEGATE).on("click",".badge-pinterest-share",e._openPinterestShareDialog)}};return{init:function(){e._bindElements()}}}());e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t,i,o,s,r,a){function l(e){return e&&e.__esModule?e:{default:e}}var c=n(7),d=l(c),u=n(102),h=l(u),f=n(14),_=l(f),g=n(6),p=l(g),E=n(20),T=l(E),m=n(19),v=l(m),I=n(1),C=l(I),O=n(5),y=l(O),N=function(e){function t(){(0,p.default)(this,t);var e=y.default.isPostPage()?0:i("#top-nav").height();return(0,T.default)(this,(t.__proto__||(0,_.default)(t)).call(this,e))}return(0,v.default)(t,e),t}(t),A=function(e){function t(){return(0,p.default)(this,t),(0,T.default)(this,(t.__proto__||(0,_.default)(t)).apply(this,arguments))}return(0,v.default)(t,e),(0,d.default)(t,[{key:"shouldCheckImpression",value:function(e){return e.data?e.data.nsfwCover?(this.log("Web.shouldCheckImpression() nsfw cover",e),!1):(0,h.default)(t.prototype.__proto__||(0,_.default)(t.prototype),"shouldCheckImpression",this).call(this,e):(this.log("Web.shouldCheckImpression() no data",e),!1)}},{key:"shouldCheckNonVideoView",value:function(e){return e.data?e.data.video||e.data.youtube?(this.log("Web.shouldCheckNonVideoView() is video",e),!1):e.data.nsfwCover?(this.log("Web.shouldCheckNonVideoView() nsfw cover",e),!1):(this.log("Web.shouldCheckNonVideoView()",e),(0,h.default)(t.prototype.__proto__||(0,_.default)(t.prototype),"shouldCheckNonVideoView",this).call(this,e)):(this.log("Web.shouldCheckNonVideoView() no data",e),!1)}},{key:"updateTrackingCVars",value:function(){var e=s.get("page.page_key");e&&(e=e.toLowerCase()),this.setScreenKey(e);var t=y.default.getUrlParam("ref"),n="",i="";y.default.isPostPage()?n="SinglePost":y.default.isProfilePage()?(n="ProfilePostList",i=e):y.default.isSectionPage()?(n="SectionPostList",i=e):y.default.isTagPostListPage()?(n="featured-tag"==t?"FeaturedTagPostList":"related-tag"==t?"RelatedTagPostList":"post-tag"==t?"PostTagPostList":"search"==t?"SearchTagPostList":"TagPostList",i=e):y.default.isSearchPage()?n="SearchPostList":(n="PostList",i=e);var o={TriggeredPage:n,TriggeredPageKey:i};this.setTrackingCVars(o)}}]),t}(o),R=i.extend({},new C.default,{init:function(){this.timedTrackingMgr=new A(new N,r),this.timedTrackingMgr.updateTrackingCVars(),this.timedTrackingMgr.start(),this.trackElements(i(a.PostController.selectors.ENTRY_CONTAINER))},trackElements:function(e){var t=this;e.each(function(e,n){var o=i(n),s=o.attr("id"),r=o.data("entry-id"),l=o.find(a.PostController.selectors.ENTRY_NSFW_COVER).length>0,c=o.find(a.PostController.selectors.ENTRY_VIDEO_CONTAINER).length>0,d=o.find("video").length>0;t.timedTrackingMgr.track(s,{key:r,nsfwCover:l,video:d,youtube:c})}),this.timedTrackingMgr.check()},untrackAll:function(){this.timedTrackingMgr.untrackAll()}});e.exports=R}).call(t,n(159),n(0),n(158),n(3),n(58),n(4))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(1),r=o(s),a=n(5),l=o(a),c=t.extend({},new r.default,{init:function(){this._bindClickFollowButtonEvent()},_bindClickFollowButtonEvent:function(){t("#twitter-wbjs").load(function(){window.twttr&&window.twttr.events.bind("follow",function(e){i.track("Social","LikeTwitter",l.default.getPageKey())})})}});e.exports=c}).call(t,n(0),n(8))},function(e,t,n){"use strict";(function(t,n){var i={track:function(e,i,o){try{if(t.log("Tracking GA: "+e+","+i+","+o),!n.get("configs").gaEventEnabled)return;if(void 0==window._ga&&ga("send","event",e,i,o),window._ga&&window._ga instanceof Array)for(var s=0;s<window._ga.length;s++){var r=window._ga[s];ga(r+".send","event",e,i,o)}}catch(e){}}};e.exports=i}).call(t,n(2),n(3))},function(e,t,n){"use strict";var i={all_shortcuts:{},commandMode:!1,add:function(e,t,n){var i={type:"keydown",propagate:!1,disable_in_input:!1,require_command_mode:!0,target:document,keycode:!1};if(n)for(var o in i)void 0===n[o]&&(n[o]=i[o]);else n=i;var s=n.target;"string"==typeof n.target&&(s=document.getElementById(n.target));var r=this;e=e.toLowerCase();var a=function(i){var o,s;if(i=i||window.event,n.disable_in_input){var a;if(i.target?a=i.target:i.srcElement&&(a=i.srcElement),3==a.nodeType&&(a=a.parentNode),"INPUT"==a.tagName||"TEXTAREA"==a.tagName)return}if(!n.require_command_mode||r.commandMode){i.keyCode?o=i.keyCode:i.which&&(o=i.which);var l=String.fromCharCode(o).toLowerCase();188==o&&(l=","),190==o&&(l=".");var c=e.split("+"),d=0,u={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},h={esc:27,escape:27,tab:9,space:32,return:13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,break:19,insert:45,home:36,delete:46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},f={shift:{wanted:!1,pressed:!1},ctrl:{wanted:!1,pressed:!1},alt:{wanted:!1,pressed:!1},meta:{wanted:!1,pressed:!1}};i.ctrlKey&&(f.ctrl.pressed=!0),i.shiftKey&&(f.shift.pressed=!0),i.altKey&&(f.alt.pressed=!0),i.metaKey&&(f.meta.pressed=!0);for(var _=0;s=c[_],_<c.length;_++)"ctrl"==s||"control"==s?(d++,f.ctrl.wanted=!0):"shift"==s?(d++,f.shift.wanted=!0):"alt"==s?(d++,f.alt.wanted=!0):"meta"==s?(d++,f.meta.wanted=!0):s.length>1?h[s]==o&&d++:n.keycode?n.keycode==o&&d++:l==s?d++:u[l]&&i.shiftKey&&(l=u[l])==s&&d++;return d!=c.length||f.ctrl.pressed!=f.ctrl.wanted||f.shift.pressed!=f.shift.wanted||f.alt.pressed!=f.alt.wanted||f.meta.pressed!=f.meta.wanted||(t(i),n.propagate)?void 0:(i.cancelBubble=!0,i.returnValue=!1,i.stopPropagation&&(i.stopPropagation(),i.preventDefault()),!1)}};this.all_shortcuts[e]={callback:a,target:s,event:n.type},s.addEventListener?s.addEventListener(n.type,a,!1):s.attachEvent?s.attachEvent("on"+n.type,a):s["on"+n.type]=a},remove:function(e){e=e.toLowerCase();var t=this.all_shortcuts[e];if(delete this.all_shortcuts[e],t){var n=t.event,i=t.target,o=t.callback;i.detachEvent?i.detachEvent("on"+n,o):i.removeEventListener?i.removeEventListener(n,o,!1):i["on"+n]=!1}},commandModeListener:null,toggleCommandMode:function(){this.commandMode=!this.commandMode,null!=this.commandModeListener&&this.commandModeListener()}};e.exports=i},function(e,t,n){"use strict";(function(t){var i=n(5),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s={isValidLoginKey:function(e){return this.isValidUsername(e)||this.isValidEmail(e)},isValidUsername:function(e){return e.test("^[0-9a-zA-Z_]{3,15}$")},isValidEmail:function(e){return null!=e.match("^([a-zA-Z0-9._-]+)@([a-zA-Z0-9.-]+)\\.([a-zA-Z]{2,4})$")},isValidFullName:function(e){return t.trim(e).length>0},isValidPassword:function(e,t,n){var i=!0;return void 0!=t&&e.length<t&&(i=!1),void 0!=n&&e.length>n&&(i=!1),0==e.length&&(i=!1),i},isValidGender:function(e){return"F"==e||"M"==e},MONTH_DAYS:[31,29,31,30,31,30,31,31,30,31,30,31],isValidDateValues:function(e,t,n){var i=e%400==0||e%100!=0&&e%4==0;this.MONTH_DAYS[1]=i?29:28;var o=n>=1&&n<=31&&t>=1&&t<=12&&e>=1900,s=n<=this.MONTH_DAYS[t-1];return o&&s},isValidPostLink:function(e){var t=new RegExp("^http(s?)://"+o.default.getDomain()+"/gag/([1-9])([0-9]*)(\\?[^ ]*)?$");return e.trim().test(t)},lookLikeURL:function(e){var t=new RegExp("^http(s?)://");return e.trim().test(t)}};e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t,i,o){function s(e){return e&&e.__esModule?e:{default:e}}var r=n(11),a=s(r),l=n(27),c=s(l),d=t.extend({},new c.default,{remoteUrl:"/cacheable",queue:[],graceCookieKey:"cacheableGrace",addToQueue:function(e,t,n){this.queue.push({controllerName:e,params:t,callback:n})},processQueue:function(){var e=this;if(0==this.queue.length)return void i.log("Skip call remoteUrl. Reason: empty queue");if(!this.issetPhpSessionId()||this.isInGracePeriod())return this.issetPhpSessionId()||i.log("CacheableRemoteHandler php session id is not set. Bye!!"),void(this.isInGracePeriod()&&i.log("CacheableRemoteHandler is in grace period. Bye!!"));i.log("calling cacheable");var n=[],s=[],r=[];t.each(this.queue,function(e,t){n[e]=t.params,s[e]=t.controllerName,r[e]=t.callback}),t.ajax({url:e.remoteUrl,type:"POST",dataType:"json",data:{json:(0,a.default)(n)},success:function(e){t.each(r,function(t,n){o.getController(s[t])[n](e)})},error:function(){t.each(r,function(e,t){o.getController(s[e])[t](json)})}}),this.queue=[]},isInGracePeriod:function(){return t.cookie(this.graceCookieKey)},issetPhpSessionId:function(){return t.cookie("PHPSESSID")}});e.exports=d}).call(t,n(0),n(2),n(43))},function(e,t,n){"use strict";(function(t){var i=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},o.default,{cacheKey:"cacheableUserPreference",cacheTTL:1800,formatRemoteParams:function(e){return{action:"user-preference",params:{}}},get:function(){return this.getFromCache()},addToCache:function(e){return!1},removeFromCache:function(e){return!1}});e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t){var i=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},o.default,{cacheKey:"cacheableUserQuota",cacheTTL:1800,formatRemoteParams:function(e){return{action:"user-quota",params:{}}},get:function(){return this.getFromCache()},addToCache:function(e){return!1},removeFromCache:function(e){return!1}});e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t){var i=n(36),o=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t.extend({},o.default,{cacheKey:"cacheableUser",cacheTTL:1800,formatRemoteParams:function(e){return{action:"user",params:{}}},get:function(){var e=this.getFromCache();return e},addToCache:function(e){return!1},removeFromCache:function(e){return!1}});e.exports=s}).call(t,n(0))},function(e,t,n){"use strict";(function(t,i,o,s,r){function a(e){return e&&e.__esModule?e:{default:e}}var l=n(13),c=(a(l),n(5)),d=(a(c),function(){var e={init:function(){},renderYouTubePlayer:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"YouTube"!==e.data("video-source")&&e.html("<div />");var o=e.width(),s=e.height(),r=e.data("video-id"),a=e.data("video-start"),l=[],c=new t.default({id:r,onStart:function(e){},onPause:function(e){},onSeek:function(e){},onPercentageChange:function(t){var n=t.percentage,o=t.isPlaying,s=t.time,r=t.duration,c=e.closest(".badge-entry-entity").data("entry-id");if(i.onVideoTimeUpdate({key:c,domId:"jsid-entry-entity-"+c},o,s,r,a),o){var d=void 0;n>=1&&n<5?d=1:n>=5&&n<10?d=5:n>=10&&n<25?d=10:n>=25&&n<50?d=25:n>=50&&n<75?d=50:n>=75&&n<90?d=75:n>=90&&n<95?d=90:n>=95&&n<100?d=95:100===n&&(d=100);d&&!l.some(function(e){return d<=e})&&l.push(d)}},onResume:function(e){},onEnded:function(){}});e.html('\n                <iframe\n                    id="'+c.getPlayerId()+'"\n                    width="'+o+'"\n                    height="'+s+'"\n                    src="https://www.youtube.com/embed/'+r+"?autoplay="+(n?1:0)+"&modestbranding=1&iv_load_policy=3&rel=0&showinfo=0&enablejsapi=1&start="+a+'"\n                    frameborder="0"\n                    allowfullscreen\n                />\n            ').addClass("playing").data("youtubePlayer",c),c.start()},_isRequesting:!1,deleteEntry:function(t){if(!d._isRequesting){var n={entryId:t};o.ajax({type:"DELETE",url:"/delete",dataType:"json",data:n,beforeSend:function(){e._isRequesting=!0},complete:function(){e._isRequesting=!1},success:function(e){e.okay?s.track("PostAction","DeleteSuccess",t):s.track("PostAction","DeleteFail",t),window.location=e.url||"/"},error:function(e){s.track("PostAction","DeleteFail",t);var n=r.parseJsonString(e);window.location=n.url||"/"}})}}};return{init:e.init,renderYouTubePlayer:e.renderYouTubePlayer,deleteEntry:e.deleteEntry}}());e.exports=d}).call(t,n(160),n(58),n(0),n(8),n(12))},function(e,t,n){"use strict";(function(t,i){function o(e){return e&&e.__esModule?e:{default:e}}var s=n(27),r=o(s),a=n(13),l=o(a),c=n(5),d=o(c),u=t.extend({},new r.default,function(){var e={API:{REPORT_ENTRY_URI:"/report"},init:function(){},_isRequesting:!1,reportEntity:function(n,o,s,r,a,c){if(l.default.isLoggedIn(!0,d.default.getBackUrl())&&!e._isRequesting){var u={type:s,link:r},h="Report";"Post"==n?(u.entryId=o,h="ReportPost"):"User"==n&&(u.username=o,h="ReportUser");var f=e.API.REPORT_ENTRY_URI;t.ajax({type:"POST",url:f,dataType:"json",data:u,beforeSend:function(){e._isRequesting=!0},complete:function(){e._isRequesting=!1},success:function(e){e.okay?(a(o),i.trackEvent("PostAction",h,o,"",{ReportType:s,Success:!0})):(c(o),i.trackEvent("PostAction",h,o,"",{ReportType:s,Success:!1}))},error:function(e){c(o)}})}}};return{init:e.init,reportEntity:e.reportEntity}}());e.exports=u}).call(t,n(0),n(18))},function(e,t,n){"use strict";var i=function(){this._isSuccess=!1,this._keys={},this.setKey(this.Constants.RESPONSE_MESSAGE,"")};i.Constants={RESPONSE_MESSAGE:"RESPONSE_MESSAGE",RESPONSE_CODE:"RESPONSE_CODE",RESPONSE_DATA:"RESPONSE_DATA"},i.prototype.succeeded=function(e){return this._isSuccess=!0,this.setKey(this.Constants.RESPONSE_MESSAGE,e),this},i.prototype.failed=function(e){return this._isSuccess=!1,this.setKey(this.Constants.RESPONSE_MESSAGE,e),this},i.prototype.isSuccess=function(){return this._isSuccess},i.prototype.setKey=function(e,t){return this._keys[e]=t,this},i.prototype.getKey=function(e){return this._keys[e]},i.prototype.setCode=function(e){return this.setKey(this.Constants.RESPONSE_CODE,e),this},i.prototype.getCode=function(){return this.getKey(this.Constants.RESPONSE_CODE)},i.prototype.setData=function(e){return this.setKey(this.Constants.RESPONSE_DATA,e),this},i.prototype.getData=function(){return this.getKey(this.Constants.RESPONSE_DATA)},i.prototype.setMessage=function(e){return this.setKey(this.Constants.RESPONSE_MESSAGE,e),this},i.prototype.getMessage=function(){return this.getKey(this.Constants.RESPONSE_MESSAGE)},e.exports=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t,n){n(0),n(53),n(54),n(128),n(84),n(129),n(83),n(130),n(52),n(124),n(123),e.exports=n(125)}],[278]);
//# sourceMappingURL=gag.js.map