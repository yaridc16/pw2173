if (self.CavalryLogger) { CavalryLogger.start_js(["qNXTU"]); }

__d("StickerConstants",[],(function a(b,c,d,e,f,g){f.exports={MOBILE_LIKE_STICKER_PACK_ID:"227877430692340",GRAVEYARD_PACK_ID:"604597256247273",LIKE_STICKER_ID:"227878347358915",HOT_LIKE_SMALL_STICKER_ID:"369239263222822",HOT_LIKE_MEDIUM_STICKER_ID:"369239343222814",HOT_LIKE_LARGE_STICKER_ID:"369239383222810",MRU_STICKER_PACK:"599061016853145",SEARCH_PACK_ID:"680229632032514",OZ_PACK_ID:"1456625217993235",SPRITE_PADDING:"24",PayloadSource:{VIEW_ACTION:"view-action"},EMOTICON_PACK_ID:"1471127876485636",DEFAULT_FRAME_RATE:83,TRAY_SIZE:64,THREAD_SIZE:120}}),null);
__d('ChatOpenTab',['csx','Bootloader','ContextualThing','Event','MercuryIDs','MercuryParticipantTypes','Parent','requireWeak'],(function a(b,c,d,e,f,g,h){'use strict';var i=null;c('requireWeak')('FantaTabsReactApp',function(n){return i=n});c('requireWeak')('FantaTabsSlimApp',function(n){return i=n});function j(n,o,p,q){c('Event').listen(n,'click',function(r){if(m.canOpenTab()){q(o,p);return r.kill()}})}function k(n,o,p,q){c('Event').listen(n,'click',function(r){if(m.canOpenTab())q(o,p);})}function l(n){var o=c('ContextualThing').getContext(n);return o&&c('Parent').bySelector(o,"._3qw")!==null}var m={canOpenTab:function n(){return i&&!i.isHidden()},listenOpenEmptyTabDEPRECATED:function n(o,p){j(o,null,p,this._loadAndOpenEmptyFantaTab)},listenOpenThreadDEPRECATED:function n(o,p,q){j(o,p,q,function(r,s){return this._loadAndOpenFantaTab(r,s,q)}.bind(this))},listenOpenUserTabDEPRECATED:function n(o,p,q){if(!l(o))j(o,p,q,function(r){return this._loadAndOpenFantaTab(r,c('MercuryParticipantTypes').USER,q)}.bind(this));},listenOpenUserTabPersistentEventDEPRECATED:function n(o,p,q){if(!l(o))k(o,p,q,function(r){return this._loadAndOpenFantaTab(r,c('MercuryParticipantTypes').USER,q)}.bind(this));},listenOpenPageTabDEPRECATED:function n(o,p,q,r){if(!l(o))j(o,p,r,function(s){return this._loadAndOpenFantaTab(s,c('MercuryParticipantTypes').PAGE,r)}.bind(this));},listenOpenPageTabPersistentEventDEPRECATED:function n(o,p,q,r){if(!l(o))k(o,p,r,function(s){return this._loadAndOpenFantaTab(s,c('MercuryParticipantTypes').PAGE,r)}.bind(this));},_loadAndOpenFantaTab:function n(o,p,q){c('Bootloader').loadModules(["ChatOpenTabEventLogger","FantaTabActions"],function(r,s){if(p===c('MercuryParticipantTypes').USER||p===c('MercuryParticipantTypes').PAGE){var t=c('MercuryIDs').getThreadIDFromUserID(o);s.openTab(t,[q]);r.logUserClickOpen(q,o)}else{s.openTab(o,[q]);r.logClickOpen(q,o)}},'ChatOpenTab')},_loadAndOpenEmptyFantaTab:function n(){c('Bootloader').loadModules(["ChatOpenTabEventLogger","FantaTabActions","MercuryThreads"],function(o,p,q){var r=q.get().createNewLocalThreadGenerateID();p.openTab(r,'jewel_new_message');o.logClickOpen('EmptyTab')},'ChatOpenTab')}};f.exports=m}),null);
__d("NotificationConstants",[],(function a(b,c,d,e,f,g){f.exports={PayloadSourceType:{UNKNOWN:0,USER_ACTION:1,LIVE_SEND:2,ENDPOINT:3,INITIAL_LOAD:4,OTHER_APPLICATION:5,SYNC:6,CLIENT:7}}}),null);
__d('NotificationServerTransport',['AjaxPipeRequest','DOM','setImmediateAcrossTransitions','uniqueID'],(function a(b,c,d,e,f,g){'use strict';var h={},i={},j={},k={},l={};function m(q){if(l[q]==null){l[q]=c('DOM').create('div',{'class':'hidden_elem',id:q});c('DOM').appendContent(document.documentElement,l[q])}return l[q].id}function n(q){return q.reduce(function(r,s){var t=s.targetNumToLoad;return Math.max(r,t)},0)}function o(q){var r=q.getHash();if(k[r]!=null)return;k[r]=c('setImmediateAcrossTransitions')(function(){delete k[r];var s=c('uniqueID')(),t=j[r];delete j[r];if(t==null)return;var u=n(t),v=q.getRequestParams(u);if(v.length<=0){t.forEach(function(z){var aa=z.onCompleted;if(aa)aa();});return}function w(z){var aa=h[r];delete i[s];if(aa.clientRequestID!==s)return;delete h[r];aa.calls.forEach(function(ba){var ca=ba.onError;if(ca)ca(z);});if(j[r]!=null)o(q);}function x(z){var aa=h[r];delete i[s];if(aa.clientRequestID!==s)return;delete h[r];aa.calls.forEach(function(ba){var ca=ba.onCompleted;if(ca)ca();});if(j[r]!=null)o(q);}var y=new (c('AjaxPipeRequest'))('/ajax/pagelet/generic.php/WebNotificationsPayloadPagelet',{data:JSON.stringify(babelHelpers['extends']({},v,{clientRequestID:s}))}).setAllowCrossPageTransition(true).setAllowIrrelevantRequests(true).setAutomatic(false).setCanvasId(m(s)).setErrorHandler(w).setFinallyHandler(x).setJSNonBlock(true).setTransportErrorHandler(w);h[r]={calls:t,clientRequestID:s,transport:y};i[s]=t.map(function(z){return z.onChunkResponse});y.send()})}var p={makeRequest:function q(r,s,t){var u=t.onChunkResponse,v=t.onCompleted,w=t.onError,x=r.getHash(),y={onChunkResponse:u,onCompleted:v,onError:w,targetNumToLoad:s},z=h[x],aa=z?n(z.calls)>=s:false;if(aa){z.calls.push(y)}else{if(j[x]==null)j[x]=[];j[x].push(y);if(z==null)o(r);}return {remove:function ba(){var ca=h[x];if(ca!=null){var da=ca.calls.indexOf(y);if(da!==-1)ca.calls.splice(da,1);if(ca.calls.length===0){ca.transport.abandon();delete h[x];delete i[ca.clientRequestID]}}var ea=j[x];if(ea!=null){var fa=ea.indexOf(y);if(fa!==-1)ea.splice(fa,1);}}}},handleResponseChunk:function q(r,s){var t=i[r];if(t==null)return;t.forEach(function(u){u(s)})}};f.exports=p}),null);
__d('NotificationServerTransportLegacy',['AsyncRequest'],(function a(b,c,d,e,f,g){'use strict';var h={makeRequest:function i(j,k,l){var m=l.onError,n=l.onChunkResponse,o=l.onCompleted,p=true;function q(u){if(!p)return;var v=u.getPayload();try{n(v)}finally{o()}}function r(u){if(!p)return;if(m)m(u);}var s=j.getRequestParams(k);if(s.length<=0){o();return {remove:function u(){}}}var t=new (c('AsyncRequest'))(j.endpointURI).setAllowCrossPageTransition(true).setData(s).setErrorHandler(r).setTransportErrorHandler(r).setHandler(q);t.send();return {remove:function u(){p=false;t.abandon()}}}};f.exports=h}),null);
__d('NotificationsDefaultEndpointURI',[],(function a(b,c,d,e,f,g){'use strict';f.exports='/ajax/notifications/client/get.php'}),null);
__d("arrayStableSort",[],(function a(b,c,d,e,f,g){function h(i,j){return i.map(function(k,l){return {data:k,index:l}}).sort(function(k,l){return j(k.data,l.data)||k.index-l.index}).map(function(k){return k.data})}f.exports=h}),null);
__d('RangedCallbackManager',['CallbackManagerController','arrayStableSort','createObjectFrom'],(function a(b,c,d,e,f,g){function h(i,j,k){'use strict';this.$RangedCallbackManager1=[];this.$RangedCallbackManager2=false;this.$RangedCallbackManager3=false;this.$RangedCallbackManager4={};this.$RangedCallbackManager5=new (c('CallbackManagerController'))(this.$RangedCallbackManager6.bind(this));this.$RangedCallbackManager7=i;this.$RangedCallbackManager8=j;this.$RangedCallbackManager9=k}h.prototype.executeOrEnqueue=function(i,j,k,l,m){'use strict';return this.$RangedCallbackManager5.executeOrEnqueue({start:i,limit:j},k,{strict:!!l,skipOnStrictHandler:m})};h.prototype.unsubscribe=function(i){'use strict';this.$RangedCallbackManager5.unsubscribe(i)};h.prototype.getUnavailableResources=function(i){'use strict';var j=this.$RangedCallbackManager5.getRequest(i),k=[];if(j&&!this.$RangedCallbackManager2){var l=j.request,m=this.$RangedCallbackManager10(j.options),n=l.start+l.limit;for(var o=m.length;o<n;o++)k.push(o);}return k};h.prototype.addResources=function(i){'use strict';i.forEach(function(j){if(!this.$RangedCallbackManager4[j]){this.$RangedCallbackManager4[j]=true;this.$RangedCallbackManager1.push(j);this.$RangedCallbackManager3=null}}.bind(this));this.resortResources();this.$RangedCallbackManager5.runPossibleCallbacks()};h.prototype.addResourcesWithoutSorting=function(i,j){'use strict';var k=this.$RangedCallbackManager1.slice(0,j);k=k.concat(i);k=k.concat(this.$RangedCallbackManager1.slice(j));this.$RangedCallbackManager1=k;Object.assign(this.$RangedCallbackManager4,c('createObjectFrom')(i,true));this.$RangedCallbackManager3=null;this.$RangedCallbackManager5.runPossibleCallbacks()};h.prototype.removeResources=function(i){'use strict';i.forEach(function(j){if(this.$RangedCallbackManager4[j]){this.$RangedCallbackManager4[j]=false;var k=this.$RangedCallbackManager1.indexOf(j);if(k!=-1)this.$RangedCallbackManager1.splice(k,1);}}.bind(this))};h.prototype.removeAllResources=function(){'use strict';this.$RangedCallbackManager1=[];this.$RangedCallbackManager4={}};h.prototype.resortResources=function(){'use strict';this.$RangedCallbackManager1=c('arrayStableSort')(this.$RangedCallbackManager1,function(i,j){return this.$RangedCallbackManager8(this.$RangedCallbackManager7(i),this.$RangedCallbackManager7(j))}.bind(this))};h.prototype.setReachedEndOfArray=function(){'use strict';if(!this.$RangedCallbackManager2){this.$RangedCallbackManager2=true;this.$RangedCallbackManager3=null;this.$RangedCallbackManager5.runPossibleCallbacks()}};h.prototype.hasReachedEndOfArray=function(){'use strict';return this.$RangedCallbackManager2};h.prototype.forceRunCallbacks=function(){'use strict';this.$RangedCallbackManager5.runPossibleCallbacks({force:true})};h.prototype.setError=function(i){'use strict';if(this.$RangedCallbackManager3!==i){this.$RangedCallbackManager3=i;this.$RangedCallbackManager5.runPossibleCallbacks()}};h.prototype.getError=function(i,j,k){'use strict';var l=this.$RangedCallbackManager10({strict:k});return i+j>l.length?this.$RangedCallbackManager3:null};h.prototype.hasResource=function(i){'use strict';return this.$RangedCallbackManager4[i]};h.prototype.getResourceAtIndex=function(i){'use strict';return this.$RangedCallbackManager1[i]};h.prototype.getAllResources=function(){'use strict';return this.$RangedCallbackManager1.concat()};h.prototype.getCurrentArraySize=function(i){'use strict';return this.$RangedCallbackManager10(i).length};h.prototype.$RangedCallbackManager10=function(i){'use strict';var j=this.$RangedCallbackManager1;if(i&&i.strict){var k=i.skipOnStrictHandler||this.$RangedCallbackManager9;if(k)j=j.filter(k);}return j};h.prototype.$RangedCallbackManager6=function(i,j){'use strict';var k=this.$RangedCallbackManager10(j),l=i.start,m=i.start+i.limit,n=!!(j&&j.force);if(!n&&!this.$RangedCallbackManager2&&!this.$RangedCallbackManager3&&m>k.length){return false}else{var o=k.slice(l,m),p=m>k.length?this.$RangedCallbackManager3:null;return [o,p]}};h.prototype.getElementsUntil=function(i){'use strict';var j=[];for(var k=0;k<this.$RangedCallbackManager1.length;k++){var l=this.$RangedCallbackManager7(this.$RangedCallbackManager1[k]);if(this.$RangedCallbackManager8(l,i)>0)break;j.push(this.$RangedCallbackManager1[k])}return j};f.exports=h}),null);
__d('createObjectBy',[],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k={};for(var l=0;l<i.length;l++){var m=i[l],n=j(m,l,i);k[n]=m}return k}f.exports=h}),null);
__d("objectValues",[],(function a(b,c,d,e,f,g){function h(i){return Object.values(i)}f.exports=h}),null);
__d('sortBy',[],(function a(b,c,d,e,f,g){'use strict';function h(i,j){var k=i.map(function(l,m){return {index:m,sortValue:j(l),value:l}});k.sort(function(l,m){var n=l.sortValue,o=m.sortValue;if(n>o)return 1;if(n<o)return -1;return l.index-m.index});return k.map(function(l){return l.value})}f.exports=h}),null);
__d('NotificationStore',['AsyncFeature','BusinessUserConf','ErrorUtils','KeyedCallbackManager','NotificationConstants','NotificationListConfig','NotificationsDefaultEndpointURI','NotificationServerTransport','NotificationServerTransportLegacy','NotificationUpdates','QE2Logger','RangedCallbackManager','createObjectBy','distinctArrayBy','flatMapArray','objectValues','sortBy','sprintf','stableStringify'],(function a(b,c,d,e,f,g){var h={};function i(o,p,q){return o.page_info!=null&&p.classification==q.classification&&p.endpointURI===q.endpointURI&&p.filter==q.filter}function j(o,p){var q={};m.getAllInstances(p.endpointURI).forEach(function(r){var s=void 0;if(i(o,r,p)){r.graphQLPageInfo=o.page_info;s=o}else if(o.payloadsource===c('NotificationConstants').PayloadSourceType.SYNC&&p.endpointURI===c('NotificationsDefaultEndpointURI')&&r.classification==null&&r.filter==null){s=o}else s=babelHelpers['extends']({},o,{nodes:o.nodes&&o.nodes.filter(function(u){return k(u,r)})});if(s.nodes&&s.nodes.length>0){var t=l(r,s);if(t!=null)t.forEach(function(u){q[u]=true});}});c('NotificationUpdates').didUpdateNotifications(Object.keys(q))}function k(o,p){var q=p.classification,r=p.filter,s=p.notifications,t=p.order,u=t.getAllResources();u.length===0;if(u.length>0){var v=u[0],w=s.getResource(v);if(w.creation_time>=o.creation_time)return false;}if(q&&(!o.classifications||!o.classifications.includes(q)))return false;if(r&&r==='read'!==(o.seen_state==='SEEN_AND_READ'))return false;return true}function l(o,p){var q=[],r={};if(p.nodes&&p.nodes.length>0)p.nodes.forEach(function(s){var t=s.alert_id,u=o.notifications.getResource(t);if(!u||u.creation_time<s.creation_time){q.push(t);r[t]=s}});o.notifications.addResourcesAndExecute(r);o.order.addResources(q);return q}m.getInstance=function(o){'use strict';var p=o.classification!=null?o.classification:'_',q=o.filter!=null?o.filter:'_',r='(f)'+q+'(c)'+p,s=m.$EndpointState1[o.endpointURI];if(s==null)m.$EndpointState1[o.endpointURI]=s={};if(s[r]==null)s[r]=new m(o);return s[r]};m.getAllInstances=function(o){'use strict';var p=void 0;if(o!=null){p=[o]}else p=Object.keys(m.$EndpointState1);return c('flatMapArray')(p,function(q){var r=m.$EndpointState1[q];if(r==null){return []}else return c('objectValues')(r);})};function m(o){var p=o.businessUserID,q=o.classification,r=o.endpointURI,s=o.filter;'use strict';this.notifications=new (c('KeyedCallbackManager'))();this.businessUserID=p!=null?p:c('BusinessUserConf').businessUserID;this.classification=q;this.endpointURI=r;this.filter=s;var t=function u(v){var w=this.notifications.getResource(v);return w.creation_time};this.order=new (c('RangedCallbackManager'))(t.bind(this),function(u,v){return v-u});this.graphQLPageInfo=null}m.prototype.getConfig=function(){'use strict';return {businessUserID:this.businessUserID,classification:this.classification,endpointURI:this.endpointURI,filter:this.filter}};m.prototype.getHash=function(){'use strict';return c('stableStringify')(this.getConfig())};m.prototype.getRequestParams=function(o){'use strict';var p=Math.max(0,o-this.order.getAllResources().length);return {businessUserID:this.businessUserID,classification:this.classification,cursor:this.graphQLPageInfo&&this.graphQLPageInfo.end_cursor,filter:this.filter,length:p}};m.$EndpointState1={};c('NotificationUpdates').subscribe('update-notifications',function(o,p){if(p.payloadsource!==c('NotificationConstants').PayloadSourceType.ENDPOINT)j(p,{endpointURI:p.endpoint!=null?p.endpoint:c('NotificationsDefaultEndpointURI')});});var n={getNotifications:function o(p,q,r){var s=m.getInstance(q),t=s.notifications,u=s.order,v=void 0,w=u.executeOrEnqueue(0,p,function(fa){if(r){v=t.executeOrEnqueue(fa,r);var ga=t.getUnavailableResources(v);if(ga.length>0)c('ErrorUtils').reportError(new Error(c('sprintf')('The range for this endpoint contained notification IDs '+'for which we have no payload (Notification IDs: `%s`. '+'Endpoint config: `%s`).',JSON.stringify(ga),JSON.stringify(s.getConfig()))));}});function x(){u.unsubscribe(w);if(v)t.unsubscribe(v);}if(u.getUnavailableResources(w).length===0)return {remove:x};if(!n.canFetchMore(q)){u.forceRunCallbacks();return {remove:x}}var y=s.getHash();if(h[y]==null){h[y]=1}else h[y]++;function z(){h[y]--;if(h[y]===0)u.forceRunCallbacks();}function aa(fa){if(!(fa&&fa.nodes))return;c('NotificationUpdates').handleUpdate(c('NotificationConstants').PayloadSourceType.ENDPOINT,fa,q.filter,q.classification);j(babelHelpers['extends']({},fa,{payloadsource:c('NotificationConstants').PayloadSourceType.ENDPOINT}),q)}function ba(){h[y]--;if(h[y]===0)u.forceRunCallbacks();}var ca=void 0;if(q.endpointURI===c('NotificationsDefaultEndpointURI')&&c('AsyncFeature').__serverHasFeatureImpl(8)&&c('NotificationListConfig').useStreamingTransport){ca=c('NotificationServerTransport')}else ca=c('NotificationServerTransportLegacy');if(q.endpointURI===c('NotificationsDefaultEndpointURI')&&c('AsyncFeature').__serverHasFeatureImpl(8))c('QE2Logger').logExposureForUser('www_notifications_perf_h2_2017');var da=ca.makeRequest(s,p,{onChunkResponse:aa,onCompleted:ba,onError:z}),ea=da.remove;return {remove:function fa(){x();ea()}}},getNotification:function o(p){var q=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],r=q.classification,s=q.endpointURI,t=s===undefined?c('NotificationsDefaultEndpointURI'):s,u=q.filter,v=m.getInstance({classification:r,endpointURI:t,filter:u}),w=v.notifications;return w.getResource(p)},getAllForAllEndpoints:function o(){var p=m.getAllInstances(),q=c('flatMapArray')(p,function(u){var v=this.getAll(u.getConfig());return c('objectValues')(v)}.bind(this)),r=c('sortBy')(q,function(u){return u.creation_time}),s=r.reverse(),t=c('distinctArrayBy')(s,function(u){return u.alert_id});return c('createObjectBy')(t,function(u){return u.alert_id})},getAll:function o(p){var q=m.getInstance(p),r=q.notifications,s=q.order,t={};s.getAllResources().forEach(function(u){var v=r.getResource(u);if(v==null){c('ErrorUtils').reportError(new Error(c('sprintf')('The range for this endpoint contained a notification ID for '+'which we have no payload (Notification ID: `%s`. Endpoint '+'config: `%s`).',u,JSON.stringify(p))))}else t[u]=v;});return t},getCount:function o(p){var q=m.getInstance(p);return q.order.getAllResources().length},canFetchMore:function o(p){var q=m.getInstance(p),r=q.graphQLPageInfo;return !r||!Object.prototype.hasOwnProperty.call(r,'has_next_page')||r.has_next_page},registerEndpoint:function o(p){m.getInstance(p)}};n.registerEndpoint({endpointURI:c('NotificationsDefaultEndpointURI')});f.exports=n}),null);
__d('NotificationTokens',['CurrentUser'],(function a(b,c,d,e,f,g){var h={tokenizeIDs:function i(j){return j.map(function(k){return c('CurrentUser').getID()+':'+k})},untokenizeIDs:function i(j){return j.map(function(k){return k.split(':')[1]})}};f.exports=h}),null);
__d('NotificationUpdates',['Arbiter','AsyncRequest','BusinessUserConf','ChannelConstants','JSLogger','LiveTimer','NotificationConstants','NotificationTokens','createObjectFrom','NotificationStore'],(function a(b,c,d,e,f,g){var h={},i={},j={},k={},l=false,m=[],n=0,o=void 0,p=new (c('Arbiter'))(),q=c('JSLogger').create('notification_updates');function r(){if(n)return;var w=h,x=i,y=j,z=k;h={};i={};j={};k={};if(Object.keys(w).length||l){l=false;t('notifications-updated',w)}if(Object.keys(x).length)t('seen-state-updated',x);if(Object.keys(y).length)t('read-state-updated',y);if(Object.keys(z).length)t('hidden-state-updated',z);m.pop()}function s(){if(m.length)return m[m.length-1];return c('NotificationConstants').PayloadSourceType.UNKNOWN}function t(event,w){v.inform(event,{updates:w,source:s()})}var u=null,v={getserverTime:function w(){return u},setEndPoint:function w(x){o=x},handleUpdate:function w(x,y,z,aa){if(y.nodes&&Array.isArray(y.nodes))y.nodes=this._filterNodesBasedOnBusinessUser(y.nodes,c('BusinessUserConf').businessUserID);if(y.servertime){u=y.servertime;c('LiveTimer').restart(y.servertime)}var ba=y.nodes;if(o&&x===c('NotificationConstants').PayloadSourceType.LIVE_SEND&&ba&&Array.isArray(ba)&&ba.length>0){var ca=c('NotificationStore'),da={classification:aa,endpointURI:o,filter:z};if(ca.getCount(da)>0||!ca.canFetchMore(da))return;new (c('AsyncRequest'))(o).setAllowCrossPageTransition(true).setData({businessUserID:c('BusinessUserConf').businessUserID,classification:aa,filter:z,length:ba.length}).setHandler(function(ea){var fa=ea.getPayload();if(fa==null)return;var ga=fa.nodes;if(ga==null||ga.length===0)return;var ha={};ga.forEach(function(ia){var ja=ia.alert_id;ha[ja]=true});fa.nodes=ba.filter(function(ia){var ja=ia.alert_id;return ha[ja]===true});if(fa.nodes.length>0)this._updateWithPayload(x,fa);}.bind(this)).send()}else this._updateWithPayload(x,y);},_updateWithPayload:function w(x,y){if(Object.keys(y).length)this.synchronizeInforms(function(){m.push(x);var z=babelHelpers['extends']({payloadsource:s()},y);this.inform('update-notifications',z);this.inform('update-seen',z);this.inform('update-read',z);this.inform('update-hidden',z)}.bind(this));},getArbiter:function w(){return p},inform:function w(event,x){return p.inform(event,x)},subscribe:function w(event,x){return p.subscribe(event,x)},didUpdateNotifications:function w(x){Object.assign(h,c('createObjectFrom')(x));l=true;r()},didUpdateSeenState:function w(x){Object.assign(i,c('createObjectFrom')(x));r()},didUpdateReadState:function w(x){Object.assign(j,c('createObjectFrom')(x));r()},didUpdateHiddenState:function w(x){Object.assign(k,c('createObjectFrom')(x));r()},synchronizeInforms:function w(x){n++;try{x()}catch(y){throw y}finally{n--;r()}},_filterNodesBasedOnBusinessUser:function w(x,y){return x.filter(function(z){return y==z.biz_user_id})}};c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('notification_json'),function(w,x){var y=Date.now(),z=x.obj.nodes;if(z){z.forEach(function(ba){ba.receivedTime=y});q.debug('notifications_received',z);var aa=x.obj.servertime;v.handleUpdate(c('NotificationConstants').PayloadSourceType.LIVE_SEND,{nodes:z,servertime:aa})}});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('notifications_seen'),function(w,x){var y=c('NotificationTokens').tokenizeIDs(x.obj.alert_ids),z=x.obj.new_state;v.handleUpdate(c('NotificationConstants').PayloadSourceType.LIVE_SEND,{seenState:c('createObjectFrom')(y,z)})});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('notifications_read'),function(w,x){var y=c('NotificationTokens').tokenizeIDs(x.obj.alert_ids),z=x.obj.new_state;v.handleUpdate(c('NotificationConstants').PayloadSourceType.LIVE_SEND,{readState:c('createObjectFrom')(y,z)})});c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('notification_hidden'),function(w,x){var y=c('NotificationTokens').tokenizeIDs([x.obj.notif_id+'']),z=x.obj.state===1;v.handleUpdate(c('NotificationConstants').PayloadSourceType.LIVE_SEND,{hiddenState:c('createObjectFrom')(y,z)})});f.exports=v}),null);
__d("XNotificationsOptionsController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/notifications\/feedback\/option\/",{notif_id:{type:"Int",required:true},undo:{type:"Bool",defaultValue:false},server_action:{type:"String",required:true},biz_user_id:{type:"Int"}})}),null);
__d('NotificationUserActions',['AsyncRequest','Bootloader','BusinessUserConf','NotificationConstants','NotificationTokens','NotificationUpdates','XNotificationsOptionsController','createObjectFrom','emptyFunction'],(function a(b,c,d,e,f,g){var h=c('NotificationConstants').PayloadSourceType.USER_ACTION,i=false;function j(n){if(c('BusinessUserConf').businessUserID!=null)n.biz_user_id=c('BusinessUserConf').businessUserID;new (c('AsyncRequest'))('/ajax/notifications/mark_read.php').setData(n).setAllowCrossPageTransition(true).send()}function k(n){var o={};n.forEach(function(p,q){o['alert_ids['+q+']']=p});return o}function l(n,o,p,q,r){var s=c('XNotificationsOptionsController').getURIBuilder().setInt('notif_id',c('NotificationTokens').untokenizeIDs([n])[0]).setInt('biz_user_id',c('BusinessUserConf').businessUserID).setBool('undo',q).setString('server_action',r).getURI(),t=function u(v){if(!v.payload)throw new Error('No response from notif option!');c('NotificationUpdates').handleUpdate(h,{hiddenState:c('createObjectFrom')([n],!v.payload.visible)});if(v.payload)o(v.payload);};new (c('AsyncRequest'))(s).setHandler(t||c('emptyFunction')).setErrorHandler(p||c('emptyFunction')).send()}var m={markNotificationsAsSeen:function n(o){var p=document.getElementById('notificationsCountValue'),q=null;if(p)q=p.textContent;c('NotificationUpdates').handleUpdate(h,{seenState:c('createObjectFrom')(o)});var r=c('NotificationTokens').untokenizeIDs(o),s=k(r);s.seen=true;if(q)s.badgeCount=q;j(s)},setNextIsFromReadButton:function n(o){i=o},markNotificationsAsRead:function n(o,p){c('NotificationUpdates').handleUpdate(h,{readState:c('createObjectFrom')(o,true)});var q=c('NotificationTokens').untokenizeIDs(o),r=k(q);if(i){r.from_read_button=true;i=false}if(p)r.source_view=p;j(r)},markNotificationsAsUnread:function n(o,p){c('NotificationUpdates').handleUpdate(h,{readState:c('createObjectFrom')(o,false)});var q=c('NotificationTokens').untokenizeIDs(o),r=k(q);if(i){r.from_read_button=true;i=false}r.unread=true;if(p)r.source_view=p;j(r)},markAllNotificationsAsRead:function n(){c('Bootloader').loadModules(["NotificationSeenState"],function(o){var p=o.getUnreadIDs();if(p.length>0)c('NotificationUpdates').handleUpdate(h,{readState:c('createObjectFrom')(p)});var q={read:true};if(i){q.from_read_button=true;i=false}j(q)},'NotificationUserActions')},sendNotifOption:function n(o,p,q,r){l(o,p,q,false,r)},undoNotifOption:function n(o,p,q,r){l(o,p,q,true,r)}};f.exports=m}),null);
__d('Spotlight',['csx','cx','Arbiter','ArbiterMixin','DOM','JSXDOM','Layer','LayerAutoFocus','LayerTabIsolation','ModalLayer','Vector','classWithMixins','joinClasses','mixin'],(function a(b,c,d,e,f,g,h,i){var j,k;j=babelHelpers.inherits(l,c('classWithMixins')(c('Layer'),c('mixin')(c('ArbiterMixin'))));k=j&&j.prototype;function l(n,o){'use strict';k.constructor.call(this,n,o);this.stageMinSize=new (c('Vector'))(0,0);this.stagePadding=new (c('Vector'))(0,0)}l.prototype._buildWrapper=function(n,o){'use strict';var p=c('joinClasses')("_n8"+(n.wash==='dark'||!n.wash?' '+"_3qx":'')+(n.wash==='xui'?' '+"_4-hy":''),n.rootClassName);return c('JSXDOM').div({className:p},c('JSXDOM').div({className:"_n9"},o))};l.prototype._getDefaultBehaviors=function(){'use strict';return k._getDefaultBehaviors.call(this).concat([m,c('LayerAutoFocus'),c('LayerTabIsolation'),c('ModalLayer')])};l.prototype.getContentRoot=function(){'use strict';if(!this._content)this._content=c('DOM').find(this.getRoot(),"div._n3");return this._content};l.prototype.configure=function(n){'use strict';if(n.stageMinSize)this.stageMinSize=n.stageMinSize;if(n.stagePadding)this.stagePadding=n.stagePadding;};l.prototype.onContentLoaded=function(){'use strict';this.inform('content-load')};l.prototype.updatePermalink=function(n){'use strict';this.inform('permalinkchange',n)};Object.assign(l.prototype,{stageMinSize:null,stagePadding:null});function m(n){'use strict';this._layer=n}m.prototype.enable=function(){'use strict';this._subscription=this._layer.subscribe(['show','hide'],function(n,o){if(n==='show'){c('Arbiter').inform('layer_shown',{type:'Spotlight'})}else c('Arbiter').inform('layer_hidden',{type:'Spotlight'});})};m.prototype.disable=function(){'use strict';this._subscription.unsubscribe();this._subscription=null};Object.assign(m.prototype,{_subscription:null});f.exports=l}),null);
__d('Spotlight.react',['LayerAutoFocusReact','LayerHideOnBlur','LayerHideOnEscape','LayerRefocusOnHide','ReactLayer','Spotlight','React'],(function a(b,c,d,e,f,g){var h=c('React').PropTypes,i=c('ReactLayer').createClass({propTypes:{causalElement:h.instanceOf(HTMLElement),onHide:h.func,rootClassName:h.string,shown:h.bool,wash:h.oneOf(['light','xui','dark'])},getDefaultEnabledBehaviors:function j(){return {hideOnBlur:c('LayerHideOnBlur'),hideOnEscape:c('LayerHideOnEscape'),refocusOnHide:c('LayerRefocusOnHide'),autoFocus:c('LayerAutoFocusReact')}},createLayer:function j(k){var l=this.enumerateBehaviors(this.props.behaviors),m={addedBehaviors:l,rootClassName:this.props.rootClassName,wash:this.props.wash},n=new (c('Spotlight'))(m,k);n.setCausalElement(this.props.causalElement);n.conditionShow(this.props.shown);if(this.props.onBeforeHide)n.subscribe('beforehide',this.props.onBeforeHide);if(this.props.onHide)n.subscribe('hide',this.props.onHide);return n},receiveProps:function j(k){if(this.layer){this.layer.setCausalElement(k.causalElement);this.layer.conditionShow(k.shown)}}});f.exports=i}),null);
__d('FBRTCAvailability',['ChannelConstants','PresenceStatus'],(function a(b,c,d,e,f,g){'use strict';var h={isCallable:function i(j){var k=c('PresenceStatus').getCapabilities(j),l=c('ChannelConstants').CAPABILITY_VOIP_INTEROP;return !!(k&l)}};f.exports=h}),null);
__d('FBRTCCallActions',['FBRTCDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({START_CALL:null}),i={Types:h,startCall:function j(k,l,m,n){c('FBRTCDispatcher').dispatch({type:h.START_CALL,peerID:k,callID:l,isCaller:m,audioOnly:n})}};f.exports=i}),null);
__d('FBRTCConfig',['RTCSignalingExperiments'],(function a(b,c,d,e,f,g){var h=void 0,i=void 0,j=0,k={},l={setConfig:function m(n,o,p,q,r){k=n;j=o;h=q;i=r},isVCEndpointCall:function m(){return h},canPeerUseV2:function m(){return i},getPeerID:function m(){return j},statsInterpreterConfig:function m(){return {rtt_weight:2,frr_weight:800,plr_weight:500,score_threshold:1000,bad_score_count:3}},settingsEnabled:function m(){return k.enable_settings},shouldAutoDisableVideo:function m(){return false},unsupportedBrowserUrl:function m(){if(k.troubleshooting_urls&&k.troubleshooting_urls.unsupported_browser)return k.troubleshooting_urls.unsupported_browser;return 'https://www.facebook.com/help/211644178877843'},userMediaErrorUrl:function m(){if(k.troubleshooting_urls&&k.troubleshooting_urls.user_media_error)return k.troubleshooting_urls.user_media_error;return 'https://www.facebook.com/help/232232800134371'},userMediaPermissionErrorUrl:function m(){if(k.troubleshooting_urls&&k.troubleshooting_urls.user_media_permission_error)return k.troubleshooting_urls.user_media_permission_error;return 'https://www.facebook.com/help/232232800134371'},supportedSignalingExperiments:function m(){return c('RTCSignalingExperiments').getLocal()},isMessengerDotCom:function m(){return k.is_messenger_dot_com},useMessengerCallUI:function m(){return k.messenger_call_ui},shouldCreateDataChannel:function m(){return k.data_channel},disableURLManager:function m(){return k.disable_url_manager},useCurrentWindow:function m(){return k.use_current_window}};f.exports=l}),null);
__d('FBRTCStruct',[],(function a(b,c,d,e,f,g){var h=function j(k,l,m){var n,o;if(typeof k=='string'||k instanceof String){o=k;n=k}else for(var p in k)if(Object.prototype.hasOwnProperty.call(k,p))if(p==='index'){m=k[p]}else{o=p;n=k[p]}l[o]=m;l.strNames[m]=n};function i(j){'use strict';this.strNames=[];for(var k=0;k<j.length;k++)h(j[k],this,k);}f.exports=i}),null);
__d('FBRTCConstants',['FBRTCStruct','keyMirror'],(function a(b,c,d,e,f,g){var h={OFFER:'offer',ANSWER:'answer',ICE_CANDIDATE:'ice_candidate',OK:'ok',PING:'ping',PING_ACK:'ping_ack',HANGUP:'hang_up',OTHER_DISMISS:'other_dismiss',MSG_ACK:'msg_ack',PRANSWER:'pranswer',ICERESTART_OFFER:'icerestart_offer',ICERESTART_ANSWER:'icerestart_answer',PCRESTART_OFFER:'pcrestart_offer',PCRESTART_ANSWER:'pcrestart_answer',SDP_UPDATE:'sdp_update',OFFER_ACK:'offer_ack',OFFER_NACK:'offer_nack',ANSWER_ACK:'answer_ack',SET_VIDEO:'set_video',VIDEO_REQUEST:'video_request',ACK:'ack'},i={CHILD_WINDOW_READY:'rtc_child_window_ready',CHILD_WINDOW_START_CALL:'rtc_child_window_start_call',CHILD_WINDOW_MESSAGE:'rtc_child_window_message'},j={DIRECT_VIDEO:'direct_video',ESCALATED:'escalated',ESCALATION_DECLINED:'escalation_declined',VOIP:'voip'},k={LL_NONE:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5},l={AUDIO_ONLY:'audio_only',AUDIO_VIDEO:'audio_video',SCREEN_CONTENT:'screen'},m=c('keyMirror')({NO_VIDEO:null,LQ_VIDEO:null,SD_VIDEO:null,HD_VIDEO:null,FHD_VIDEO:null,CUSTOM_VIDEO:null,CUSTOM_VIDEO_STREAM_SIZE:null}),n=new (c('FBRTCStruct'))([{IGNORE_CALL:'IgnoreCall'},{HANGUP_CALL:'HangupCall'},{IN_ANOTHER_CALL:'InAnotherCall'},{ACCEPT_AFTER_HANGUP:'CallEndAcceptAfterHangUp'},{NO_ANSWER_TIMEOUT:'NoAnswerTimeout'},{INCOMING_TIMEOUT:'IncomingTimeout'},{OTHER_INSTANCE_HANDLED:'OtherInstanceHandled'},{SIGNALING_MESSAGE_FAILED:'SignalingMessageFailed'},{CONNECTION_DROPPED:'ConnectionDropped'},{CLIENT_INTERRUPTED:'ClientInterrupted'},{WEBRTC_ERROR:'WebRTCError'},{CLIENT_ERROR:'ClientError'},{NO_PERMISSION:'NoPermission'},{OTHER_NOT_CAPABLE:'OtherNotCapable'},{NO_UI_ERROR:'NoUIShown'},{UNSUPPORTED_VERSION:'VersionUnsupported'},{CALLER_NOT_VISIBLE:'CallerNotVisible'},{CARRIER_BLOCKED:'CarrierBlocked'},{OTHER_CARRIER_BLOCKED:'OtherCarrierBlocked'}]),o={REMOTE_PEER_HANGUP:'CollabRemotePeerHangup',REMOTE_PEER_REJECT:'CollabRemotePeerReject',CLOSED_BY_MCU:'CollabClosedByMcu',CLOSED_AS_STALE:'CollabClosedAsStale',CALL_INITIALIZATION_FAILED:'CollabCallInitializationFailed',SIP_CONNECTION_INITIALIZATION_FAILED:'CollabSipConnectionInitializationFailed',LOST_MCU_CONNECTION:'CollabLostMcuConnection',MCU_NO_AUDIO_STREAM:'CollabMcuNoAudioStream',MCU_INVALID_STREAM_CONFIGURATION:'CollabMcuInvalidStreamConfiguration',LOST_MCU_THRIFT_CONNECTION:'CollabLostMcuThriftConnection',LOST_SIP_ADAPTER_THRIFT_CONNECTION:'CollabLostSipAdapterThriftConnection',UNKNOWN:'CollabUnknown'},p={TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10},q={ONE_HOUR:'1hour',UNTIL_EIGHT_AM:'8am',ALWAYS:'always'},r=c('keyMirror')({VIDEO:null,AUDIO:null,SCREEN_SHARE:null}),s={CUSTOM:'custom',MULTIWAY:'multiway',P2P:'p2p'},t={NEW:'new',CHECKING:'checking',CONNECTED:'connected',completed:'completed',FAILED:'failed',DISCONNECTED:'disconnected',CLOSED:'closed'},u=c('keyMirror')({DOMINANT_SPEAKER:null,GRID:null,ONE_TO_ONE:null,STRIP:null}),v={PayloadType:h,ChildWindowMessageType:i,CallType:j,UploadLogLevel:k,StreamType:l,VideoQuality:m,CallEndReason:n,CollabCallEndSubreason:o,UIEventType:p,CallBlockingConstants:q,IncomingCallDialogTypes:r,SignalingProtocol:s,IceConnectionState:t,GroupVideoViewLayout:u,convertFromUploadLogLevel:function w(x){switch(x){case k.LL_DEBUG:return 'd';case k.LL_BASIC:return 'b';case k.LL_WARNING:return 'w';case k.LL_INFO:return 'i';case k.LL_VERBOSE:return 'v';case k.LL_NONE:default:return null;}},convertToUploadLogLevel:function w(x){switch(x){case 'd':return k.LL_DEBUG;case 'b':return k.LL_BASIC;case 'w':return k.LL_WARNING;case 'i':return k.LL_INFO;case 'v':return k.LL_VERBOSE;default:return k.LL_NONE;}},uploadLogLevelString:function w(x){switch(x){case k.LL_BASIC:return 'basic';case k.LL_DEBUG:return 'debug';case k.LL_WARNING:return 'warning';case k.LL_INFO:return 'info';case k.LL_VERBOSE:return 'verbose';default:return '';}},endCallReasonFromString:function w(x){return n.strNames.indexOf(x)},callEndReasonString:function w(x){if(x<0||x>n.strNames.length)return 'Unknown';return n.strNames[x]},fullCallEndReasonString:function w(x,y){return this.callEndReasonString(x)+'_'+(y?'remote':'local')}};f.exports=v}),null);
__d("FBRTCVersionDetection",[],(function a(b,c,d,e,f,g){var h={isChrome:function i(){return !!navigator.webkitGetUserMedia},isFirefox:function i(){return !!navigator.mozGetUserMedia},webrtcVersion:function i(){if(this.isFirefox())return parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10);if(this.isChrome()){var j=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(j!==null){return parseInt(j[2],10)}else return 999;}return 0}};f.exports=h}),null);
__d('FBRTCUtils',['emptyFunction','randomInt','AsyncRequest','CurrentUser','FBID','FBRTCConfig','FBRTCConstants','FBRTCVersionDetection','RTCConfig','UserAgent'],(function a(b,c,d,e,f,g){var h=6000,i=window.URL||window.webkitURL,j=typeof document.createElement('video').setSinkId==='function',k={attachMediaStream:function l(m,n){if(window.webkitRTCPeerConnection){if(m.src)i.revokeObjectURL(m.src);if(n){m.src=i.createObjectURL(n)}else m.src='';}else{m.mozSrcObject=n;if(n)m.play();}},reattachMediaStream:function l(m,n){if(window.webkitRTCPeerConnection){m.src=n.src}else{m.mozSrcObject=n.mozSrcObject;m.play()}},generateRandomInt:function l(){return c('randomInt')(0,4294967294)+1},aboutEqual:function l(m,n){return m-n<.01&&n-m<.01},getUploadLogLevel:function l(m){return Math.max(this.getLocalUploadLogLevel(),m)},getLocalUploadLogLevel:function l(){return c('CurrentUser').isEmployee()?c('FBRTCConstants').UploadLogLevel.LL_DEBUG:c('FBRTCConstants').UploadLogLevel.LL_NONE},sendServerRequest:function l(m,n,o,p,q,r){n=n||c('emptyFunction');o=o||c('emptyFunction');p=p||false;q=q||h;r=r||{};var s=new (c('AsyncRequest'))().setURI(m).setData(r).setAllowCrossPageTransition(true).setHandler(n).setErrorHandler(o).setTimeoutHandler(q,function(){o()});if(p)s.setOption('asynchronous_DEPRECATED',false);s.send()},supportsMultipleStreamsPlanB:function l(){return (c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera'))&&c('FBRTCVersionDetection').webrtcVersion()>=34},supportsSetSink:function l(){return j},isPeerVCEndpoint:function l(m){var n=c('FBRTCConfig').isVCEndpointCall();return n!==undefined?n:m&&!c('FBID').isUser(m)&&c('RTCConfig').CollabVCEndpointsVideoCallGK}};f.exports=k}),null);
__d('FBRTCScreenSharingLogger',['Log','MarauderLogger','formatDate','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h='webrtc_screen_sharing',i=c('keyMirror')({P2P_VIDEO_CALL:null,DIRECT_SCREEN_SHARING:null}),j=c('keyMirror')({screen_sharing_action:null,screen_sharing_error:null}),k=c('keyMirror')({PEER_ID:null,SESSION_ID:null,CONTEXT_TYPE:null,CONTENT:null}),l=c('keyMirror')({SCREEN_SHARING_TOGGLED:null,SCREEN_SHARING_CANCELLED:null,SCREEN_SHARING_ENABLED:null,SCREEN_SHARING_DISABLED:null,SCREEN_SHARING_EXT_DIALOG:null,SCREEN_SHARING_EXT_LINK:null,SCREEN_SHARING_DIALOG_SUCCESS:null,SCREEN_SHARING_DIALOG_CANCEL:null}),m=null;n.getInstance=function(){if(!m)m=new n();return m};n.prototype.logAction=function(o,p,q,r,s){var t={};t[j.screen_sharing_action]=q;t[k.PEER_ID]=o;t[k.SESSION_ID]=p;t[k.CONTEXT_TYPE]=this.$FBRTCScreenSharingLogger1(r);t[k.CONTENT]=s;this.$FBRTCScreenSharingLogger2(j.screen_sharing_action,t);this.logToConsole(o,p,q)};n.prototype.logError=function(o,p,q,r){var s={};s[k.PEER_ID]=o;s[k.SESSION_ID]=p;s[k.CONTEXT_TYPE]=this.$FBRTCScreenSharingLogger1(q);s[k.CONTENT]=r;this.$FBRTCScreenSharingLogger2(j.screen_sharing_error,s);this.logToConsole(o,p,r)};n.prototype.logToConsole=function(o,p,q){};n.prototype.$FBRTCScreenSharingLogger1=function(o){return o?i.DIRECT_SCREEN_SHARING:i.P2P_VIDEO_CALL};n.prototype.$FBRTCScreenSharingLogger2=function(o,p){c('MarauderLogger').log(o,h,p)};function n(){}n.Action=l;f.exports=n}),null);
__d('FBRTCScreenSharingUtils',['Promise','FBRTCScreenSharingLogger','FBRTCStruct','FBRTCVersionDetection','RTCConfig','FBRTCSupport'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('FBRTCStruct'))(['UNKNOWN','INSTALLED']),i=h.UNKNOWN,j={RECIPIENT:'SC_CONTENT_SCRIPT',isScreenSharingSupported:function k(){return c('RTCConfig').ScreenSharingGK},isSupportedBrowser:function k(){return c('FBRTCVersionDetection').isChrome()&&c('FBRTCVersionDetection').webrtcVersion()>=34},canUserReceiveScreenSharing:function k(){return c('RTCConfig').ReceiveScreenGK&&c('FBRTCSupport').isOSSupported()&&j.isSupportedBrowser()},isExtensionInstalled:function k(){return i===h.INSTALLED},getExtensionStatus:function k(){return i},checkExtensionInstalled:function k(){if(this.isExtensionInstalled())return c('Promise').resolve();var l=void 0,m=new (c('Promise'))(function(n){l=function o(p){var q=p.origin,r=p.data;if(q!=window.location.origin||!r.type)return;if(r.type==='SC_EXT_INSTALLED'){window.removeEventListener('message',l);i=h.INSTALLED;n()}};window.addEventListener('message',l)});return c('Promise').race([m,this._pokeExtension()])['catch'](function(n){window.removeEventListener('message',l);return c('Promise').reject(n)})},_pokeExtension:function k(){var l=arguments.length<=0||arguments[0]===undefined?13:arguments[0];return new (c('Promise'))(function(m,n){var o=setInterval(function(){setTimeout(function(){if(i===h.UNKNOWN)window.postMessage({recipient:j.RECIPIENT,type:'SC_IS_EXT_INSTALLED',text:'is extension installed'},'*');});if(l>0){l--}else{clearInterval(o);n('extension unavailable')}},200)})},logFailedAttempt:function k(l,m){c('FBRTCScreenSharingLogger').getInstance().logAction(l,m,c('FBRTCScreenSharingLogger').Action.SCREEN_SHARING_TOGGLED,this._isDirect,'feature not available')}};f.exports=j}),null);
__d('RTCSignalingExperiments',['FBRTCUtils','FBRTCScreenSharingUtils','Set','UserAgent'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$RTCSignalingExperiments2=new (c('Set'))();this.$RTCSignalingExperiments1=new (c('Set'))(h.getLocal());if(i)this.$RTCSignalingExperiments2=new (c('Set'))(i);}h.prototype.getLocal=function(){return Array.from(this.$RTCSignalingExperiments1)};h.prototype.setRemote=function(i){if(!i)return this;return new h(i)};h.prototype.getRemote=function(){return Array.from(this.$RTCSignalingExperiments2)};h.prototype.support=function(i){return this.localSupport(i)&&this.remoteSupport(i)};h.prototype.localSupport=function(i){return this.$RTCSignalingExperiments1.has(i)};h.prototype.remoteSupport=function(i){return this.$RTCSignalingExperiments2.has(i)};h.getLocal=function(){var i=[];if(c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera'))i.push('sdp_update');if(c('FBRTCUtils').supportsMultipleStreamsPlanB())i.push('multiple_streams_plan_b');if(c('FBRTCScreenSharingUtils').canUserReceiveScreenSharing())i.push('screen_sharing');return i};f.exports=h}),null);
__d('FBRTCCallControlActions',['FBRTCDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({ACCEPT_ESCALATION:null,HANG_UP:null,PARENT_WINDOW_START_CALL:null,TOGGLE_FULL_SCREEN:null,TOGGLE_MUTE_AUDIO:null,TOGGLE_MUTE_VIDEO:null,TOGGLE_SCREEN_SHARING:null,TOGGLE_SELF_VIEW:null,SHOW_SETTINGS:null,START_CALL:null,DECLINE_ESCALATION:null,RECEIVED_SIGNALING_MESSAGE:null,RESET_CALL:null,OPEN_SCREEN_IN_NEW:null,CLOSE_STANDALONE_SCREEN:null,REDIAL_CALL:null}),i={Types:h,hangUp:function j(){c('FBRTCDispatcher').dispatch({type:h.HANG_UP})},toggleMuteAudio:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_MUTE_AUDIO})},toggleMuteVideo:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_MUTE_VIDEO})},toggleFullScreen:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_FULL_SCREEN})},toggleSelfView:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_SELF_VIEW})},showSettings:function j(){c('FBRTCDispatcher').dispatch({type:h.SHOW_SETTINGS})},toggleScreenSharing:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_SCREEN_SHARING})},startCall:function j(){c('FBRTCDispatcher').dispatch({type:h.START_CALL})},openScreenInNewWindow:function j(){c('FBRTCDispatcher').dispatch({type:h.OPEN_SCREEN_IN_NEW})},receivedSignalingMessage:function j(k){c('FBRTCDispatcher').dispatch({type:h.RECEIVED_SIGNALING_MESSAGE,message_type:k.msgType,message:k})},acceptEscalation:function j(){c('FBRTCDispatcher').dispatch({type:h.ACCEPT_ESCALATION})},declineEscalation:function j(){c('FBRTCDispatcher').dispatch({type:h.DECLINE_ESCALATION})},resetCall:function j(k){c('FBRTCDispatcher').dispatch({type:h.RESET_CALL,trigger:k})},redialCall:function j(){c('FBRTCDispatcher').dispatch({type:h.REDIAL_CALL})},parentWindowStartCall:function j(){c('FBRTCDispatcher').dispatch({type:h.PARENT_WINDOW_START_CALL})}};f.exports=i}),null);
__d('FBRTCLogger',['Log','LogHistory','MarauderLogger','formatDate','pageID'],(function a(b,c,d,e,f,g){var h='webrtc',i='sent_message',j='received_message',k='send_succeeded',l='send_failed',m='info',n='call_action',o='client_event',p='client_error',q='type',r='msg_id',s='ack_msg_id',t='call_id',u='from',v='to',w='content',x='tag',y='peer_id',z='error_code',aa='trigger',ba='endcallstats',ca=null;da.getInstance=function(){'use strict';if(!ca)ca=new da();return ca};function da(){'use strict';this.$FBRTCLogger1=c('LogHistory').getInstance(h)}da.prototype.logToConsole=function(ea){'use strict';var fa='Console';this.$FBRTCLogger2(null,null,fa,ea);this.$FBRTCLogger1.log(fa,ea)};da.prototype.logReceivedMessage=function(ea,fa,ga){'use strict';var ha={};ha[u]=ea;ha[t]=fa;ha[q]=ga.type;ha[r]=ga.msg_id;if(ga.sdp)ha[w]=ga.sdp;if(ga.ack_id)ha[s]=ga.ack_id;this.$FBRTCLogger3(j,ha);this.$FBRTCLogger2(ea,fa,'Received',ga.type+', '+ga.msg_id)};da.prototype.logSentMessage=function(ea,fa,ga){'use strict';var ha={};ha[v]=ea;ha[t]=fa;ha[q]=ga.type;ha[r]=ga.msg_id;if(ga.sdp)ha[w]=ga.sdp;if(ga.ack_id)ha[s]=ga.ack_id;this.$FBRTCLogger3(i,ha);this.$FBRTCLogger2(ea,fa,'Sent',ga.type+', '+ga.msg_id)};da.prototype.logSentMessageSuccess=function(ea,fa,ga,ha){'use strict';var ia={};ia[y]=ea;ia[t]=fa;ia[q]=ga;ia[r]=ha;this.$FBRTCLogger3(k,ia)};da.prototype.logSentMessageFailure=function(ea,fa,ga,ha,ia){'use strict';var ja={};ja[y]=ea;ja[t]=fa;ja[q]=ga;ja[r]=ha;ja[z]=ia;this.$FBRTCLogger3(l,ja);this.$FBRTCLogger2(ea,fa,'Send Failed',ga+', '+ia)};da.prototype.logCallAction=function(ea,fa,ga,ha,ia){'use strict';var ja={};ja[y]=ea;ja[t]=fa;ja[n]=ga;ja[w]=ha;if(ia)ja[aa]=ia;this.$FBRTCLogger3(n,ja);this.$FBRTCLogger2(ea,fa,'CallAction',ga+', '+ha)};da.prototype.logEvent=function(ea,fa,event){'use strict';var ga={};ga[y]=ea;ga[t]=fa;ga[w]=event;this.$FBRTCLogger3(o,ga);this.$FBRTCLogger2(ea,fa,'Event',event)};da.prototype.logInfo=function(ea,fa,ga){'use strict';var ha={};ha[y]=ea;ha[t]=fa;ha[w]=ga;this.$FBRTCLogger3(m,ha);this.$FBRTCLogger2(ea,fa,'Info',ga)};da.prototype.logError=function(ea,fa,ga){'use strict';var ha={};ha[y]=ea;ha[t]=fa;ha[w]=ga;this.$FBRTCLogger3(p,ha);this.$FBRTCLogger2(ea,fa,'Error',ga)};da.prototype.logErrorWithoutID=function(ea){'use strict';this.logError(null,null,ea)};da.prototype.logEndCallSummary=function(ea){'use strict';if(!ea)return;var fa={};fa[y]=ea.peerID;fa[t]=ea.callID;fa[x]=ba;fa[w]=ea.toString();var ga=ea.getExtraInfo();for(var ha in ga)if(Object.prototype.hasOwnProperty.call(ga,ha))fa[ha]=ga[ha];this.$FBRTCLogger3(m,fa);this.$FBRTCLogger2(ea.peerID,ea.callID,'Call Summary',fa)};da.prototype.$FBRTCLogger3=function(ea,fa){'use strict';fa.page_id=c('pageID');this.$FBRTCLogger1.log(ea,fa);c('MarauderLogger').log(ea,h,fa)};da.prototype.$FBRTCLogger2=function(ea,fa,ga,ha){'use strict'};da.CallAction={START_CALL:'start_call',RECEIVED_CALL:'received_call',ANSWER_CALL:'answer_call',END_CALL:'end_call',DENIED_PERMISSION:'denied_permission',SET_MUTE:'set_mute',SET_VIDEO_ON:'set_video_on',SET_SELF_VIEW_ON:'set_self_view_on',SET_FULLSCREEN_ON:'set_fullscreen_on',START_SKYPE:'start_skype',TRY_NEW:'try_new',OPEN_POPUP:'open_popup',POPUP_OPENED:'popup_opened',AUTO_DISABLE_VIDEO:'auto_disable_video',FAILED_GETTING_URI:'failed_getting_uri',OLD_URI:'old_uri',USER_SETTINGS_CHANGED:'user_settings_changed'};da.Trigger={ADMIN_MESSAGE:'admin_message',CHAT_TAB_ICON:'chat_tab_icon',CHAT_TAB_ICON_TOUR:'chat_tab_icon_tour',CHAT_TAB_VOICE_ICON:'chat_tab_voice_icon',SKYPE_DEPRECATION_DIALOG:'skype_deprecation_dialog',REDIAL_BUTTON:'redial_button',RETURN_CALL:'return_call',WEB_MESSENGER:'web_messenger',POPUP_CALL_START_BUTTON:'popup_start_call_button',TIMELINE_PROFILE:'timeline_profile',UNKNOWN:'unknown',RESET_CALL:'install_screen_sharing_ext_dialog',MULTIWAY_CHAT_TAB_SHEET_JOIN_CALL_BUTTON:'multiway_chat_tab_sheet_join_call_button',MULTIWAY_POPUP_START_CALL_BUTTON:'multiway_popup_start_call_button',MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:'multiway_thread_header_audio_button',MULTIWAY_THREAD_HEADER_VIDEO_BUTTON:'multiway_thread_header_video_button',MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:'multiway_thread_header_join_audio_call_audio_button',MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:'multiway_thread_header_join_audio_call_video_button',MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:'multiway_thread_header_join_video_call_audio_button',MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON:'multiway_thread_header_join_video_call_video_button',MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON:'multiway_thread_list_join_call_button'};da.Key={DEVICE_INFO:'device_info',RATING:'rating5',RATING_SHOWN:'rating_shown',SURVEY_CHOICE:'survey_choice',SURVEY_DETAILS:'survey_details',SURVEY_SHOWN:'survey_shown',INITIATED_BY_PAGE_ID:'initiated_by_page_id',PEER_IS_MOBILE:'peer_is_mobile'};f.exports=da}),null);
__d('FBRTCLocalMessageQueue',['CacheStorage','FBRTCLogger','Map','RTCConfig'],(function a(b,c,d,e,f,g){var h='localstorage',i='RTC_',j='offer',k='offer_msg',l='data_',m=30*1000,n=15*1000,o=500,p=new (c('Map'))();function q(){'use strict';this.$FBRTCLocalMessageQueue1=c('FBRTCLogger').getInstance()}q.prototype.enqueueOffer=function(r,s){'use strict';var t=this.$FBRTCLocalMessageQueue2(r,k);this.$FBRTCLocalMessageQueue3(t,j,s)};q.prototype.getOffer=function(r){'use strict';var s=this.$FBRTCLocalMessageQueue2(r,k);return this.$FBRTCLocalMessageQueue4(s,j)};q.prototype.removeOffer=function(r){'use strict';var s=this.$FBRTCLocalMessageQueue2(r,k);s.remove(j)};q.prototype.enqueueMessage=function(r,s,t,u){'use strict';var v=l+t.toString(),w=p.get(r)||new (c('Map'))();w.set(v,u);p.set(r,w);this.$FBRTCLocalMessageQueue1.logToConsole('Queued '+v)};q.prototype.drainQueue=function(r,s){'use strict';var t=p.get(r)||new (c('Map'))(),u,v;for(var w=t,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++]}else{y=w.next();if(y.done)break;z=y.value}var aa=z,u=aa[0],v=aa[1];void u;s(v)}p.set(r,new (c('Map'))())};q.prototype.enableDequeuing=function(r,s,t,u){'use strict';if(u===undefined)u=n;this.$FBRTCLocalMessageQueue5(r,s,t,u)};q.prototype.$FBRTCLocalMessageQueue5=function(r,s,t,u){'use strict';var v=this.$FBRTCLocalMessageQueue2(r,s),w=v.keys(),x=w.length;for(var y=0;y<x;y++){var z=this.$FBRTCLocalMessageQueue6(v,w[y]);if(z&&t)t(z);}this.$FBRTCLocalMessageQueue1.logToConsole('Dequeued '+x+' ('+r+') with '+u+' left)');if(u>0){u-=o;setTimeout(function(){this.$FBRTCLocalMessageQueue5(r,s,t,u)}.bind(this),o)}};q.prototype.$FBRTCLocalMessageQueue3=function(r,s,t){'use strict';var u={__t:Date.now(),__d:t};r.set(s,u)};q.prototype.$FBRTCLocalMessageQueue4=function(r,s){'use strict';var t=r.get(s);if(t&&this.$FBRTCLocalMessageQueue7(t)){return t.__d}else if(t)r.remove(s);return null};q.prototype.$FBRTCLocalMessageQueue6=function(r,s){'use strict';var t=this.$FBRTCLocalMessageQueue4(r,s);if(t!==null){r.remove(s);return t}return null};q.prototype.$FBRTCLocalMessageQueue7=function(r){'use strict';return Date.now()-r.__t<m};q.prototype.$FBRTCLocalMessageQueue2=function(r,s){'use strict';return new (c('CacheStorage'))(h,''+i+r+'_'+s+'_')};f.exports=q}),null);
__d('FBRTCMessageListener',['invariant','Arbiter','ChannelConstants','FBRTCConstants','FBRTCCallControlActions','FBRTCLocalMessageQueue','FBRTCSupport','RTCConfig','guid','mixInEventEmitter'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('FBRTCConstants').ChildWindowMessageType,j=45*1000,k=[],l=null,m=null,n=null,o=null,p=null,q=false,r=null,s=void 0,t={init:function u(v,w){if(q)return;q=true;c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc'),function(y,z){this._onMessage(z.obj)}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc_offer'),function(y,z){this._onMessage(z.obj)}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc_offerack'),function(y,z){this._onMessage(z.obj)}.bind(this));if(c('RTCConfig').RtcConferencingGK)c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('rtc_multi_json'),function(y,z){this._onMultiwayMessage(z.obj)}.bind(this));this._localMessageQueue=new (c('FBRTCLocalMessageQueue'))();if(c('RTCConfig').PassMessagesBetweenWindowsGK){if(c('FBRTCSupport').isWebrtcSupported()&&window.addEventListener){var x=v?this._handleWindowMessageToChild.bind(this):this._handleWindowMessageToParent.bind(this);window.addEventListener('message',x,false)}if(v)this._connectToParentWindow(w);}},setParentWindowNonce:function u(v){o=v},generateNewNonce:function u(){p=c('guid')();return p},setMultiwayMessageHandler:function u(v,w){!r||h(0);r=w?v.bind(w):v},_onMultiwayMessage:function u(v){this.emit('multiwayMessageReceived',v);if(r)r(v);},setMessageHandler:function u(v,w){!l||h(0);l=w?v.bind(w):v;while(k.length)l(k.shift());},removeMessageHandler:function u(){l=null},setParentWindowStartCallHandler:function u(v){s=v;return function(){return s=null}},_onMessage:function u(v){if(v.from)v.from=v.from.toString();this.emit('messageReceived',v);if(l){l(v)}else k.push(v);this._passMessageToChildWindow(v)},_connectToParentWindow:function u(v){if(window.opener&&window.opener.postMessage){var w={type:i.CHILD_WINDOW_READY,nonce:o,childNonce:this.generateNewNonce(),peerID:v};window.opener.postMessage(w,window.location.origin)}},_verifyWindowMessage:function u(event){return event.origin===window.location.origin&&event.data&&p&&event.data.nonce===p},_handleWindowMessageToParent:function u(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_READY){this.setParentWindowNonce(event.data.childNonce);this._setChildWindow(event.source);this._replayQueuedMessagesToChild(event.data.peerID,m)}},_handleWindowMessageToChild:function u(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_MESSAGE)this._onMessage(event.data.message);if(event.data.type===i.CHILD_WINDOW_START_CALL)if(s){s()}else c('FBRTCCallControlActions').parentWindowStartCall();},_replayQueuedMessagesToChild:function u(v,w){this._localMessageQueue.drainQueue(v,function(x){var y={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:x};w.postMessage(y,window.location.origin)})},_setChildWindow:function u(v){m=v;clearTimeout(n);n=setTimeout(function(){m=null},j);this._startCallInChildWindow();this.generateNewNonce()},_passMessageToChildWindow:function u(v){if(m){var w={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:v};m.postMessage(w,window.location.origin)}},_startCallInChildWindow:function u(){if(m){var v={type:i.CHILD_WINDOW_START_CALL,nonce:o};m.postMessage(v,window.location.origin)}}};c('mixInEventEmitter')(t,{messageReceived:true,multiwayMessageReceived:true});f.exports=t}),null);
__d('FBRTCCallUIWrapper',['regeneratorRuntime','Bootloader','FBRTCCallActions','FBRTCConfig','FBRTCMessageListener','UserAgent'],(function a(b,c,d,e,f,g){var h=null,i={openGroupCallUI:function j(k,l,m,n,o,p){return c('regeneratorRuntime').async(function q(r){while(1)switch(r.prev=r.next){case 0:h=this._openWindow('Group Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(s){s.openGroupCallUI(k,l,m,n,o,h,p)},'FBRTCCallUIWrapper');case 2:case 'end':return r.stop();}},null,this)},openGroupCallURI:function j(k,l,m,n,o,p){return c('regeneratorRuntime').async(function q(r){while(1)switch(r.prev=r.next){case 0:h=this._openWindow('Group Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(s){s.openGroupCallURI({conferenceName:k,callID:l,hasVideo:m,serverInfoData:n,trigger:o,callSummary:p,callWindow:h})},'FBRTCCallUIWrapper');case 2:case 'end':return r.stop();}},null,this)},openAsCaller:function j(k,l,m,n){if(!h&&window.rtcCallChildWindow){h=window.rtcCallChildWindow;window.rtcCallChildWindow=null}if(this._shouldFocusCallWindow(k)){h.focus();return}if(this._shouldCloseCallWindow())h.close();if(c('FBRTCConfig').useCurrentWindow()){c('FBRTCMessageListener').removeMessageHandler();c('FBRTCCallActions').startCall(k,l,true,n);c('Bootloader').loadModules(["FBRTCCallUI"],function(o){o.openAsCaller(k,l,m,n)},'FBRTCCallUIWrapper');return}h=this._openWindow('Video Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(o){o.openAsCaller(k,l,m,n,h)},'FBRTCCallUIWrapper')},openAsCallee:function j(k,l,m,n,o){if(c('FBRTCConfig').useCurrentWindow()){c('FBRTCMessageListener').removeMessageHandler();c('FBRTCCallActions').startCall(k,l,false,o);c('Bootloader').loadModules(["FBRTCCallUI"],function(p){p.openAsCallee(k,l,m,n,o,null)},'FBRTCCallUIWrapper');return}h=this._openWindow('Video Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(p){p.openAsCallee(k,l,m,n,o,h)},'FBRTCCallUIWrapper')},_shouldFocusCallWindow:function j(k){return h&&!h.closed&&h.rtcCallInProgessWith===k},_shouldCloseCallWindow:function j(){return h&&!h.closed&&!h.rtcCallInProgessWith},_openWindow:function j(k){var l=this._windowPosition(),m=['menubar=no','location=no','scrollbars=no','status=no','personalbar=no',l.height,l.width,l.top,l.left].join(',');if(this._isSparkBrowser())m='';return window.open('',k,m)},_windowPosition:function j(){var k=960,l=540,m,n,o,p;if(screen&&screen.width>1280){k=1280;l=720}if(window.innerWidth!==undefined){n=window.innerWidth;m=window.innerHeight}else{n=screen.width;m=screen.height}if(window.screenLeft!==undefined){o=window.screenLeft;p=window.screenTop}else{o=window.screenX;p=window.screenY}var q=Math.floor(n/2-k/2+o),r=Math.floor(m/2-l/2+p);return {height:'height='+l.toString(),width:'width='+k.toString(),top:'top='+r.toString(),left:'left='+q.toString()}},_isSparkBrowser:function j(){return c('UserAgent').isBrowser('Chrome < 34')&&c('UserAgent').isBrowser('Chrome > 33')}};f.exports=i}),null);
__d('FBRTCCore',['invariant','Bootloader','FBRTCAvailability','FBRTCCallUIWrapper','FBRTCSupport','randomInt'],(function a(b,c,d,e,f,g,h){var i=false,j={startOutgoingCall:function k(l,m,n){var o=arguments.length<=3||arguments[3]===undefined?false:arguments[3];!/\D/.test(l)||h(0);if(i)return;i=true;setTimeout(function(){i=false},1000);if(o&&!c('FBRTCSupport').isCollabSupported()){c('Bootloader').loadModules(["FBRTCUnsupportedBrowserMessage","CollabMessengerLogger"],function(q,r){q.showForUnsupportedCollabCall();r.logBrowserNotSupported({peerID:l})},'FBRTCCore')}else if(!c('FBRTCSupport').isWebrtcSupported()){c('Bootloader').loadModules(["FBRTCUnsupportedBrowserMessage"],function(q){q.showForOutgoingCall()},'FBRTCCore')}else{var p=this._generateCallID();c('FBRTCCallUIWrapper').openAsCaller(l,p,m,n)}},startGroupCall:function k(l){var m=l.conferenceName,n=l.hasVideo,o=l.serverInfoData,p=l.trigger,q=l.usersToRing,r=q===undefined?[]:q;if(i)return;i=true;setTimeout(function(){i=false},1000);if(!c('FBRTCSupport').isGroupCallWebtrcSupported()){c('Bootloader').loadModules(["MessengerRTCGroupCallUnsupportedBrowserDialogController"],function(s){s.render({hasVideo:n})},'FBRTCCore');return}c('FBRTCCallUIWrapper').openGroupCallUI(m,this._generateCallID(),r,n,p,o)},isAvailableForWebrtcCalling:function k(l){return c('FBRTCAvailability').isCallable(l)},shouldEnableVideoCalling:function k(){return c('FBRTCSupport').isOSSupported()},startScreenSharingSession:function k(l,m){!/\D/.test(l)||h(0);if(i)return;i=true;setTimeout(function(){i=false},1000);if(!c('FBRTCSupport').isWirelessScreenSharingSupported()){c('Bootloader').loadModules(["FBRTCUnsupportedBrowserMessage","CollabMessengerLogger"],function(n,o){n.showForUnsupportedCollabScreenSharing();o.logBrowserNotSupported({peerID:l})},'FBRTCCore');return}c('Bootloader').loadModules(["RTCWirelessScreenSharingWindowHandler"],function(n){n.open(l,this._generateCallID(),m)}.bind(this),'FBRTCCore')},_generateCallID:function k(){return c('randomInt')(0,4294967295)}};f.exports=j}),null);
__d('FBRTCCallabilityActions',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({CALLABILITY_FETCHED:null,CALLABILITY_FETCH_ERROR:null});function i(j){this.$FBRTCCallabilityActions1=j}i.prototype.callabilityFetched=function(j,k){this.$FBRTCCallabilityActions1.dispatch({type:h.CALLABILITY_FETCHED,userID:j,callability:k})};i.prototype.callabilityFetchError=function(j){this.$FBRTCCallabilityActions1.dispatch({type:h.CALLABILITY_FETCH_ERROR,userID:j})};i.Types=h;f.exports=i}),null);
__d("XRTCCallabilityController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/rtc\/callability\/",{user_id:{type:"FBID",required:true}})}),null);
__d('FBRTCCallabilityDataManager',['AsyncRequest','FBRTCCallabilityActions','TimeSlice','XRTCCallabilityController'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$FBRTCCallabilityDataManager1=new (c('FBRTCCallabilityActions'))(i)}h.prototype.fetchCallability=function(i){c('TimeSlice').guard(function(){var j=c('XRTCCallabilityController').getURIBuilder().setFBID('user_id',i).getURI(),k=this.$FBRTCCallabilityDataManager2.bind(this,i),l=this.$FBRTCCallabilityDataManager3.bind(this,i);new (c('AsyncRequest'))().setURI(j).setHandler(k).setErrorHandler(l).setAllowCrossPageTransition(true).send()}.bind(this),'Chat Tab RTC Callability Check',{isContinuation:false})()};h.prototype.$FBRTCCallabilityDataManager2=function(i,j){this.$FBRTCCallabilityDataManager1.callabilityFetched(i,j.payload)};h.prototype.$FBRTCCallabilityDataManager3=function(i,j){this.$FBRTCCallabilityDataManager1.callabilityFetchError(i)};f.exports=h}),null);
__d('TreeMap',['Map','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(v,w,x){this.key=v;this.value=w;this.time=x}function i(v){this.$TreeMap1=function(w,x){var y=v(w,x);return y!==0?y:w.time-x.time};this.$TreeMap2=new (c('Map'))();this.$TreeMap3=null;this.$TreeMap4=0;this.size=this.$TreeMap2.size}i.prototype.clear=function(){this.$TreeMap2=new (c('Map'))();this.$TreeMap3=null;this.size=this.$TreeMap2.size};i.prototype.has=function(v){return this.$TreeMap2.has(v)};i.prototype.set=function(v,w){if(this.has(v))this['delete'](v);var x=new h(v,w,this.$TreeMap4++);this.$TreeMap2.set(v,x);this.$TreeMap3=p(this.$TreeMap3,x,this.$TreeMap1);this.size=this.$TreeMap2.size;return this};i.prototype.get=function(v){return this.has(v)?this.$TreeMap2.get(v).value:undefined};i.prototype['delete']=function(v){if(!this.has(v))return false;var w=this.$TreeMap2.get(v);this.$TreeMap3=q(this.$TreeMap3,w,this.$TreeMap1);this.$TreeMap2['delete'](v);this.size=this.$TreeMap2.size;return true};i.prototype.keys=function(){var v=[];u(this.$TreeMap3,v,function(w){return w.key});return v};i.prototype.values=function(){var v=[];u(this.$TreeMap3,v,function(w){return w.value});return v};i.prototype.entries=function(){var v=[];u(this.$TreeMap3,v,function(w){return {key:w.key,value:w.value}});return v};i.prototype.range=function(v,w){var x=[],y=null;if(v)y=new h(v.key,v.value,-1);var z=null;if(w)z=new h(w.key,w.value,this.$TreeMap4);u(this.$TreeMap3,x,function(aa){return {key:aa.key,value:aa.value}},this.$TreeMap1,y,z);return x};i.prototype.min=function(){if(!this.$TreeMap3)return undefined;var v=r(c('nullthrows')(this.$TreeMap3)),w=v.key,x=v.value;return {key:w,value:x}};i.prototype.max=function(){if(!this.$TreeMap3)return undefined;var v=s(c('nullthrows')(this.$TreeMap3)),w=v.key,x=v.value;return {key:w,value:x}};i.prototype.__testRoot=function(){};function j(v){if(!v)return v;o(v);if(v.balanceFactor<-1){if(v.right&&v.right.balanceFactor<=0){return k(v)}else return l(v);}else if(v.balanceFactor>1){if(v.left&&v.left.balanceFactor>=0){return m(v)}else return n(v);}else return v;}function k(v){var w=v,x=c('nullthrows')(w.right),y=x.left;w.right=y;o(w);c('nullthrows')(x).left=w;o(x);return x}function l(v){var w=v,x=c('nullthrows')(w.right),y=c('nullthrows')(x.left),z=y.left,aa=y.right;w.right=z;o(w);x.left=aa;o(x);y=c('nullthrows')(y);y.left=w;y.right=x;o(y);return y}function m(v){var w=v,x=c('nullthrows')(w.left),y=x.right;w.left=y;o(w);x.right=w;o(x);return x}function n(v){var w=v,x=c('nullthrows')(w.left),y=c('nullthrows')(x.right),z=y.left,aa=y.right;x.right=z;o(x);w.left=aa;o(w);y.left=x;y.right=w;o(y);return y}function o(v){var w=v.left?v.left.height:-1,x=v.right?v.right.height:-1;v.height=Math.max(w,x)+1;v.balanceFactor=w-x}function p(v,w,x){if(v==null)return j(w);var y=x(w,v);if(y<0){v.left=p(v.left,w,x);return j(v)}else{v.right=p(v.right,w,x);return j(v)}}function q(v,w,x){if(v==null)return null;if(v===w)if(v.left&&v.right){var y=s(v.left);v.left=t(v.left);y.left=v.left;y.right=v.right;return j(y)}else if(v.left){return j(v.left)}else if(v.right){return j(v.right)}else return null;var z=x(w,v);if(z<0){v.left=q(v.left,w,x);return j(v)}else{v.right=q(v.right,w,x);return j(v)}}function r(v){while(v.left)v=v.left;return v}function s(v){while(v.right)v=v.right;return v}function t(v){if(!v)return null;if(v.right==null)return j(v.left||null);v.right=t(v.right);return j(v)}function u(v,w,x,y,z,aa){if(v==null)return;var ba=!y||!z||y(v,z)>=0,ca=!y||!aa||y(v,aa)<=0;if(ba)u(v.left,w,x,y,z,aa);if(ba&&ca)w.push(x(v));if(ca)u(v.right,w,x,y,z,aa);}f.exports=i}),null);
__d('Cache',['DateConsts','Map','TimeSlice','TreeMap'],(function a(b,c,d,e,f,g){'use strict';function h(){this.$Cache1=new (c('Map'))()}h.prototype.has=function(i){return this.$Cache1.has(i)};h.prototype.get=function(i,j){var k=this.__getRaw(i);if(!k)return j;return k.$Cache2};h.prototype.getAll=function(i,j){var k=new (c('Map'))();i.forEach(function(l){return k.set(l,this.get(l,j))}.bind(this));return k};h.prototype['delete']=function(i){var j=this.__getRaw(i);if(j&&j.$Cache3)clearTimeout(j.$Cache3);return this.$Cache1['delete'](i)};h.prototype.clear=function(){this.$Cache1.forEach(function(i){if(i&&i.$Cache3)clearTimeout(i.$Cache3);});this.$Cache1.clear()};h.prototype.set=function(i,j,k,l){if(!this.shouldUpdate(i,k))return false;var m=this.__getRaw(i);if(!m)m=this.__getNewRawObject();delete m.$Cache2;delete m.$Cache4;if(m.$Cache3)clearTimeout(m.$Cache3);delete m.$Cache3;m.$Cache2=j;if(k!=null)m.$Cache4=k;if(l!=null&&l>=0)m.$Cache3=setTimeout(c('TimeSlice').guard(this['delete'].bind(this,i),'Cache expiration timeout'),l*c('DateConsts').MS_PER_SEC*c('DateConsts').SEC_PER_MIN);this.__setRaw(i,m);return true};h.prototype.shouldUpdate=function(i,j){var k=this.__getRaw(i);return k==null||k.$Cache4==null||j==null||j>k.$Cache4};h.prototype.size=function(){return this.$Cache1.size};h.prototype.__getRaw=function(i){return this.$Cache1.get(i)};h.prototype.__setRaw=function(i,j){this.$Cache1.set(i,j)};h.prototype.__getNewRawObject=function(){return {$Cache2:null,$Cache3:null,$Cache4:null,$Cache5:null,$Cache6:null}};h.prototype.__keys=function(){return this.$Cache1.keys()};f.exports=h}),null);
__d('RTCCallabilityStore',['fbt','Cache','FBRTCAvailability','FluxStore','FBRTCCallabilityActions','FBRTCCallabilityDataManager','RTCConfig'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=.5,l=5;i=babelHelpers.inherits(m,c('FluxStore'));j=i&&i.prototype;function m(n){j.constructor.call(this,n);this.$RTCCallabilityStore2=new (c('FBRTCCallabilityDataManager'))(n);this.$RTCCallabilityStore1=new (c('Cache'))()}m.prototype.__onDispatch=function(n){var o=n.type;switch(o){case c('FBRTCCallabilityActions').Types.CALLABILITY_FETCHED:var p=n.userID,q=n.callability;this.$RTCCallabilityStore1.set(p,q.is_callable,null,q.is_callable?l:k);this.__emitChange();break;case c('FBRTCCallabilityActions').Types.CALLABILITY_FETCH_ERROR:this.$RTCCallabilityStore1.set(n.userID,false,null,k);this.__emitChange();break;}};m.prototype.isCallable=function(n){if(c('FBRTCAvailability').isCallable(n))return true;if(!this.$RTCCallabilityStore1.has(n)){this.$RTCCallabilityStore2.fetchCallability(n);this.$RTCCallabilityStore1.set(n,false,null,k)}return !!this.$RTCCallabilityStore1.get(n)};m.prototype.callButtonTooltip=function(n,o){var p=arguments.length<=2||arguments[2]===undefined?true:arguments[2];if(c('RTCConfig').RtcActiveUserCallability||p&&this.isCallable(n))return h._("Start a video chat with {shortname}",[h.param('shortname',o)]);return h._("{shortname} no est\u00e1 disponible para participar en una videollamada",[h.param('shortname',o)])};m.prototype.voiceCallButtonTooltip=function(n,o){var p=arguments.length<=2||arguments[2]===undefined?true:arguments[2];if(c('RTCConfig').RtcActiveUserCallability||p&&this.isCallable(n))return h._("Inicia una llamada de voz con {shortname}",[h.param('shortname',o)]);return h._("{shortname} no est\u00e1 actualmente disponible para realizar llamadas de voz",[h.param('shortname',o)])};f.exports=m}),null);
__d('FBRTCCallabilityStore',['FBRTCDispatcher','RTCCallabilityStore'],(function a(b,c,d,e,f,g){'use strict';f.exports=new (c('RTCCallabilityStore'))(c('FBRTCDispatcher'))}),null);
__d('XHPTemplate',['DataStore','DOM','HTML','XHPTemplateProcessor'],(function a(b,c,d,e,f,g){var h=c('XHPTemplateProcessor').processor;function i(k){'use strict';if(h instanceof Function)k=h(k);this._model=k}i.prototype.render=function(){'use strict';if(c('HTML').isHTML(this._model))this._model=c('DOM').setContent(document.createDocumentFragment(),this._model)[0];return this._model.cloneNode(true)};i.prototype.build=function(){'use strict';return new j(this.render())};i.getNode=function(k,l){'use strict';return i.getNodes(k)[l]};i.getNodes=function(k){'use strict';var l=c('DataStore').get(k,'XHPTemplate:nodes');if(!l){l={};var m=c('DOM').scry(k,'[data-jsid]');m.push(k);var n=m.length;while(n--){var o=m[n];l[o.getAttribute('data-jsid')]=o;o.removeAttribute('data-jsid')}c('DataStore').set(k,'XHPTemplate:nodes',l)}return l};function j(k){'use strict';this._root=k;this._populateNodes()}j.prototype._populateNodes=function(){'use strict';this._nodes={};this._leaves={};var k=this._root.getElementsByTagName('*');for(var l=0,m=k.length;l<m;l++){var n=k[l],o=n.getAttribute('data-jsid');if(o){n.removeAttribute('data-jsid');this._nodes[o]=n;this._leaves[o]=!n.childNodes.length}}};j.prototype.getRoot=function(){'use strict';return this._root};j.prototype.getNode=function(k){'use strict';return this._nodes[k]};j.prototype.setNodeProperty=function(k,l,m){'use strict';this.getNode(k)[l]=m;return this};j.prototype.setNodeContent=function(k,l){'use strict';if(!this._leaves[k])throw new Error("Can't setContent on non-leaf node: "+k);c('DOM').setContent(this.getNode(k),l);return this};f.exports=i}),null);
__d("isEmail",[],(function a(b,c,d,e,f,g){var h=/^[\w!#\$%&\'\*\+\/\=\?\^`\{\|\}~\-]+(:?\.[\w!#\$%&\'\*\+\/\=\?\^`\{\|\}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?$/i;function i(j){return h.test(j)}f.exports=i}),null);
__d("MessagingThreadType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({ONE_TO_ONE:1,GROUP:2,ROOM:3,MONTAGE:4,MARKETPLACE:5})}),null);
__d('QE',['Banzai','Cache'],(function a(b,c,d,e,f,g){var h='qe_log_exposure',i=60,j=new (c('Cache'))(),k={logExposure:function l(m,n){var o=n?m+'|'+n:m;if(j.has(o))return;var p={signal:true},q={name:m,id:null};if(n)q.id=n;c('Banzai').post(h,q,p);j.set(o,true,1,i)}};f.exports=k}),null);
__d('ServiceWorkerRegistration',['Promise','ClientServiceWorkerMessage'],(function a(b,c,d,e,f,g){var h='serviceWorker' in navigator;function i(){var k=navigator.serviceWorker;if(!h||!k)throw new Error('serviceWorker is not supported in this browser');return k}var j={isSupported:function k(){return h},registerWorkerIfUnregistered:function k(l){var m=i();return new (c('Promise'))(function(n,o){this.getWorkerRegistration(l).done(function(p){if(!p){c('Promise').resolve(m.register(l,{updateViaCache:'all'})).done(function(){c('Promise').resolve(m.ready).done(n)})}else n(p);})}.bind(this))},unregisterControllingWorker:function k(){return new (c('Promise'))(function(l,m){var n=new (c('ClientServiceWorkerMessage'))('unregister',{},function(){l(true)});n.sendViaController()})},getWorkerRegistration:function k(l){var m=i();return c('Promise').resolve(m.getRegistration(l))},isAWorkerActivated:function k(){if(!navigator.serviceWorker||!navigator.serviceWorker.getRegistration)return c('Promise').resolve(false);return navigator.serviceWorker.getRegistration().then(function(l){return !!(l&&l.active)})}};f.exports=j}),null);
__d("XQuickPromotionSimpleLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/qp\/action\/log\/",{qp_id:{type:"Int",required:true},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}})}),null);